<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.efounder.JEnterprise.mapper.basedatamanage.eqmanage.BESSbdyMapper">

	<resultMap id="BesDdcResultMap" type="com.efounder.JEnterprise.model.basedatamanage.eqmanage.BesDdc" >
		<id column="F_GUID" property="fGuid" jdbcType="VARCHAR" />
		<result column="F_SBID" property="fSysName" jdbcType="VARCHAR" />
		<result column="F_SYS_NAME" property="fSysName" jdbcType="VARCHAR" />
		<result column="F_NICK_NAME" property="fNickName" jdbcType="VARCHAR" />
		<result column="F_ENABLED" property="fEnabled" jdbcType="INTEGER" />
		<result column="F_SSQY" property="fSsqy" jdbcType="VARCHAR" />
		<result column="F_NODE_TYPE" property="fNodeType" jdbcType="VARCHAR" />
		<result column="F_SBLXBH" property="fSblxbh" jdbcType="VARCHAR" />
		<result column="F_AZWZ" property="fAzwz" jdbcType="VARCHAR" />
		<result column="F_DESCRIPTION" property="fDescription" jdbcType="VARCHAR" />
		<result column="F_TYPE" property="fType" jdbcType="VARCHAR" />
		<result column="F_IP_ADDR" property="fIpAddr" jdbcType="VARCHAR" />
		<result column="F_PORT" property="fPort" jdbcType="VARCHAR" />
		<result column="F_CRDATE" property="fCrdate" jdbcType="TIMESTAMP" />
		<result column="F_CHDATE" property="fChdate" jdbcType="TIMESTAMP" />
	</resultMap>
	<!-- 设备树结构 BES_SBPZ_STRUCT -->
	<resultMap id="sbdyMap" type="com.efounder.JEnterprise.model.basedatamanage.eqmanage.BESSbPzStruct">
		<id column="F_SYS_NAME" property="f_sys_name" />
		<result column="F_ID" property="f_id" />
		<result column="F_SYS_NAME_OLD" property="f_sys_name_old" />
		<result column="F_SBID" property="f_sbid" />
		<result column="F_NICK_NAME" property="f_nick_name" />
		<result column="F_ALLPATH" property="f_allpath" />
		<result column="F_DESCRIPTION" property="f_description" />
		<result column="F_TYPE" property="f_type" />
		<result column="F_ISSYN" property="f_issyn" />
		<result column="F_PSYS_NAME" property="f_psys_name" />
		<result column="F_STATUS" property="f_status" />
		<result column="F_TO_OPC" property="f_to_opc" />
		<result column="F_OPC_WR" property="f_opc_wr" />
		<result column="F_CRDATE" property="f_crdate" />
		<result column="F_CHDATE" property="f_chdate" />
		<result column="F_XH_TYPE" property="f_xh_type" />
		<result column="F_NODE_ATTRIBUTION" property="f_node_attribution" />
	</resultMap>

	<resultMap id="sbdyDOMap"
			   type="com.efounder.JEnterprise.model.basedatamanage.eqmanage.BesDdc">
		<id column="F_SYS_NAME" property="fSysName" />
		<result column="F_GUID" property="fGuid" />
		<result column="F_SBID" property="fSbid" />
		<result column="F_NICK_NAME" property="fNickName" />
		<result column="F_DESCRIPTION" property="fDescription" />
		<result column="F_TYPE" property="fType" />
		<result column="F_CRDATE" property="fCrdate" />
		<result column="F_CHDATE" property="fChdate" />
	</resultMap>

	<resultMap id="sbdyMap2"
			   type="com.efounder.JEnterprise.model.basedatamanage.eqmanage.BESSbPzStruct">
		<id column="F_SYS_NAME" property="f_sys_name" />
		<result column="F_ID" property="f_id" />
		<result column="F_SBID" property="f_sbid" />
		<result column="F_NICK_NAME" property="f_nick_name" />
		<result column="F_ALLPATH" property="f_allpath" />
		<result column="F_DESCRIPTION" property="f_description" />
		<result column="F_TYPE" property="f_type" />
		<result column="F_ISSYN" property="f_issyn" />
		<result column="F_PSYS_NAME" property="f_psys_name" />
		<result column="F_STATUS" property="f_status" />
		<result column="F_TO_OPC" property="f_to_opc" />
		<result column="F_OPC_WR" property="f_opc_wr" />
		<result column="F_CRDATE" property="f_crdate" />
		<result column="F_CHDATE" property="f_chdate" />
		<result column="F_XH_TYPE" property="f_xh_type" />
		<result column="F_NODE_ATTRIBUTION" property="f_node_attribution" />
		<collection select="searchClilderList" column="F_SYS_NAME" property="childerBes" />
	</resultMap>


	<!-- 设备树节点类型定义 BES_SBTREE_NODETYPE -->
	<resultMap id="sbTreeNotdTypeMap"
			   type="com.efounder.JEnterprise.model.basedatamanage.eqmanage.BESSbTreeNodeType">
		<id column="F_NODE_TYPE" property="f_node_type" />
		<result column="F_NODE_NAME" property="f_node_name" />
		<result column="F_FUN_MCS" property="f_fun_mcs" />
		<result column="F_FUN_NODETYPE" property="f_fun_nodetype" />
		<result column="F_EDIT_URL" property="f_edit_url" />
		<result column="F_MAX_COUNT" property="f_max_count" />
		<result column="F_NODE_TABLE" property="f_node_table" />
		<result column="F_ONLINE_IMG" property="f_online_img" />
		<result column="F_OFFLINE_IMG" property="f_offline_img" />
		<result column="F_REMARK" property="f_remark" />
		<result column="F_CRDATE" property="f_crdate" />
		<result column="F_CHDATE" property="f_chdate" />
	</resultMap>

	<!-- 设备类型 BES_EQUIPMENT_MOLD -->
	<resultMap id="equipmentMoldMap"
			   type="com.efounder.JEnterprise.model.BESEquipmentMold">
		<result column="F_TYPE" property="f_type" />
		<result column="F_SBMC" property="f_sbmc" />
		<result column="F_PTYPE" property="f_ptype" />
		<result column="F_SBJCXXB" property="f_sbjcxxb" />
		<result column="F_SBSJB" property="f_sbsjb" />
		<result column="F_REMARK" property="f_remark" />
		<result column="F_CRDATE" property="f_crdate" />
		<result column="F_CHDATE" property="f_chdate" />
	</resultMap>

	<!-- 设备型号 BES_EQUIPMENT_TYPE -->
	<resultMap id="equipmentTypeMap"
			   type="com.efounder.JEnterprise.model.basedatamanage.eqmanage.BESEquipmentType">
		<result column="F_TYPE" property="f_type" />
		<result column="F_SBMC" property="f_sbmc" />
		<result column="F_SBLXBH" property="f_sblxbh" />
		<result column="F_REMARK" property="f_remark" />
		<result column="F_CRDATE" property="f_crdate" />
		<result column="F_CHDATE" property="f_chdate" />
	</resultMap>

	<!-- 模块类型 BES_MODULE_TYPE -->
	<resultMap id="moduleTypeMap"
			   type="com.efounder.JEnterprise.model.basedatamanage.eqmanage.BESModuleType">
		<result column="F_ID" property="fModuleId" />
		<result column="F_MODULE_TYPE" property="fModuleType" />
		<result column="F_DESCRIPTION" property="fDescription" />
		<result column="F_POINT_AMOUNT" property="fPointAmount" />
		<result column="F_POINT_TYPE_CL" property="fPointTypeCl" />
		<result column="F_TYPE_CODE" property="fTypeCode" />
		<result column="F_CRDATE" property="fCrdate" />
		<result column="F_CHDATE" property="fChdate" />
	</resultMap>

	<!-- 模块点类型 BES_ MODULEPOINT _TYPE -->
	<resultMap id="modulePointTypeMap"
			   type="com.efounder.JEnterprise.model.basedatamanage.eqmanage.BESModulePointType">
		<result column="F_ID" property="fId" />
		<result column="F_MODULEPOINT_TYPE" property="fModulepointType" />
		<result column="F_DESCRIPTION" property="fDescription" />
		<result column="F_CRDATE" property="fCrdate" />
		<result column="F_CHDATE" property="fChdate" />
	</resultMap>

	<!-- 设备树节点和模块点类型关系 BES_EP_MODULE_TYPE_RLGL -->
	<resultMap id="epModuleTypeRlglMap"
			   type="com.efounder.JEnterprise.model.basedatamanage.eqmanage.BESEpModuleTypeRlgl">
		<result column="F_EP_TREENODE_TYPE" property="fEpTreenodeType" />
		<result column="F_MODULEPOINT_ID" property="fModulepointId" />
		<result column="F_CRDATE" property="fCrdate" />
		<result column="F_CHDATE" property="fChdate" />
	</resultMap>

	<!-- 虚点类型 BES_VPOINT_TYPE -->
	<resultMap id="vPointTypeMap"
			   type="com.efounder.JEnterprise.model.basedatamanage.eqmanage.BESVPointType">
		<result column="ID" property="id" />
		<result column="F_VPOINT_TYPE" property="fVpointType" />
		<result column="F_IS_INPUT" property="fIsInput" />
		<result column="F_DESCRIPTION" property="fDescription" />
		<result column="F_CRDATE" property="fCrdate" />
		<result column="F_CHDATE" property="fChdate" />
	</resultMap>

	<!--txt编译前文本表 bes_txt_begin-->
	<resultMap id="besTxt" type="com.efounder.JEnterprise.model.basedatamanage.eqmanage.BesTxt">
		<result column="f_id" property="id"/>
		<result column="f_guid" property="guid"/>
		<result column="f_txt" property="txt"/>
	</resultMap>

	<!--wanghongjie start 20200615 四种点位加上虚点的类型-->
	<resultMap id="besPointStruct" type="com.efounder.JEnterprise.model.basedatamanage.eqmanage.BesPointStruct">
		<result column="F_GUID" property="fGuid"/>
		<result column="F_SBID" property="fSbid"/>
		<result column="F_STRUCT_ID" property="fStructId"/>
		<result column="F_SYS_NAME_OLD" property="fSysNameOld"/>
		<result column="F_SYS_NAME" property="fSysName"/>
		<result column="F_NICK_NAME" property="fNickName"/>
		<result column="F_NODE_TYPE" property="fNodeType"/>
		<result column="F_CHANNEL_INDEX" property="fChannelIndex"/>
		<result column="F_ENABLED" property="fEnabled"/>
		<result column="F_REVERSED" property="fReversed"/>
		<result column="F_SOURCED" property="fSourced"/>
		<result column="F_WORK_MODE" property="fWorkMode"/>
		<result column="F_ALARM_ENABLE" property="fAlarmEnable"/>
		<result column="F_ALARM_TYPE" property="fAlarmType"/>
		<result column="F_CLOSE_STATE" property="fCloseState"/>
		<result column="F_ALARM_PRIORITY" property="fAlarmPriority"/>
		<result column="F_INIT_VAL" property="fInitVal"/>
		<result column="F_DESCRIPTION" property="fDescription"/>
		<result column="F_YQBH" property="fYqbh"/>
		<result column="F_CRDATE" property="fCrdate"/>
		<result column="F_CHDATE" property="fChdate"/>
		<result column="F_ENGINEER_UNIT" property="fEngineerUnit"/>
		<result column="F_SINNAL_TYPE" property="fSinnalType"/>
		<result column="F_MIN_VAL" property="fMinVal"/>
		<result column="F_MAX_VAL" property="fMaxVal"/>
		<result column="F_ACCURACY" property="fAccuracy"/>
		<result column="F_HIGH_LIMIT" property="fHighLimit"/>
		<result column="F_LOW_LIMIT" property="fLowLimit"/>
		<result column="F_ENERGYSTATICS" property="fEnergystatics"/>
		<result column="F_STATICSTIME" property="fStaticstime"/>
		<result column="F_WHETHER_TO_ALARM_HIGH" property="fWhetherToAlarmHigh"/>
		<result column="F_WHETHER_TO_ALARM_LOW" property="fWhetherToAlarmLow"/>
	</resultMap>

	<resultMap id="BESParkMap" type="com.efounder.JEnterprise.model.basedatamanage.energyinformation.BESPark">
		<result column="F_YQBH" property="f_yqbh" />
		<result column="F_YQMC" property="f_yqmc" />
		<result column="F_NODE_CODE" property="f_node_code" />
		<result column="F_ALL_AREA" property="f_all_area" />
		<result column="F_MONITOR_AREA" property="f_monitor_area" />
		<result column="F_HEAT_AREA" property="f_heat_area" />
		<result column="F_PERSON_NUMS" property="f_person_nums" />
		<result column="F_BUILD_TIME" property="f_build_time" />
		<result column="F_EQUIPMENT_RUNTIME" property="f_equipment_runtime" />
		<result column="F_CONTACT_NAME" property="f_contact_name" />
		<result column="F_CONTACT_PHONE" property="f_contact_phone" />
		<result column="F_CONTACT_EMAIL" property="f_contact_email" />
		<result column="F_CRDATE" property="f_crdate" />
		<result column="F_CHDATE" property="f_chdate" />
	</resultMap>
	<sql id="find_xxx_park">
	    <![CDATA[
			SELECT F_YQBH ,F_YQMC,F_NODE_CODE, F_ALL_AREA,F_MONITOR_AREA,F_HEAT_AREA,F_PERSON_NUMS,date_format(F_BUILD_TIME,'%Y-%m-%d' )F_BUILD_TIME,date_format(F_EQUIPMENT_RUNTIME,'%Y-%m-%d' )F_EQUIPMENT_RUNTIME,F_CONTACT_NAME,F_CONTACT_PHONE,F_CONTACT_EMAIL,date_format(F_CRDATE,'%Y-%m-%d %H:%i:%s' )F_CRDATE ,date_format
		(F_CHDATE,'%Y-%m-%d %H:%i:%s' )F_CHDATE, F_LONGITUDE, F_LATITUDE
	    ]]>
	</sql>

	<sql id="from_xxx_park">
	    <![CDATA[
	    	FROM BES_PARK
	    ]]>
	</sql>


	<!-- 获取设备树结构信息 -->
	<select id="findSbdyInfo" resultMap="sbdyMap" parameterType="String">
		<include refid="find_xxx" />
		<include refid="from_xxx" />
		<where>
			<if test="sbdy_in != null and sbdy_in != ''"> F_SYS_NAME like '%${sbdy_in}%'</if>
		</where>
		order by F_CHDATE
	</select>
	<!--加载设备定义树 -->
	<select id="loadAll" parameterType="String" resultMap="sbdyMap">
		<include refid="find_xxx" />
		<include refid="from_xxx" />
		<!-- 		where F_TYPE = '9' -->
		where
		(${checkDataLimit})
	</select>
	<!-- 获取所有设备树数据 -->
	<select id="findAll" parameterType="String" resultType="com.efounder.JEnterprise.model.basedatamanage.eqmanage.BESSbPzStruct">
		SELECT
		t.F_ID f_id,
		t.F_SBID f_sbid,
		t.F_SYS_NAME_OLD f_sys_name_old,
		t.F_SYS_NAME f_sys_name,
		t.F_NICK_NAME f_nick_name,
		t.F_ALLPATH f_allpath,
		t.F_DESCRIPTION f_description,
		t.F_TYPE f_type,
		t.F_PSYS_NAME f_psys_name,
		t.F_STATUS f_status,
		t.F_TO_OPC f_to_opc,
		t.F_OPC_WR f_opc_wr,
		t.F_NODE_ATTRIBUTION f_node_attribution,
		COALESCE(`ao`.F_ENGINEER_UNIT, `ai`.F_ENGINEER_UNIT, `po`.F_ENGINEER_UNIT) unit,
		COALESCE(`ao`.F_INIT_VAL, `ai`.F_INIT_VAL, `do`.F_INIT_VAL, `di`.F_INIT_VAL, `po`.F_INIT_VAL) f_init_val,
		COALESCE(`ao`.F_ACCURACY, `ai`.F_ACCURACY, `po`.F_ACCURACY) f_accuracy
		FROM
		bes_sbpz_struct t
		LEFT JOIN bes_analog_ouput `ao` ON t.F_SYS_NAME = `ao`.F_SYS_NAME
		LEFT JOIN bes_digit_ouput `do` ON t.F_SYS_NAME = `do`.F_SYS_NAME
		LEFT JOIN bes_digit_input `di` ON t.F_SYS_NAME = `di`.F_SYS_NAME
		LEFT JOIN bes_analog_input `ai` ON t.F_SYS_NAME = `ai`.F_SYS_NAME
		LEFT JOIN bes_vpoint po ON t.F_SYS_NAME = po.F_SYS_NAME

	</select>
    <!--加载DO点数据-->
	<select id="loadDOAll" parameterType="String" resultMap="sbdyDOMap">
		<include refid="find_xxxDO" />
		<include refid="from_xxxDO" />
		<!-- 		where F_TYPE = '9' -->
		where
		(${checkDataLimit})
		order by F_CRDATE
	</select>
	<!-- 加载逻辑点信息 -->
	<!-- start remove by xiepufeng at 2020年3月13日 cause 未使用代码-->
	<!--<select id="loadAllPoint" parameterType="String" resultType="java.util.HashMap">
		select * from bes_digit_ouput
	</select>-->
	<!--end-->

	<!--通过系统名称获取设备树信息 -->
	<select id="getSbTreeInfoBySysName" parameterType="String" resultMap="sbdyMap">
		<include refid="find_xxx" />
		<include refid="from_xxx" />
		<where>
			F_SYS_NAME_OLD = #{f_sys_name} || F_SYS_NAME=#{f_sys_name}
			<!-- 			<if test="f_sys_name != null and f_sys_name != ''"> F_SYS_NAME = #{f_sys_name}</if> -->
		</where>
	</select>

	<select id="getSbTreeDataBySysName" parameterType="String" resultMap="sbdyMap">
		<include refid="find_xxx" />
		<include refid="from_xxx" />
		<where>
			F_SYS_NAME=#{f_sys_name}
		</where>
	</select>

	<select id="getSbTreeInfoBySysNameChange" parameterType="String" resultMap="sbdyMap">
		select  * from ${tabName}
		<where>
			F_SYS_NAME = #{f_sys_name} || F_SYS_NAME_OLD = #{f_sys_name}
			<!-- 			<if test="f_sys_name != null and f_sys_name != ''"> F_SYS_NAME = #{f_sys_name}</if> -->
		</where>
	</select>

	<!-- 根据节点类型查找所有子节点 -->
	<select id="findChildByTreeNoteType" parameterType="String" resultMap="sbTreeNotdTypeMap">
		SELECT F_NODE_TYPE,F_NODE_NAME,F_FUN_MCS,F_FUN_NODETYPE,F_EDIT_URL,F_MAX_COUNT,F_NODE_TABLE,F_ONLINE_IMG,F_OFFLINE_IMG,F_REMARK,F_CRDATE,F_CHDATE FROM BES_SBTREE_NODETYPE
		<where>
			<if test="f_node_type != null and f_node_type != ''"> F_NODE_TYPE = #{f_node_type}</if>
		</where>
	</select>

	<!-- 根据节点类型查找节点名称 tianjiangwei-->
	<select id="noteNameByNoteType" parameterType="String" resultMap="sbTreeNotdTypeMap">
		SELECT F_NODE_NAME,F_EDIT_URL,F_NODE_TABLE FROM BES_SBTREE_NODETYPE
		<where>
			<if test="f_type != null and f_type != ''"> F_NODE_TYPE = #{f_type}</if>
		</where>
	</select>

	<!-- Start add by yangjx at 20191016 for 验证是否已同步 -->
	<select id="getModuleNodeInfoWhenEntryPage"  resultType="Integer">
		SELECT count(1) as num FROM ${tableName} WHERE F_SYS_NAME = #{f_sys_name}
	</select>

	<!-- 模块属性信息中模块型号下拉列表获取模块类型信息 -->
	<select id="getModuleTypeInfo" parameterType="string" resultMap="moduleTypeMap">
  		SELECT F_ID,F_MODULE_TYPE, F_DESCRIPTION,F_POINT_AMOUNT,F_POINT_TYPE_CL,F_TYPE_CODE,date_format(F_CRDATE,'%Y-%m-%d %H:%i:%s' ) F_CRDATE,date_format(F_CHDATE,'%Y-%m-%d %H:%i:%s' ) F_CHDATE FROM BES_MODULE_TYPE
 	</select>
	<!-- 虚点属性信息中虚点类型下拉列表获取虚点类型信息 -->
	<select id="getVpointTypeInfo" parameterType="string" resultMap="vPointTypeMap">
  		SELECT ID, F_VPOINT_TYPE,F_IS_INPUT, F_DESCRIPTION, F_CRDATE, F_CHDATE FROM BES_VPOINT_TYPE
 	</select>

	<select id="editSbdyInfoBySelByNodeByIP" parameterType="string" resultMap="BesDdcResultMap">
  		SELECT F_SYS_NAME, F_IP_ADDR FROM bes_ddc  where F_IP_ADDR = #{ipTxt} || F_CHANNEL_ID = #{ipTxt}
  		union
			(select F_SYS_NAME, F_IP_ADDR from bes_collector where F_IP_ADDR = #{ipTxt} || F_CHANNEL_ID = #{ipTxt})

 	</select>

	<select id="editSbdyInfoBySelByNodeByF_guid" parameterType="string" resultType="String">
		select F_IP_ADDR from bes_ddc where F_GUID= #{f_guid}
	</select>

	<select id="editSbdyInfoBySelByNodeByF_guid_channel_id" parameterType="string" resultType="String">
		select F_CHANNEL_ID from bes_ddc where F_GUID= #{f_guid}
	</select>
	<select id="editSbdyInfoBySelByNodeByF_guidCollector" parameterType="string" resultType="String">
		select F_IP_ADDR from bes_collector where F_GUID= #{f_guid}
	</select>

	<select id="isAmmeter" parameterType="string" resultType="String">
		select f_guid from bes_ammeter where F_SYS_NAME= #{f_sys_name}
	</select>

	<!-- 获取所选节点获取对应的属性信息 -->
	<select id="findSbdyInfoBySelNode" parameterType="String" resultType="java.util.HashMap">
		SELECT * FROM ${nodeTabName}
		<where>
			<if test="f_sys_name != null and f_sys_name != ''"> F_SYS_NAME_OLD = #{f_sys_name} || F_SYS_NAME=#{f_sys_name}</if>
		</where>
	</select>

	<select id="findSbdyInfoBySelNodeChange" parameterType="String" resultType="java.util.HashMap">
		SELECT * FROM ${nodeTabName}
		<where>
			<if test="f_sys_name != null and f_sys_name != ''"> F_SYS_NAME = #{f_sys_name}</if>
		</where>
	</select>

	<select id="findSbdyInfoByRootId" parameterType="String" resultType="java.util.HashMap">
		SELECT * FROM ${tabName}
		<where>
			<if test="f_sys_name != null and f_sys_name != ''">F_SYS_NAME=#{f_sys_name}</if>
		</where>
	</select>

	<!-- 获取所选节点获取对应的虚点属性信息 -->
	<select id="findSbdyInfoBySelNodeVPonit" parameterType="String" resultType="java.util.HashMap">
		SELECT * FROM ${nodeTabName}
		<where>
			<if test="f_psys_name != null and f_psys_name != ''"> F_SYS_NAME = (select f_psys_name from bes_sbpz_struct where F_SYS_NAME = #{f_psys_name})</if>
		</where>
	</select>
	<!-- 获取父类型匹配的设备型号信息 -->
	<select id="getEquipmentTypeById" parameterType="String" resultMap="equipmentTypeMap">
		SELECT * FROM BES_EQUIPMENT_TYPE
		<where>
			<if test="f_type != null and f_type != ''"> F_SBLXBH = #{f_type}</if>
		</where>
	</select>

	<!-- 根据ID获取一条设备类型信息 -->
	<select id="getEquipmentMoldInfoById" parameterType="String" resultMap="equipmentMoldMap">
		SELECT * FROM BES_EQUIPMENT_MOLD
		<where>
			<if test="f_type != null and f_type != ''"> F_TYPE = #{f_type}</if>
		</where>
	</select>

	<!-- 根据ID获取一条设备型号信息 -->
	<select id="getEquipmentTypeInfoById" parameterType="String" resultMap="equipmentTypeMap">
		SELECT * FROM BES_EQUIPMENT_TYPE
		<where>
			<if test="f_type != null and f_type != ''"> F_TYPE = #{f_type}</if>
		</where>
	</select>

	<!-- 获取模块点类型信息 -->
	<select id="getModulePointTypeInfo" parameterType="String" resultMap="modulePointTypeMap">
		SELECT * FROM BES_MODULEPOINT_TYPE
	</select>

	<!-- 获取设备树节点和模块点类型关系信息 -->
	<select id="getEpModuleTypeRlglInfo" parameterType="String" resultMap="epModuleTypeRlglMap">
		SELECT * FROM BES_EP_MODULE_TYPE_RLGL
	</select>

	<!--通过系统名称获取该节点下的所有子节点信息 -->
	<select id="getSbChildNodeBySysName" parameterType="String" resultMap="sbdyMap">
		select * from bes_sbpz_struct A where  exists(select 1 from bes_sbpz_struct B where A.F_PSYS_NAME = B.F_SYS_NAME and F_SYS_NAME = #{f_sys_name})
	</select>

	<select id="sbpzQueryPollStatus" parameterType="string" resultMap="sbdyMap">
		select * from bes_sbpz_struct where F_SYS_NAME = #{fSysName}
	</select>

	<select id="searchClilderList" parameterType="String" resultMap="sbdyMap2">
		select * from bes_sbpz_struct A where  exists(select 1 from bes_sbpz_struct B where A.F_PSYS_NAME = B.F_SYS_NAME and F_SYS_NAME = #{f_sys_name})
	</select>

	<!--start xiepufeng 2020年3月12日  -->
	<!--<select id="searchLikeClilderList" parameterType="string" resultMap="sbdyMap">
		SELECT * FROM BES_SBPZ_STRUCT WHERE F_PSYS_NAME LIKE CONCAT(#{f_sys_name},'%')
	</select>-->
	<!--end-->

	<!--Start delete by xiepufeng at 2020年3月13日 remark ddc 由于ddc 系统名称会变动模糊查询不在适用-->
	<!--<select id="searchLikeClilder" parameterType="string" resultMap="sbdyMap">
		SELECT * FROM BES_SBPZ_STRUCT WHERE F_SYS_NAME LIKE CONCAT(#{f_sys_name},'%')
	</select>-->

	<!--start add xiepufeng 2020年3月12日  -->
	<select id="searchChildren" parameterType="string" resultMap="sbdyMap">
		(SELECT  DATA.* FROM(
		SELECT
		@ids as _ids,
		( SELECT @ids := GROUP_CONCAT(F_SYS_NAME)
		FROM BES_SBPZ_STRUCT
		WHERE FIND_IN_SET(F_PSYS_NAME, @ids)
		) as cids,
		@l := @l+1 as level
		FROM BES_SBPZ_STRUCT,
		(SELECT @ids :=#{f_sys_name}, @l := 0 ) b
		WHERE @ids IS NOT NULL
		) F_SYS_NAME, BES_SBPZ_STRUCT DATA
		WHERE FIND_IN_SET(DATA.F_PSYS_NAME, F_SYS_NAME._ids)
		ORDER BY level, F_SYS_NAME)
		union
		(select * from bes_sbpz_struct where f_sys_name = #{f_sys_name})
	</select>
	<!--End add xiepufeng 2020年3月12日  -->

	<!--通过系统名称获取获取采集器轮询周期 -->
	<select id="getCollectorLoopTime" parameterType="String" resultType="java.lang.String">
		SELECT F_LOOP_TIME FROM ISSP_TIMER_LIST WHERE F_TIMER_BH =
		 ( SELECT F_TIMER_BH  FROM  BES_SJCJ_TASK  WHERE  F_COLLECTOR_GUID = ( SELECT F_GUID FROM  BES_COLLECTOR WHERE F_SYS_NAME = #{f_sys_name} ))
	</select>

	<!-- 获取指定信息 -->
	<select id="getInfoByColumnName" parameterType="String" resultType="java.util.HashMap">
		SELECT  ${colIdName} ,${colName} FROM ${tabName}
	</select>


	<select id="selectSYS_NAME" parameterType="string" resultType="map">
        select F_SYS_NAME_OLD from bes_sbpz_struct where F_SYS_NAME_OLD=#{F_SYS_NAME_OLD}
    </select>

	<!-- 查询虚点类型 -->
	<select id="findNodeTypeBySysName" parameterType="String" resultType="String">
		select f_node_type from bes_vpoint where f_sys_name = #{f_sys_name}
	</select>

	<!--向定时器表中插入更新采集器所需信息 -->
	<insert id="addCollectorIsspTimerListInfo" parameterType="String">
		INSERT ISSP_TIMER_LIST (F_TIMER_BH,F_LOOP_TIME,F_CRDATE) VALUES ( #{f_guid},#{f_loop_time},current_timestamp()) ;

	</insert>

	<!--数据采集定时任务管理表中插入更新采集器所需信息 -->
	<insert id="addCollectorSjcjTaskInfo" parameterType="String">
		INSERT BES_SJCJ_TASK (F_TASK_BH,F_TIMER_BH,F_COLLECTOR_GUID,F_CRDATE) VALUES ( #{f_guid},#{f_guid},#{f_guid},current_timestamp()) ;
	</insert>

	<!--通过GUID更新采集器轮询周期 -->
	<update id="updateCollectorLoopTime" parameterType="String">
		UPDATE ISSP_TIMER_LIST SET  F_LOOP_TIME = #{f_loop_time} , F_CHDATE = current_timestamp() WHERE F_TIMER_BH =
		(SELECT F_TIMER_BH FROM BES_SJCJ_TASK WHERE F_COLLECTOR_GUID = #{f_guid})
	</update>

	<sql id="find_xxx">
	    <![CDATA[
			SELECT F_ID,F_SBID,F_SYS_NAME,F_SYS_NAME_OLD, F_NICK_NAME,F_ALLPATH,F_DESCRIPTION, F_TYPE,F_NODE_ATTRIBUTION, F_ISSYN, F_PSYS_NAME, F_STATUS, F_TO_OPC, F_OPC_WR,F_CRDATE, F_CHDATE,F_XH_TYPE
	    ]]>
	</sql>
	<sql id="find_xxxDO">
	    <![CDATA[
			select
			F_GUID,
			F_SBID,
			F_STRUCT_ID,
			F_SYS_NAME,
			F_NICK_NAME,
			F_NODE_TYPE,
			F_CHANNEL_INDEX,
			F_ENABLED,
			F_REVERSED,
			F_WORK_MODE,
			F_ALARM_ENABLE,
			F_ALARM_TYPE,
			F_ALARM_PRIORITY,
			F_INIT_VAL,
			F_DESCRIPTION,
			F_YQBH,
			F_CRDATE,
			F_CHDATE
	    ]]>
	</sql>
	<sql id="from_xxx">
	    <![CDATA[
	    	FROM BES_SBPZ_STRUCT
	    ]]>
	</sql>
	<sql id="from_xxxDO">
	    <![CDATA[
	    	FROM bes_digit_ouput
	    ]]>
	</sql>

	<!--添加设备树信息  -->
	<insert id="addSbTreeStructInfo" parameterType="com.alibaba.fastjson.JSONObject">
		insert ${obj.tabName}   (
		<if test='obj.f_sbid != null and obj.f_sbid != "" '> <!-- 设备sbid -->
			F_SBID,
		</if>
		<if test='obj.f_sys_name != null and obj.f_sys_name != "" '> <!-- 系统名称 -->
			F_SYS_NAME,
		</if>
		<if test='obj.f_sys_name != null and obj.f_sys_name != "" '> <!-- 系统名称 -->
			F_SYS_NAME_OLD,
		</if>
		<if test='obj.f_nick_name != null and obj.f_nick_name != "" '> <!-- 别名 -->
			F_NICK_NAME,
		</if>
		<if test='obj.f_allpath != null and obj.f_allpath != "" '> <!-- 全路径 -->
			F_ALLPATH,
		</if>
		<if test='obj.f_description != null and obj.f_description != "" '> <!-- 描述 -->
			F_DESCRIPTION,
		</if>
		<if test='obj.f_type != null and obj.f_type != "" '> <!-- 节点类型 -->
			F_TYPE,
		</if>
		<if test='obj.f_psys_name != null and obj.f_psys_name != "" '> <!-- 父系统名称 -->
			F_PSYS_NAME,
		</if>
		<if test='obj.f_status != null '> <!-- 状态 -->
			F_STATUS,
		</if>
		<if test='obj.f_node_attribution != null and obj.f_node_attribution != "" '> <!-- 父系统名称 -->
			F_NODE_ATTRIBUTION,
		</if>
		<!--创建时间  -->
		F_CRDATE
		)
		values (
		<if test='obj.f_sbid != null and obj.f_sbid != "" '> <!-- sbid -->
			#{obj.f_sbid},
		</if>
		<if test='obj.f_sys_name != null and obj.f_sys_name != "" '> <!-- 系统名称 -->
			#{obj.f_sys_name},
		</if>
		<if test='obj.f_sys_name != null and obj.f_sys_name != "" '> <!-- 系统名称 -->
			#{obj.f_sys_name},
		</if>
		<if test='obj.f_nick_name != null and obj.f_nick_name != "" '> <!-- 别名 -->
			#{obj.f_nick_name},
		</if>
		<if test='obj.f_allpath != null and obj.f_allpath != "" '> <!-- 全路径 -->
			#{obj.f_allpath},
		</if>
		<if test='obj.f_description != null and obj.f_description != "" '> <!-- 描述 -->
			#{obj.f_description},
		</if>
		<if test='obj.f_type != null and obj.f_type != "" '> <!-- 节点类型 -->
			#{obj.f_type},
		</if>
		<if test='obj.f_psys_name != null and obj.f_psys_name != "" '> <!-- 父系统名称 -->
			#{obj.f_psys_name},
		</if>
		<if test='obj.f_status != null'> <!-- 状态 -->
			#{obj.f_status},
		</if>
		<if test='obj.f_node_attribution != null and obj.f_node_attribution != "" '> <!-- 父系统名称 -->
			#{obj.f_node_attribution},
		</if>
		<!--创建时间  -->
		current_timestamp()
		)
	</insert>

	<select id="judge" parameterType="string" resultType="map">
		select * from bes_sbpz_struct where F_SYS_NAME_OLD like concat ('%',#{type},'%')

	</select>
	<!--添加设备树属性表信息  -->
	<insert id="addSbTreeAttrInfo" parameterType="com.alibaba.fastjson.JSONObject">
		insert ${obj.attrTabName}   (
		<if test='obj.f_sbid != null and obj.f_sbid != "" '> <!-- 设备id -->
			F_SBID,
		</if>
		<if test='obj.f_energyStatics != null and obj.f_energyStatics != "" '> <!-- 能耗采集 -->
			F_ENERGYSTATICS,
		</if>
		<if test='obj.f_staticsTime != null and obj.f_staticsTime != "" '> <!-- 采集时间 -->
			F_STATICSTIME,
		</if>
		<if test='obj.attr_f_id != null and obj.attr_f_id != "" '> <!--  -->
			F_STRUCT_ID,
		</if>
		<if test='obj.attr_f_sys_name != null and obj.attr_f_sys_name != "" '> <!-- 系统名称 -->
			F_SYS_NAME,
		</if>
		<if test='obj.f_sys_name != null and obj.f_sys_name != "" '> <!-- 系统名称 -->
			F_SYS_NAME_OLD,
		</if>
		<if test='obj.attr_f_nick_name != null and obj.attr_f_nick_name != "" '> <!-- 别名 -->
			F_NICK_NAME,
		</if>
		<if test='obj.attr_f_guid != null and obj.attr_f_guid != "" '> <!-- GUID -->
			F_GUID,
		</if>
		<if test='obj.attr_f_enabled != null and obj.attr_f_enabled != "" '> <!-- 使能状态 -->
			F_ENABLED,
		</if>
		<if test='obj.attr_f_sblxbh != null and obj.attr_f_sblxbh != "" '> <!-- 设备类型编号 -->
			F_SBLXBH,
		</if>
		<if test='obj.attr_f_type != null and obj.attr_f_type != "" '> <!-- 型号 -->
			F_TYPE,
		</if>
		<if test='obj.attr_f_ip_addr != null and obj.attr_f_ip_addr != "" '> <!-- 网络地址 -->
			F_IP_ADDR,
		</if>
		<if test='obj.attr_f_ssqy != null and obj.attr_f_ssqy != "" '> <!-- 归属区域 -->
			F_SSQY,
		</if>
		<if test='obj.attr_f_description != null and obj.attr_f_description != "" '> <!-- 描述 -->
			F_DESCRIPTION,
		</if>
		<if test='obj.attr_f_azwz != null and obj.attr_f_azwz != "" '> <!-- 安装位置 -->
			F_AZWZ,
		</if>
		<if test='obj.attr_f_node_type != null and obj.attr_f_node_type != "" '> <!-- 节点类型 -->
			F_NODE_TYPE,
		</if>
		<if test='obj.attr_f_point_type != null and obj.attr_f_point_type != "" '> <!-- 虚点类型 -->
			F_POINT_TYPE,
		</if>
		<if test='obj.attr_f_init_val != null and obj.attr_f_init_val != "" '> <!-- 初始值 -->
			F_INIT_VAL,
		</if>
		<if test='obj.attr_f_accuracy != null and obj.attr_f_accuracy != "" '> <!-- 精度 -->
			F_ACCURACY,
		</if>
		<if test='obj.attr_f_engineer_unit != null and obj.attr_f_engineer_unit != "" '> <!-- 单位 -->
			F_ENGINEER_UNIT,
		</if>
		<if test='obj.attr_f_alarm_enable != null and obj.attr_f_alarm_enable != "" '> <!-- 报警使能 -->
			F_ALARM_ENABLE,
		</if>
		<if test='obj.attr_f_alarm_type != null and obj.attr_f_alarm_type != "" '> <!-- 报警类型 -->
			F_ALARM_TYPE,
		</if>
		<if test='obj.attr_f_high_limit != null and obj.attr_f_high_limit != "" '> <!-- 高限报警 -->
			F_HIGH_LIMIT,
		</if>
		<if test='obj.attr_f_low_limit != null and obj.attr_f_low_limit != "" '> <!-- 低限报警 -->
			F_LOW_LIMIT,
		</if>
		<if test='obj.attr_f_alarm_priority != null and obj.attr_f_alarm_priority != "" '> <!-- 报警优先级 -->
			F_ALARM_PRIORITY,
		</if>
		<if test='obj.attr_f_close_state != null and obj.attr_f_close_state != "" '> <!-- 闭合状态 -->
			F_CLOSE_STATE,
		</if>
		<if test='obj.attr_f_work_mode != null and obj.attr_f_work_mode != "" '> <!-- 工作模式 -->
			F_WORK_MODE,
		</if>
		<if test='obj.attr_f_max_val != null and obj.attr_f_max_val != "" '> <!-- 最大值 -->
			F_MAX_VAL,
		</if>
		<if test='obj.attr_f_min_val != null and obj.attr_f_min_val != "" '> <!-- 最小值 -->
			F_MIN_VAL,
		</if>
		<if test='obj.attr_f_reversed != null and obj.attr_f_reversed != "" '> <!-- 是否反向 -->
			F_REVERSED,
		</if>
		<if test='obj.attr_f_sinnal_type != null and obj.attr_f_sinnal_type != "" '> <!-- 信号类型 -->
			F_SINNAL_TYPE,
		</if>
		<if test='obj.attr_f_sourced != null and obj.attr_f_sourced != "" '> <!-- 是否有源 -->
			F_SOURCED,
		</if>
		<if test='obj.attr_f_addr != null and obj.attr_f_addr != "" '> <!-- 通信地址 -->
			F_ADDR,
		</if>
		<if test='obj.attr_f_coll_cycle != null and obj.attr_f_coll_cycle != "" '> <!-- 采集周期 -->
			F_COLL_CYCLE,
		</if>
		<if test='obj.attr_f_his_data_save_cycle != null and obj.attr_f_his_data_save_cycle != "" '> <!-- 历史数据保存周期 -->
			F_HIS_DATA_SAVE_CYCLE,
		</if>
		<if test='obj.attr_f_port != null and obj.attr_f_port != "" '> <!-- 端口号 -->
			F_PORT,
		</if>
		<if test='obj.attr_f_blxbh != null and obj.attr_f_blxbh != "" '> <!-- 电表类型编号 -->
			F_BLXBH,
		</if>
		<if test='obj.attr_f_blxmc != null and obj.attr_f_blxmc != "" '> <!-- 电表类型名称 -->
			F_BLXMC,
		</if>
		<if test='obj.attr_f_communication_port != null and obj.attr_f_communication_port != "" '> <!-- 通信端口 -->
			F_COMMUNICATION_PORT,
		</if>
		<if test='obj.attr_f_comm_rate != null and obj.attr_f_comm_rate != "" '> <!-- 通信波特率编号 -->
			F_COMM_RATE,
		</if>
		<if test='obj.attr_f_comm_rate_mc != null and obj.attr_f_comm_rate_mc != "" '> <!-- 通信波特率名称 -->
			F_COMM_RATE_MC,
		</if>
		<if test='obj.attr_f_protocol_type != null and obj.attr_f_protocol_type != "" '> <!-- 通信协议编号 -->
			F_PROTOCOL_TYPE,
		</if>
		<if test='obj.attr_f_protocol_type_mc != null and obj.attr_f_protocol_type_mc != "" '> <!-- 通信协议名称 -->
			F_PROTOCOL_TYPE_MC,
		</if>
		<if test='obj.attr_f_wldz != null and obj.attr_f_wldz != "" '> <!-- 物理地址 -->
			F_WLDZ,
		</if>
		<if test='obj.attr_f_cjfabh != null and obj.attr_f_cjfabh != "" '> <!-- 采集方案编号 -->
			F_CJFABH,
		</if>
		<if test='obj.attr_f_cjfamc != null and obj.attr_f_cjfamc != "" '> <!-- 采集方案名称 -->
			F_CJFAMC,
		</if>
		<if test='obj.attr_f_percentage != null and obj.attr_f_percentage != "" '> <!-- 变比 -->
			F_PERCENTAGE,
		</if>
		<if test='obj.attr_f_collector_state != null and obj.attr_f_collector_state != "" '> <!-- 采集器同步状态 -->
			F_COLLECTOR_STATE,
		</if>
		<if test='obj.attr_f_ammeter_state != null and obj.attr_f_ammeter_state != "" '> <!-- 电表同步状态 -->
			F_AMMETER_STATE,
		</if>
		<if test='obj.attr_f_ddc_state != null and obj.attr_f_ddc_state != "" '> <!-- ddc同步状态 -->
			F_DDC_STATE,
		</if>
		<if test='obj.attr_f_module_state != null and obj.attr_f_module_state != "" '> <!-- 模块同步状态 -->
			F_MODULE_STATE,
		</if>
		<if test='obj.attr_f_online_state != null and obj.attr_f_online_state != "" '> <!-- 在线状态 -->
			F_ONLINE_STATE,
		</if>
		<if test='obj.attr_f_channel_index != null and obj.attr_f_channel_index != "" '> <!-- 逻辑点通道索引 -->
			F_CHANNEL_INDEX,
		</if>
		<if test='obj.attr_f_belong_iprouter != null and obj.attr_f_belong_iprouter != "" '> <!-- 耦合器归属系统 -->
			F_BELONG_IPROUTER,
		</if>
		<if test='obj.f_yqbh != null and obj.f_yqbh != "" '> <!-- 园区编号 -->
			F_YQBH,
		</if>
		<if test='obj.attr_f_loop_time != null and obj.attr_f_loop_time != "" '> <!-- 上传周期 -->
			F_UPLOAD_CYCLE,
		</if>
		<if test='obj.f_com_data_bit != null and obj.f_com_data_bit != "" '> <!-- 数据位 -->
			F_COM_DATA_BIT,
		</if>
		<if test='obj.f_com_parity_bit != null and obj.f_com_parity_bit != "" '> <!-- 校验位 -->
			F_COM_PARITY_BIT,
		</if>
		<if test='obj.f_com_stop_bit != null and obj.f_com_stop_bit != "" '> <!-- 停止位 -->
			F_COM_STOP_BIT,
		</if>
		<if test='obj.f_function_code != null and obj.f_function_code != "" '> <!-- 功能码 -->
			F_FUNCTION_CODE,
		</if>
		<if test='obj.f_channel_id != null and obj.f_channel_id != "" '> <!-- 通道id -->
            F_CHANNEL_ID,
		</if>
		<if test='obj.assets_code != null and obj.assets_code != "" '> <!-- 资产编码 -->
			ASSETS_CODE,
		</if>


		<!--创建时间  -->
		F_CRDATE,F_CHDATE
		)
		values (
		<if test='obj.f_sbid != null and obj.f_sbid != "" '> <!-- 设备id -->
			#{obj.f_sbid},
		</if>
		<if test='obj.f_energyStatics != null and obj.f_energyStatics != "" '> <!-- 能耗采集 -->
			#{obj.f_energyStatics},
		</if>
		<if test='obj.f_staticsTime != null and obj.f_staticsTime != "" '> <!-- 采集时间 -->
			#{obj.f_staticsTime},
		</if>
		<if test='obj.attr_f_id != null and obj.attr_f_id != "" '> <!-- 设备树id -->
			#{obj.attr_f_id},
		</if>
		<if test='obj.attr_f_sys_name != null and obj.attr_f_sys_name != "" '> <!-- 系统名称 -->
			#{obj.attr_f_sys_name},
		</if>
		<if test='obj.f_sys_name != null and obj.f_sys_name != "" '> <!-- 系统名称 -->
			#{obj.f_sys_name},
		</if>

		<if test='obj.attr_f_nick_name != null and obj.attr_f_nick_name != "" '> <!-- 别名 -->
			#{obj.attr_f_nick_name},
		</if>
		<if test='obj.attr_f_guid != null and obj.attr_f_guid != "" '> <!-- GUID -->
			#{obj.attr_f_guid},
		</if>
		<if test='obj.attr_f_enabled != null and obj.attr_f_enabled != "" '> <!-- 使能状态 -->
			#{obj.attr_f_enabled},
		</if>
		<if test='obj.attr_f_sblxbh != null and obj.attr_f_sblxbh != "" '> <!-- 设备类型编号 -->
			#{obj.attr_f_sblxbh},
		</if>
		<if test='obj.attr_f_type != null and obj.attr_f_type != "" '> <!-- 型号 -->
			#{obj.attr_f_type},
		</if>
		<if test='obj.attr_f_ip_addr != null and obj.attr_f_ip_addr != "" '> <!-- 网络地址 -->
			#{obj.attr_f_ip_addr},
		</if>
		<if test='obj.attr_f_ssqy != null and obj.attr_f_ssqy != "" '> <!-- 归属区域 -->
			#{obj.attr_f_ssqy},
		</if>
		<if test='obj.attr_f_description != null and obj.attr_f_description != "" '> <!-- 描述 -->
			#{obj.attr_f_description},
		</if>
		<if test='obj.attr_f_azwz != null and obj.attr_f_azwz != "" '> <!-- 安装位置 -->
			#{obj.attr_f_azwz},
		</if>
		<if test='obj.attr_f_node_type != null and obj.attr_f_node_type != "" '> <!-- 节点类型 -->
			#{obj.attr_f_node_type},
		</if>
		<if test='obj.attr_f_point_type != null and obj.attr_f_point_type != "" '> <!-- 虚点类型 -->
			#{obj.attr_f_point_type},
		</if>
		<if test='obj.attr_f_init_val != null and obj.attr_f_init_val != "" '> <!-- 初始值 -->
			#{obj.attr_f_init_val},
		</if>
		<if test='obj.attr_f_accuracy != null and obj.attr_f_accuracy != "" '> <!-- 精度 -->
			#{obj.attr_f_accuracy},
		</if>
		<if test='obj.attr_f_engineer_unit != null and obj.attr_f_engineer_unit != "" '> <!-- 单位 -->
			#{obj.attr_f_engineer_unit},
		</if>
		<if test='obj.attr_f_alarm_enable != null and obj.attr_f_alarm_enable != "" '> <!-- 报警使能 -->
			#{obj.attr_f_alarm_enable},
		</if>
		<if test='obj.attr_f_alarm_type != null and obj.attr_f_alarm_type != "" '> <!-- 报警类型 -->
			#{obj.attr_f_alarm_type},
		</if>
		<if test='obj.attr_f_high_limit != null and obj.attr_f_high_limit != "" '> <!-- 高限报警 -->
			#{obj.attr_f_high_limit},
		</if>
		<if test='obj.attr_f_low_limit != null and obj.attr_f_low_limit != "" '> <!-- 低限报警 -->
			#{obj.attr_f_low_limit},
		</if>
		<if test='obj.attr_f_alarm_priority != null and obj.attr_f_alarm_priority != "" '> <!-- 报警优先级 -->
			#{obj.attr_f_alarm_priority},
		</if>
		<if test='obj.attr_f_close_state != null and obj.attr_f_close_state != "" '> <!-- 闭合状态 -->
			#{obj.attr_f_close_state},
		</if>
		<if test='obj.attr_f_work_mode != null and obj.attr_f_work_mode != "" '> <!-- 工作模式 -->
			#{obj.attr_f_work_mode},
		</if>
		<if test='obj.attr_f_max_val != null and obj.attr_f_max_val != "" '> <!-- 最大值 -->
			#{obj.attr_f_max_val},
		</if>
		<if test='obj.attr_f_min_val != null and obj.attr_f_min_val != "" '> <!-- 最小值 -->
			#{obj.attr_f_min_val},
		</if>
		<if test='obj.attr_f_reversed != null and obj.attr_f_reversed != "" '> <!-- 是否反向 -->
			#{obj.attr_f_reversed},
		</if>
		<if test='obj.attr_f_sinnal_type != null and obj.attr_f_sinnal_type != "" '> <!-- 信号类型 -->
			#{obj.attr_f_sinnal_type},
		</if>
		<if test='obj.attr_f_sourced != null and obj.attr_f_sourced != "" '> <!-- 是否有源 -->
			#{obj.attr_f_sourced},
		</if>
		<if test='obj.attr_f_addr != null and obj.attr_f_addr != "" '> <!-- 通信地址 -->
			#{obj.attr_f_addr},
		</if>
		<if test='obj.attr_f_coll_cycle != null and obj.attr_f_coll_cycle != "" '> <!-- 采集周期 -->
			#{obj.attr_f_coll_cycle},
		</if>
		<if test='obj.attr_f_his_data_save_cycle != null and obj.attr_f_his_data_save_cycle != "" '> <!-- 历史数据保存周期 -->
			#{obj.attr_f_his_data_save_cycle},
		</if>
		<if test='obj.attr_f_port != null and obj.attr_f_port != "" '> <!-- 端口号 -->
			#{obj.attr_f_port},
		</if>
		<if test='obj.attr_f_blxbh != null and obj.attr_f_blxbh != "" '> <!-- 电表类型编号 -->
			#{obj.attr_f_blxbh},
		</if>
		<if test='obj.attr_f_blxmc != null and obj.attr_f_blxmc != "" '> <!-- 电表类型名称 -->
			#{obj.attr_f_blxmc},
		</if>
		<if test='obj.attr_f_communication_port != null and obj.attr_f_communication_port != "" '> <!-- 通信端口 -->
			#{obj.attr_f_communication_port},
		</if>
		<if test='obj.attr_f_comm_rate != null and obj.attr_f_comm_rate != "" '> <!-- 通信波特率编号 -->
			#{obj.attr_f_comm_rate},
		</if>
		<if test='obj.attr_f_comm_rate_mc != null and obj.attr_f_comm_rate_mc != "" '> <!-- 通信波特率名称 -->
			#{obj.attr_f_comm_rate_mc},
		</if>
		<if test='obj.attr_f_protocol_type != null and obj.attr_f_protocol_type != "" '> <!-- 通信协议编号 -->
			#{obj.attr_f_protocol_type},
		</if>
		<if test='obj.attr_f_protocol_type_mc != null and obj.attr_f_protocol_type_mc != "" '> <!-- 通信协议名称 -->
			#{obj.attr_f_protocol_type_mc},
		</if>
		<if test='obj.attr_f_wldz != null and obj.attr_f_wldz != "" '> <!-- 物理地址 -->
			#{obj.attr_f_wldz},
		</if>
		<if test='obj.attr_f_cjfabh != null and obj.attr_f_cjfabh != "" '> <!-- 采集方案编号 -->
			#{obj.attr_f_cjfabh},
		</if>
		<if test='obj.attr_f_cjfamc != null and obj.attr_f_cjfamc != "" '> <!-- 采集方案名称 -->
			#{obj.attr_f_cjfamc},
		</if>
		<if test='obj.attr_f_percentage != null and obj.attr_f_percentage != "" '> <!-- 变比 -->
			#{obj.attr_f_percentage},
		</if>
		<if test='obj.attr_f_collector_state != null and obj.attr_f_collector_state != "" '> <!-- 采集器同步状态 -->
			#{obj.attr_f_collector_state},
		</if>
		<if test='obj.attr_f_ammeter_state != null and obj.attr_f_ammeter_state != "" '> <!-- 电表同步状态 -->
			#{obj.attr_f_ammeter_state},
		</if>
		<if test='obj.attr_f_ddc_state != null and obj.attr_f_ddc_state != "" '> <!-- DDC同步状态 -->
			#{obj.attr_f_ddc_state},
		</if>
		<if test='obj.attr_f_module_state != null and obj.attr_f_module_state != "" '> <!-- 模块同步状态 -->
			#{obj.attr_f_module_state},
		</if>
		<if test='obj.attr_f_online_state != null and obj.attr_f_online_state != "" '> <!-- 在线状态 -->
			#{obj.attr_f_online_state},
		</if>
		<if test='obj.attr_f_channel_index != null and obj.attr_f_channel_index != "" '> <!-- 逻辑点通道索引 -->
			#{obj.attr_f_channel_index},
		</if>
		<if test='obj.attr_f_belong_iprouter != null and obj.attr_f_belong_iprouter != "" '> <!-- 耦合器所属系统 -->
			#{obj.attr_f_belong_iprouter},
		</if>
		<if test='obj.f_yqbh != null and obj.f_yqbh != "" '> <!-- 园区编号 -->
			#{obj.f_yqbh},
		</if>
		<if test='obj.attr_f_loop_time != null and obj.attr_f_loop_time != "" '> <!-- 能耗上传周期 -->
			#{obj.attr_f_loop_time},
		</if>
		<if test='obj.f_com_data_bit != null and obj.f_com_data_bit != "" '> <!-- 数据位 -->
			#{obj.f_com_data_bit},
		</if>
		<if test='obj.f_com_parity_bit != null and obj.f_com_parity_bit != "" '> <!-- 校验位 -->
			#{obj.f_com_parity_bit},
		</if>
		<if test='obj.f_com_stop_bit != null and obj.f_com_stop_bit != "" '> <!-- 停止位 -->
			#{obj.f_com_stop_bit},
		</if>
		<if test='obj.f_function_code != null and obj.f_function_code != "" '> <!-- 功能码 -->
			#{obj.f_function_code},
		</if>
		<if test='obj.f_channel_id != null and obj.f_channel_id != "" '> <!-- 通道id -->
			#{obj.f_channel_id},
		</if>
			<if test='obj.assets_code != null and obj.assets_code != "" '> <!-- 资产编码 -->
			#{obj.assets_code},
		</if>
		<!--创建时间  -->
		current_timestamp(),current_timestamp()

		)
	</insert>

	<!-- 根据系统名称编辑设备树信息 -->
	<update id="editSbTreeStructInfoBySysName" parameterType="com.alibaba.fastjson.JSONObject">
		UPDATE ${obj.tabName}
		<set>
			<if test="obj.attr_f_sys_name != null and obj.attr_f_sys_name !=''">
				F_SYS_NAME_OLD = #{obj.attr_f_sys_name},
			</if>
			<if test="obj.f_enabled != null and obj.f_enabled !=''">
				F_ENABLED = #{obj.f_enabled},
			</if>
			<if test="obj.f_type != null and obj.f_type !='' ">
				F_TYPE = #{obj.f_type},
			</if>
			<if test="obj.f_nick_name != null and obj.f_nick_name !='' ">
				F_NICK_NAME = #{obj.f_nick_name},
			</if>
			<if test="obj.f_ip_addr != null and obj.f_ip_addr !='' ">
				F_IP_ADDR = #{obj.f_ip_addr},
			</if>
			<if test="obj.f_ssqy != null and obj.f_ssqy !='' ">
				F_SSQY = #{obj.f_ssqy},
			</if>
			<if test="obj.f_description != null and obj.f_description !='' ">
				F_DESCRIPTION = #{obj.f_description},
			</if>
			<if test="obj.f_channel_index != null and obj.f_channel_index !='' "><!-- 通道索引 -->
				F_CHANNEL_INDEX = #{obj.f_channel_index},
			</if>
			<if test="obj.f_type != null and obj.f_type !='' "><!-- 型号 -->
				F_TYPE = #{obj.f_type},
			</if>
			<if test="obj.f_azwz != null and obj.f_azwz !='' "><!-- 安装位置 -->
				F_AZWZ = #{obj.f_azwz},
			</if>
			<if test="obj.f_init_val != null "><!-- 初 始 值 -->
				F_INIT_VAL = #{obj.f_init_val},
			</if>
			<if test="obj.f_engineer_unit != null and obj.f_engineer_unit !='' "><!-- 工程单位 -->
				F_ENGINEER_UNIT = #{obj.f_engineer_unit},
			</if>
			<if test="obj.f_accuracy != null and obj.f_accuracy !='' "><!-- 精度 -->
				F_ACCURACY = #{obj.f_accuracy},
			</if>
			<if test="obj.f_point_type != null and obj.f_point_type !='' "><!-- 虚点类型 -->
				F_POINT_TYPE = #{obj.f_point_type},
			</if>
			<if test="obj.f_alarm_enable != null and obj.f_alarm_enable !='' "><!-- 报警使能 -->
				F_ALARM_ENABLE = #{obj.f_alarm_enable},
			</if>
			<if test="obj.f_alarm_type != null and obj.f_alarm_type !='' "><!-- 报警类型 -->
				F_ALARM_TYPE = #{obj.f_alarm_type},
			</if>
			<if test="obj.f_high_limit != null and obj.f_high_limit !='' "><!-- 高限报警 -->
				F_HIGH_LIMIT = #{obj.f_high_limit},
			</if>
			<if test="obj.f_low_limit != null and obj.f_low_limit !='' "><!-- 低限报警 -->
				F_LOW_LIMIT = #{obj.f_low_limit},
			</if>
			<if test="obj.f_alarm_priority != null and obj.f_alarm_priority !='' "><!-- 报警优先级 -->
				F_ALARM_PRIORITY = #{obj.f_alarm_priority},
			</if>
			<if test="obj.f_addr != null and obj.f_addr !='' "><!-- 通信地址 -->
				F_ADDR = #{obj.f_addr},
			</if>
			<if test="obj.f_node_type != null and obj.f_node_type !='' "><!-- 点类型 -->
				F_NODE_TYPE = #{obj.f_node_type},
			</if>
			<if test="obj.f_work_mode != null and obj.f_work_mode !='' "><!-- 工作模式 -->
				F_WORK_MODE = #{obj.f_work_mode},
			</if>
			<if test="obj.f_max_val != null and obj.f_max_val !='' "><!-- 最大值 -->
				F_MAX_VAL = #{obj.f_max_val},
			</if>
			<if test="obj.f_min_val != null and obj.f_min_val !='' "><!-- 最小值 -->
				F_MIN_VAL = #{obj.f_min_val},
			</if>
			<if test="obj.f_reversed != null and obj.f_reversed !='' "><!-- 是否反向 -->
				F_REVERSED = #{obj.f_reversed},
			</if>
			<if test="obj.f_sinnal_type != null and obj.f_sinnal_type !='' "><!-- 信号类型 -->
				F_SINNAL_TYPE = #{obj.f_sinnal_type},
			</if>
			<if test="obj.f_blxbh != null and obj.f_blxbh !='' "><!-- 电表类型编号 -->
				F_BLXBH = #{obj.f_blxbh},
			</if>
			<if test="obj.f_blxmc != null and obj.f_blxmc !='' "><!-- 电表类型名称 -->
				F_BLXMC = #{obj.f_blxmc},
			</if>
			<if test="obj.f_communication_port != null and obj.f_communication_port !='' "><!-- 通信端口 -->
				F_COMMUNICATION_PORT = #{obj.f_communication_port},
			</if>
			<if test="obj.f_comm_rate != null and obj.f_comm_rate !='' "><!-- 通信波特率编号 -->
				F_COMM_RATE = #{obj.f_comm_rate},
			</if>
			<if test="obj.f_comm_rate_mc != null and obj.f_comm_rate_mc !='' "><!-- 通信波特率编号 -->
				F_COMM_RATE_MC = #{obj.f_comm_rate_mc},
			</if>
			<if test="obj.f_protocol_type != null and obj.f_protocol_type !='' "><!-- 通信协议编号 -->
				F_PROTOCOL_TYPE = #{obj.f_protocol_type},
			</if>
			<if test="obj.f_protocol_type_mc != null and obj.f_protocol_type_mc !='' "><!-- 通信协议编号 -->
				F_PROTOCOL_TYPE_MC = #{obj.f_protocol_type_mc},
			</if>
			<if test="obj.f_wldz != null and obj.f_wldz !='' "><!-- 物理地址 -->
				F_WLDZ = #{obj.f_wldz},
			</if>
			<if test="obj.f_cjfabh != null and obj.f_cjfabh !='' "><!-- 采集方案编号 -->
				F_CJFABH = #{obj.f_cjfabh},
			</if>
			<if test="obj.f_cjfamc != null and obj.f_cjfamc !='' "><!-- 采集方案名称 -->
				F_CJFAMC = #{obj.f_cjfamc},
			</if>
			<if test="obj.f_percentage != null and obj.f_percentage !='' "><!-- 变比 -->
				F_PERCENTAGE = #{obj.f_percentage},
			</if>
			<if test="obj.f_close_state != null and obj.f_close_state !='' "><!-- 闭合状态 -->
				F_CLOSE_STATE = #{obj.f_close_state},
			</if>
			<if test="obj.f_sblxbh != null and obj.f_sblxbh !='' "><!-- 设备类型编号 -->
				F_SBLXBH = #{obj.f_sblxbh},
			</if>
			<if test="obj.f_allpath != null and obj.f_allpath !='' and obj.tabName =='BES_SBPZ_STRUCT' "><!-- 设备树结构表中全路径 -->
				F_ALLPATH = #{obj.f_allpath},
			</if>
			<if test="obj.f_status != null and obj.tabName =='BES_SBPZ_STRUCT' "><!-- 设备树结构表中在线状态 -->
				F_STATUS = #{obj.f_status},
			</if>
			<if test="obj.f_port != null and obj.f_port !='' "><!-- 设备类型编号 -->
				F_PORT = #{obj.f_port},
			</if>
			<if test="obj.f_belong_iprouter != null and obj.f_belong_iprouter !='' "><!-- 耦合器的归属系统 -->
				F_BELONG_IPROUTER = #{obj.f_belong_iprouter},
			</if>
			<!--修改时间  -->
			F_CHDATE = current_timestamp()
		</set>
		WHERE F_SYS_NAME=#{obj.f_sys_name}
	</update>

	<update id="editSbTreeStructInfo" parameterType="com.alibaba.fastjson.JSONObject">
		UPDATE ${obj.tabName}
		<set>
			<if test="obj.attr_f_sys_name != null and obj.attr_f_sys_name !=''">
				F_SYS_NAME_OLD = #{obj.attr_f_sys_name},
			</if>
			<if test="obj.f_type != null and obj.f_type !='' ">
				F_TYPE = #{obj.f_type},
			</if>
			<if test="obj.f_nick_name != null and obj.f_nick_name !='' ">
				F_NICK_NAME = #{obj.f_nick_name},
			</if>
			<if test="obj.f_ip_addr != null and obj.f_ip_addr !='' ">
				F_IP_ADDR = #{obj.f_ip_addr},
			</if>
			<if test="obj.f_ssqy != null and obj.f_ssqy !='' ">
				F_SSQY = #{obj.f_ssqy},
			</if>
			<if test="obj.f_description != null and obj.f_description !='' ">
				F_DESCRIPTION = #{obj.f_description},
			</if>
			<if test="obj.f_channel_index != null and obj.f_channel_index !='' "><!-- 通道索引 -->
				F_CHANNEL_INDEX = #{obj.f_channel_index},
			</if>
			<if test="obj.f_type != null and obj.f_type !='' "><!-- 型号 -->
				F_TYPE = #{obj.f_type},
			</if>
			<if test="obj.f_azwz != null and obj.f_azwz !='' "><!-- 安装位置 -->
				F_AZWZ = #{obj.f_azwz},
			</if>
			<if test="obj.f_init_val != null "><!-- 初 始 值 -->
				F_INIT_VAL = #{obj.f_init_val},
			</if>
			<if test="obj.f_engineer_unit != null and obj.f_engineer_unit !='' "><!-- 工程单位 -->
				F_ENGINEER_UNIT = #{obj.f_engineer_unit},
			</if>
			<if test="obj.f_accuracy != null and obj.f_accuracy !='' "><!-- 精度 -->
				F_ACCURACY = #{obj.f_accuracy},
			</if>
			<if test="obj.f_point_type != null and obj.f_point_type !='' "><!-- 虚点类型 -->
				F_POINT_TYPE = #{obj.f_point_type},
			</if>
			<if test="obj.f_alarm_enable != null and obj.f_alarm_enable !='' "><!-- 报警使能 -->
				F_ALARM_ENABLE = #{obj.f_alarm_enable},
			</if>
			<if test="obj.f_alarm_type != null and obj.f_alarm_type !='' "><!-- 报警类型 -->
				F_ALARM_TYPE = #{obj.f_alarm_type},
			</if>
			<if test="obj.f_high_limit != null and obj.f_high_limit !='' "><!-- 高限报警 -->
				F_HIGH_LIMIT = #{obj.f_high_limit},
			</if>
			<if test="obj.f_low_limit != null and obj.f_low_limit !='' "><!-- 低限报警 -->
				F_LOW_LIMIT = #{obj.f_low_limit},
			</if>
			<if test="obj.f_alarm_priority != null and obj.f_alarm_priority !='' "><!-- 报警优先级 -->
				F_ALARM_PRIORITY = #{obj.f_alarm_priority},
			</if>
			<if test="obj.f_addr != null and obj.f_addr !='' "><!-- 通信地址 -->
				F_ADDR = #{obj.f_addr},
			</if>
			<if test="obj.f_node_type != null and obj.f_node_type !='' "><!-- 点类型 -->
				F_NODE_TYPE = #{obj.f_node_type},
			</if>
			<if test="obj.f_work_mode != null and obj.f_work_mode !='' "><!-- 工作模式 -->
				F_WORK_MODE = #{obj.f_work_mode},
			</if>
			<if test="obj.f_max_val != null and obj.f_max_val !='' "><!-- 最大值 -->
				F_MAX_VAL = #{obj.f_max_val},
			</if>
			<if test="obj.f_min_val != null and obj.f_min_val !='' "><!-- 最小值 -->
				F_MIN_VAL = #{obj.f_min_val},
			</if>
			<if test="obj.f_reversed != null and obj.f_reversed !='' "><!-- 是否反向 -->
				F_REVERSED = #{obj.f_reversed},
			</if>
			<if test="obj.f_sinnal_type != null and obj.f_sinnal_type !='' "><!-- 信号类型 -->
				F_SINNAL_TYPE = #{obj.f_sinnal_type},
			</if>
			<if test="obj.f_blxbh != null and obj.f_blxbh !='' "><!-- 电表类型编号 -->
				F_BLXBH = #{obj.f_blxbh},
			</if>
			<if test="obj.f_blxmc != null and obj.f_blxmc !='' "><!-- 电表类型名称 -->
				F_BLXMC = #{obj.f_blxmc},
			</if>
			<if test="obj.f_communication_port != null and obj.f_communication_port !='' "><!-- 通信端口 -->
				F_COMMUNICATION_PORT = #{obj.f_communication_port},
			</if>
			<if test="obj.f_comm_rate != null and obj.f_comm_rate !='' "><!-- 通信波特率编号 -->
				F_COMM_RATE = #{obj.f_comm_rate},
			</if>
			<if test="obj.f_comm_rate_mc != null and obj.f_comm_rate_mc !='' "><!-- 通信波特率编号 -->
				F_COMM_RATE_MC = #{obj.f_comm_rate_mc},
			</if>
			<if test="obj.f_protocol_type != null and obj.f_protocol_type !='' "><!-- 通信协议编号 -->
				F_PROTOCOL_TYPE = #{obj.f_protocol_type},
			</if>
			<if test="obj.f_protocol_type_mc != null and obj.f_protocol_type_mc !='' "><!-- 通信协议编号 -->
				F_PROTOCOL_TYPE_MC = #{obj.f_protocol_type_mc},
			</if>
			<if test="obj.f_wldz != null and obj.f_wldz !='' "><!-- 物理地址 -->
				F_WLDZ = #{obj.f_wldz},
			</if>
			<if test="obj.f_cjfabh != null and obj.f_cjfabh !='' "><!-- 采集方案编号 -->
				F_CJFABH = #{obj.f_cjfabh},
			</if>
			<if test="obj.f_cjfamc != null and obj.f_cjfamc !='' "><!-- 采集方案名称 -->
				F_CJFAMC = #{obj.f_cjfamc},
			</if>
			<if test="obj.f_percentage != null and obj.f_percentage !='' "><!-- 变比 -->
				F_PERCENTAGE = #{obj.f_percentage},
			</if>
			<if test="obj.f_close_state != null and obj.f_close_state !='' "><!-- 闭合状态 -->
				F_CLOSE_STATE = #{obj.f_close_state},
			</if>
			<if test="obj.f_sblxbh != null and obj.f_sblxbh !='' "><!-- 设备类型编号 -->
				F_SBLXBH = #{obj.f_sblxbh},
			</if>
			<if test="obj.f_allpath != null and obj.f_allpath !='' and obj.tabName =='BES_SBPZ_STRUCT' "><!-- 设备树结构表中全路径 -->
				F_ALLPATH = #{obj.f_allpath},
			</if>
			<if test="obj.f_status != null and obj.tabName =='BES_SBPZ_STRUCT' "><!-- 设备树结构表中在线状态 -->
				F_STATUS = #{obj.f_status},
			</if>
			<if test="obj.f_port != null and obj.f_port !='' "><!-- 设备类型编号 -->
				F_PORT = #{obj.f_port},
			</if>
			<if test="obj.f_belong_iprouter != null and obj.f_belong_iprouter !='' "><!-- 耦合器的归属系统 -->
				F_BELONG_IPROUTER = #{obj.f_belong_iprouter},
			</if>
			<!--修改时间  -->
			F_CHDATE = current_timestamp()
		</set>
		WHERE F_SYS_NAME=#{obj.f_sys_name}
	</update>

	<update id="editSbTreeStructInfoBySysNameChange" parameterType="com.alibaba.fastjson.JSONObject">
		UPDATE ${obj.tabName}
		<set>
			<if test="obj.f_sys_name != null and obj.f_sys_name !=''">
				F_SYS_NAME = #{obj.f_sys_name},
			</if>
			<if test="obj.f_enabled != null and obj.f_enabled !=''">
				F_ENABLED = #{obj.f_enabled},
			</if>
			<if test="obj.f_type != null and obj.f_type !='' ">
				F_TYPE = #{obj.f_type},
			</if>
			<if test="obj.f_nick_name != null and obj.f_nick_name !='' ">
				F_NICK_NAME = #{obj.f_nick_name},
			</if>
			<if test="obj.f_ip_addr != null and obj.f_ip_addr !='' ">
				F_IP_ADDR = #{obj.f_ip_addr},
			</if>
			<if test="obj.f_ssqy != null and obj.f_ssqy !='' ">
				F_SSQY = #{obj.f_ssqy},
			</if>
			<if test="obj.f_description != null and obj.f_description !='' ">
				F_DESCRIPTION = #{obj.f_description},
			</if>
			<if test="obj.f_channel_index != null and obj.f_channel_index !='' "><!-- 通道索引 -->
				F_CHANNEL_INDEX = #{obj.f_channel_index},
			</if>
			<if test="obj.f_type != null and obj.f_type !='' "><!-- 型号 -->
				F_TYPE = #{obj.f_type},
			</if>
			<if test="obj.f_azwz != null and obj.f_azwz !='' "><!-- 安装位置 -->
				F_AZWZ = #{obj.f_azwz},
			</if>
			<if test="obj.f_init_val != null "><!-- 初 始 值  -->
				F_INIT_VAL = #{obj.f_init_val},
			</if>
			<if test="obj.f_engineer_unit != null and obj.f_engineer_unit !='' "><!-- 工程单位 -->
				F_ENGINEER_UNIT = #{obj.f_engineer_unit},
			</if>
			<if test="obj.f_accuracy != null and obj.f_accuracy !='' "><!-- 精度 -->
				F_ACCURACY = #{obj.f_accuracy},
			</if>
			<if test="obj.f_point_type != null and obj.f_point_type !='' "><!-- 虚点类型 -->
				F_POINT_TYPE = #{obj.f_point_type},
			</if>
			<if test="obj.f_alarm_enable != null and obj.f_alarm_enable !='' "><!-- 报警使能 -->
				F_ALARM_ENABLE = #{obj.f_alarm_enable},
			</if>
			<if test="obj.f_alarm_type != null and obj.f_alarm_type !='' "><!-- 报警类型 -->
				F_ALARM_TYPE = #{obj.f_alarm_type},
			</if>
			<if test="obj.f_high_limit != null and obj.f_high_limit !='' "><!-- 高限报警 -->
				F_HIGH_LIMIT = #{obj.f_high_limit},
			</if>
			<if test="obj.f_low_limit != null and obj.f_low_limit !='' "><!-- 低限报警 -->
				F_LOW_LIMIT = #{obj.f_low_limit},
			</if>
			<if test="obj.f_alarm_priority != null and obj.f_alarm_priority !='' "><!-- 报警优先级 -->
				F_ALARM_PRIORITY = #{obj.f_alarm_priority},
			</if>
			<if test="obj.f_addr != null and obj.f_addr !='' "><!-- 通信地址 -->
				F_ADDR = #{obj.f_addr},
			</if>
			<if test="obj.f_node_type != null and obj.f_node_type !='' "><!-- 点类型 -->
				F_NODE_TYPE = #{obj.f_node_type},
			</if>
			<if test="obj.f_work_mode != null and obj.f_work_mode !='' "><!-- 工作模式 -->
				F_WORK_MODE = #{obj.f_work_mode},
			</if>
			<if test="obj.f_max_val != null and obj.f_max_val !='' "><!-- 最大值 -->
				F_MAX_VAL = #{obj.f_max_val},
			</if>
			<if test="obj.f_min_val != null and obj.f_min_val !='' "><!-- 最小值 -->
				F_MIN_VAL = #{obj.f_min_val},
			</if>
			<if test="obj.f_reversed != null and obj.f_reversed !='' "><!-- 是否反向 -->
				F_REVERSED = #{obj.f_reversed},
			</if>
			<if test="obj.f_sinnal_type != null and obj.f_sinnal_type !='' "><!-- 信号类型 -->
				F_SINNAL_TYPE = #{obj.f_sinnal_type},
			</if>
			<if test="obj.f_blxbh != null and obj.f_blxbh !='' "><!-- 电表类型编号 -->
				F_BLXBH = #{obj.f_blxbh},
			</if>
			<if test="obj.f_blxmc != null and obj.f_blxmc !='' "><!-- 电表类型名称 -->
				F_BLXMC = #{obj.f_blxmc},
			</if>
			<if test="obj.f_communication_port != null and obj.f_communication_port !='' "><!-- 通信端口 -->
				F_COMMUNICATION_PORT = #{obj.f_communication_port},
			</if>
			<if test="obj.f_comm_rate != null and obj.f_comm_rate !='' "><!-- 通信波特率编号 -->
				F_COMM_RATE = #{obj.f_comm_rate},
			</if>
			<if test="obj.f_comm_rate_mc != null and obj.f_comm_rate_mc !='' "><!-- 通信波特率编号 -->
				F_COMM_RATE_MC = #{obj.f_comm_rate_mc},
			</if>
			<if test="obj.f_protocol_type != null and obj.f_protocol_type !='' "><!-- 通信协议编号 -->
				F_PROTOCOL_TYPE = #{obj.f_protocol_type},
			</if>
			<if test="obj.f_protocol_type_mc != null and obj.f_protocol_type_mc !='' "><!-- 通信协议编号 -->
				F_PROTOCOL_TYPE_MC = #{obj.f_protocol_type_mc},
			</if>
			<if test="obj.f_wldz != null and obj.f_wldz !='' "><!-- 物理地址 -->
				F_WLDZ = #{obj.f_wldz},
			</if>
			<if test="obj.f_cjfabh != null and obj.f_cjfabh !='' "><!-- 采集方案编号 -->
				F_CJFABH = #{obj.f_cjfabh},
			</if>
			<if test="obj.f_cjfamc != null and obj.f_cjfamc !='' "><!-- 采集方案名称 -->
				F_CJFAMC = #{obj.f_cjfamc},
			</if>
			<if test="obj.f_percentage != null and obj.f_percentage !='' "><!-- 变比 -->
				F_PERCENTAGE = #{obj.f_percentage},
			</if>
			<if test="obj.f_close_state != null and obj.f_close_state !='' "><!-- 闭合状态 -->
				F_CLOSE_STATE = #{obj.f_close_state},
			</if>
			<if test="obj.f_sblxbh != null and obj.f_sblxbh !='' "><!-- 设备类型编号 -->
				F_SBLXBH = #{obj.f_sblxbh},
			</if>
			<if test="obj.f_allpath != null and obj.f_allpath !='' and obj.tabName =='BES_SBPZ_STRUCT' "><!-- 设备树结构表中全路径 -->
				F_ALLPATH = #{obj.f_allpath},
			</if>
			<if test="obj.f_status != null and obj.tabName =='BES_SBPZ_STRUCT' "><!-- 设备树结构表中在线状态 -->
				F_STATUS = #{obj.f_status},
			</if>
			<if test="obj.f_port != null and obj.f_port !='' "><!-- 设备类型编号 -->
				F_PORT = #{obj.f_port},
			</if>
			<if test="obj.f_belong_iprouter != null and obj.f_belong_iprouter !='' "><!-- 耦合器的归属系统 -->
				F_BELONG_IPROUTER = #{obj.f_belong_iprouter},
			</if>
			  <!-- 修改时间 -->
			F_CHDATE = current_timestamp()
		</set>
		WHERE F_SYS_NAME=#{obj.f_sys_name}
	</update>

	<!-- 根据系统名称编辑属性信息 -->
	<update id="editSbTreeAttrInfoBySysName" parameterType="com.alibaba.fastjson.JSONObject">
		UPDATE ${obj.attrTabName}
		<set>
			<if test="obj.f_sys_name != null and obj.f_sys_name !=''">
				F_SYS_NAME_OLD = #{obj.f_sys_name},
			</if>
			<!--<if test="obj.f_sys_name != null and obj.f_sys_name !=''">
				F_SYS_NAME_OLD = #{obj.f_sys_name},
			</if>-->
			<if test="obj.f_enabled != null and obj.f_enabled !=''">
				F_ENABLED = #{obj.f_enabled},
			</if>
			<if test="obj.f_type != null and obj.f_type !='' ">
				F_TYPE = #{obj.f_type},
			</if>
			<if test="obj.f_nick_name != null and obj.f_nick_name !='' ">
				F_NICK_NAME = #{obj.f_nick_name},
			</if>
			<if test="obj.attr_f_ip_addr != null and obj.attr_f_ip_addr !='' ">
				F_IP_ADDR = #{obj.attr_f_ip_addr},
			</if>
			<if test="obj.f_ssqy != null and obj.f_ssqy !='' ">
				F_SSQY = #{obj.f_ssqy},
			</if>
			<if test="obj.f_description != null and obj.f_description !='' ">
				F_DESCRIPTION = #{obj.f_description},
			</if>
			<if test="obj.f_channel_index != null and obj.f_channel_index !='' "><!-- 通道索引 -->
				F_CHANNEL_INDEX = #{obj.f_channel_index},
			</if>
			<if test="obj.f_type != null and obj.f_type !='' "><!-- 型号 -->
				F_TYPE = #{obj.f_type},
			</if>
			<if test="obj.f_azwz != null and obj.f_azwz !='' "><!-- 安装位置 -->
				F_AZWZ = #{obj.f_azwz},
			</if>
			<if test="obj.f_init_val != null "><!-- 初 始 值 -->
				F_INIT_VAL = #{obj.f_init_val},
			</if>
			<if test="obj.f_engineer_unit != null and obj.f_engineer_unit !='' "><!-- 工程单位 -->
				F_ENGINEER_UNIT = #{obj.f_engineer_unit},
			</if>
			<if test="obj.f_accuracy != null and obj.f_accuracy !='' "><!-- 精度 -->
				F_ACCURACY = #{obj.f_accuracy},
			</if>
			<if test="obj.f_point_type != null and obj.f_point_type !='' "><!-- 虚点类型 -->
				F_POINT_TYPE = #{obj.f_point_type},
			</if>
			<if test="obj.f_alarm_enable != null and obj.f_alarm_enable !='' "><!-- 报警使能 -->
				F_ALARM_ENABLE = #{obj.f_alarm_enable},
			</if>
			<if test="obj.f_alarm_type != null and obj.f_alarm_type !='' "><!-- 报警类型 -->
				F_ALARM_TYPE = #{obj.f_alarm_type},
			</if>
			<if test="obj.f_high_limit != null and obj.f_high_limit !='' "><!-- 高限报警 -->
				F_HIGH_LIMIT = #{obj.f_high_limit},
			</if>
			<if test="obj.f_low_limit != null and obj.f_low_limit !='' "><!-- 低限报警 -->
				F_LOW_LIMIT = #{obj.f_low_limit},
			</if>
			<if test="obj.f_alarm_priority != null and obj.f_alarm_priority !='' "><!-- 报警优先级 -->
				F_ALARM_PRIORITY = #{obj.f_alarm_priority},
			</if>
			<if test="obj.f_addr != null and obj.f_addr !='' "><!-- 通信地址 -->
				F_ADDR = #{obj.f_addr},
			</if>
			<if test="obj.f_node_type != null and obj.f_node_type !='' "><!-- 点类型 -->
				F_NODE_TYPE = #{obj.f_node_type},
			</if>
			<if test="obj.f_work_mode != null and obj.f_work_mode !='' "><!-- 工作模式 -->
				F_WORK_MODE = #{obj.f_work_mode},
			</if>
			<if test="obj.f_max_val != null and obj.f_max_val !='' "><!-- 最大值 -->
				F_MAX_VAL = #{obj.f_max_val},
			</if>
			<if test="obj.f_min_val != null and obj.f_min_val !='' "><!-- 最小值 -->
				F_MIN_VAL = #{obj.f_min_val},
			</if>
			<if test="obj.f_reversed != null and obj.f_reversed !='' "><!-- 是否反向 -->
				F_REVERSED = #{obj.f_reversed},
			</if>
			<if test="obj.f_sinnal_type != null and obj.f_sinnal_type !='' "><!-- 信号类型 -->
				F_SINNAL_TYPE = #{obj.f_sinnal_type},
			</if>
			<if test="obj.f_blxbh != null and obj.f_blxbh !='' "><!-- 电表类型编号 -->
				F_BLXBH = #{obj.f_blxbh},
			</if>
			<if test="obj.f_blxmc != null and obj.f_blxmc !='' "><!-- 电表类型名称 -->
				F_BLXMC = #{obj.f_blxmc},
			</if>
			<if test="obj.f_communication_port != null and obj.f_communication_port !='' "><!-- 通信端口 -->
				F_COMMUNICATION_PORT = #{obj.f_communication_port},
			</if>
			<if test="obj.f_comm_rate != null and obj.f_comm_rate !='' "><!-- 通信波特率编号 -->
				F_COMM_RATE = #{obj.f_comm_rate},
			</if>
			<if test="obj.f_comm_rate_mc != null and obj.f_comm_rate_mc !='' "><!-- 通信波特率编号 -->
				F_COMM_RATE_MC = #{obj.f_comm_rate_mc},
			</if>
			<if test="obj.f_protocol_type != null and obj.f_protocol_type !='' "><!-- 通信协议编号 -->
				F_PROTOCOL_TYPE = #{obj.f_protocol_type},
			</if>
			<if test="obj.f_protocol_type_mc != null and obj.f_protocol_type_mc !='' "><!-- 通信协议编号 -->
				F_PROTOCOL_TYPE_MC = #{obj.f_protocol_type_mc},
			</if>
			<if test="obj.f_wldz != null and obj.f_wldz !='' "><!-- 物理地址 -->
				F_WLDZ = #{obj.f_wldz},
			</if>
			<if test="obj.f_cjfabh != null and obj.f_cjfabh !='' "><!-- 采集方案编号 -->
				F_CJFABH = #{obj.f_cjfabh},
			</if>
			<if test="obj.f_cjfamc != null and obj.f_cjfamc !='' "><!-- 采集方案名称 -->
				F_CJFAMC = #{obj.f_cjfamc},
			</if>
			<if test="obj.f_percentage != null and obj.f_percentage !='' "><!-- 变比 -->
				F_PERCENTAGE = #{obj.f_percentage},
			</if>
			<if test="obj.f_close_state != null and obj.f_close_state !='' "><!-- 闭合状态 -->
				F_CLOSE_STATE = #{obj.f_close_state},
			</if>
			<if test="obj.f_sblxbh != null and obj.f_sblxbh !='' "><!-- 设备类型编号 -->
				F_SBLXBH = #{obj.f_sblxbh},
			</if>
			<if test="obj.f_allpath != null and obj.f_allpath !='' and obj.tabName =='BES_SBPZ_STRUCT' "><!-- 设备树结构表中全路径 -->
				F_ALLPATH = #{obj.f_allpath},
			</if>
			<if test="obj.f_status != null and obj.tabName =='BES_SBPZ_STRUCT' "><!-- 设备树结构表中在线状态 -->
				F_STATUS = #{obj.f_status},
			</if>
			<if test="obj.f_port != null and obj.f_port !='' "><!-- 设备类型编号 -->
				F_PORT = #{obj.f_port},
			</if>
			<if test="obj.f_belong_iprouter != null and obj.f_belong_iprouter !='' "><!-- 耦合器的归属系统 -->
				F_BELONG_IPROUTER = #{obj.f_belong_iprouter},
			</if>
			<!--王红杰 20200116  增加是否有源的修改-->
			<if test="obj.f_sourced != null and obj.f_sourced !='' "><!-- 是否有源 -->
				F_SOURCED = #{obj.f_sourced},
			</if>
			<!--修改时间  -->
			F_CHDATE = current_timestamp()
		</set>
		WHERE F_GUID=#{obj.myInput_f_sys_name}
	</update>

	<update id="editSbTreeAttrInfoByGuid" parameterType="com.alibaba.fastjson.JSONObject">
		UPDATE ${obj.attrTabName}
		<set>
			<if test="obj.f_sys_name != null and obj.f_sys_name !=''">
				F_SYS_NAME_OLD = #{obj.f_sys_name},
			</if>
			<!--<if test="obj.f_sys_name != null and obj.f_sys_name !=''">
				F_SYS_NAME_OLD = #{obj.f_sys_name},
			</if>-->
			<if test="obj.f_enabled != null and obj.f_enabled !=''">
				F_ENABLED = #{obj.f_enabled},
			</if>
			<if test="obj.f_type != null and obj.f_type !='' ">
				F_TYPE = #{obj.f_type},
			</if>
			<if test="obj.f_nick_name != null and obj.f_nick_name !='' ">
				F_NICK_NAME = #{obj.f_nick_name},
			</if>
			<if test="obj.attr_f_ip_addr != null and obj.attr_f_ip_addr !='' ">
				F_IP_ADDR = #{obj.attr_f_ip_addr},
			</if>
			<if test="obj.attr_f_ssqy != null and obj.attr_f_ssqy !='' ">
				F_SSQY = #{obj.attr_f_ssqy},
			</if>
			<if test="obj.attr_f_description != null and obj.attr_f_description !='' ">
				F_DESCRIPTION = #{obj.attr_f_description},
			</if>
			<if test="obj.f_channel_index != null and obj.f_channel_index !='' "><!-- 通道索引 -->
				F_CHANNEL_INDEX = #{obj.f_channel_index},
			</if>
			<if test="obj.f_type != null and obj.f_type !='' "><!-- 型号 -->
				F_TYPE = #{obj.f_type},
			</if>
			<if test="obj.attr_f_azwz != null and obj.attr_f_azwz !='' "><!-- 安装位置 -->
				F_AZWZ = #{obj.attr_f_azwz},
			</if>
			<if test="obj.f_init_val != null "><!-- 初 始 值 -->
				F_INIT_VAL = #{obj.f_init_val},
			</if>
			<if test="obj.f_engineer_unit != null and obj.f_engineer_unit !='' "><!-- 工程单位 -->
				F_ENGINEER_UNIT = #{obj.f_engineer_unit},
			</if>
			<if test="obj.f_accuracy != null and obj.f_accuracy !='' "><!-- 精度 -->
				F_ACCURACY = #{obj.f_accuracy},
			</if>
			<if test="obj.f_point_type != null and obj.f_point_type !='' "><!-- 虚点类型 -->
				F_POINT_TYPE = #{obj.f_point_type},
			</if>
			<if test="obj.f_alarm_enable != null and obj.f_alarm_enable !='' "><!-- 报警使能 -->
				F_ALARM_ENABLE = #{obj.f_alarm_enable},
			</if>
			<if test="obj.f_alarm_type != null and obj.f_alarm_type !='' "><!-- 报警类型 -->
				F_ALARM_TYPE = #{obj.f_alarm_type},
			</if>
			<if test="obj.f_high_limit != null and obj.f_high_limit !='' "><!-- 高限报警 -->
				F_HIGH_LIMIT = #{obj.f_high_limit},
			</if>
			<if test="obj.f_low_limit != null and obj.f_low_limit !='' "><!-- 低限报警 -->
				F_LOW_LIMIT = #{obj.f_low_limit},
			</if>
			<if test="obj.f_alarm_priority != null and obj.f_alarm_priority !='' "><!-- 报警优先级 -->
				F_ALARM_PRIORITY = #{obj.f_alarm_priority},
			</if>
			<if test="obj.f_addr != null and obj.f_addr !='' "><!-- 通信地址 -->
				F_ADDR = #{obj.f_addr},
			</if>
			<if test="obj.f_node_type != null and obj.f_node_type !='' "><!-- 点类型 -->
				F_NODE_TYPE = #{obj.f_node_type},
			</if>
			<if test="obj.f_work_mode != null and obj.f_work_mode !='' "><!-- 工作模式 -->
				F_WORK_MODE = #{obj.f_work_mode},
			</if>
			<if test="obj.f_max_val != null and obj.f_max_val !='' "><!-- 最大值 -->
				F_MAX_VAL = #{obj.f_max_val},
			</if>
			<if test="obj.f_min_val != null and obj.f_min_val !='' "><!-- 最小值 -->
				F_MIN_VAL = #{obj.f_min_val},
			</if>
			<if test="obj.f_reversed != null and obj.f_reversed !='' "><!-- 是否反向 -->
				F_REVERSED = #{obj.f_reversed},
			</if>
			<if test="obj.f_sinnal_type != null and obj.f_sinnal_type !='' "><!-- 信号类型 -->
				F_SINNAL_TYPE = #{obj.f_sinnal_type},
			</if>
			<if test="obj.f_blxbh != null and obj.f_blxbh !='' "><!-- 电表类型编号 -->
				F_BLXBH = #{obj.f_blxbh},
			</if>
			<if test="obj.f_blxmc != null and obj.f_blxmc !='' "><!-- 电表类型名称 -->
				F_BLXMC = #{obj.f_blxmc},
			</if>
			<if test="obj.f_communication_port != null and obj.f_communication_port !='' "><!-- 通信端口 -->
				F_COMMUNICATION_PORT = #{obj.f_communication_port},
			</if>
			<if test="obj.f_comm_rate != null and obj.f_comm_rate !='' "><!-- 通信波特率编号 -->
				F_COMM_RATE = #{obj.f_comm_rate},
			</if>
			<if test="obj.f_comm_rate_mc != null and obj.f_comm_rate_mc !='' "><!-- 通信波特率编号 -->
				F_COMM_RATE_MC = #{obj.f_comm_rate_mc},
			</if>
			<if test="obj.f_protocol_type != null and obj.f_protocol_type !='' "><!-- 通信协议编号 -->
				F_PROTOCOL_TYPE = #{obj.f_protocol_type},
			</if>
			<if test="obj.f_protocol_type_mc != null and obj.f_protocol_type_mc !='' "><!-- 通信协议编号 -->
				F_PROTOCOL_TYPE_MC = #{obj.f_protocol_type_mc},
			</if>
			<if test="obj.f_wldz != null and obj.f_wldz !='' "><!-- 物理地址 -->
				F_WLDZ = #{obj.f_wldz},
			</if>
			<if test="obj.f_cjfabh != null and obj.f_cjfabh !='' "><!-- 采集方案编号 -->
				F_CJFABH = #{obj.f_cjfabh},
			</if>
			<if test="obj.f_cjfamc != null and obj.f_cjfamc !='' "><!-- 采集方案名称 -->
				F_CJFAMC = #{obj.f_cjfamc},
			</if>
			<if test="obj.f_percentage != null and obj.f_percentage !='' "><!-- 变比 -->
				F_PERCENTAGE = #{obj.f_percentage},
			</if>
			<if test="obj.f_close_state != null and obj.f_close_state !='' "><!-- 闭合状态 -->
				F_CLOSE_STATE = #{obj.f_close_state},
			</if>
			<if test="obj.f_sblxbh != null and obj.f_sblxbh !='' "><!-- 设备类型编号 -->
				F_SBLXBH = #{obj.f_sblxbh},
			</if>
			<if test="obj.f_allpath != null and obj.f_allpath !='' and obj.tabName =='BES_SBPZ_STRUCT' "><!-- 设备树结构表中全路径 -->
				F_ALLPATH = #{obj.f_allpath},
			</if>
			<if test="obj.f_status != null and obj.tabName =='BES_SBPZ_STRUCT' "><!-- 设备树结构表中在线状态 -->
				F_STATUS = #{obj.f_status},
			</if>
			<if test="obj.f_port != null and obj.f_port !='' "><!-- 设备类型编号 -->
				F_PORT = #{obj.f_port},
			</if>
			<if test="obj.f_belong_iprouter != null and obj.f_belong_iprouter !='' "><!-- 耦合器的归属系统 -->
				F_BELONG_IPROUTER = #{obj.f_belong_iprouter},
			</if>
			<!--王红杰 20200116  增加是否有源的修改-->
			<if test="obj.f_sourced != null and obj.f_sourced !='' "><!-- 是否有源 -->
				F_SOURCED = #{obj.f_sourced},
			</if>
			<if test="obj.attr_f_coll_cycle != null and obj.attr_f_coll_cycle !='' "><!-- 采集周期 -->
				F_COLL_CYCLE = #{obj.attr_f_coll_cycle},
			</if>
			<if test='obj.attr_f_his_data_save_cycle != null and obj.attr_f_his_data_save_cycle != "" '> <!-- 历史数据保存周期 -->
				F_HIS_DATA_SAVE_CYCLE = #{obj.attr_f_his_data_save_cycle},
			</if>
			<if test='obj.attr_f_loop_time != null and obj.attr_f_loop_time != "" '> <!--能耗上传周期 -->
				F_UPLOAD_CYCLE = #{obj.attr_f_loop_time},
			</if>
			<if test='obj.f_collector_state != null and obj.f_collector_state != "" '> <!--同步状态 -->
				F_COLLECTOR_STATE = #{obj.f_collector_state},
			</if>
			<if test='obj.f_gateway != null and obj.f_gateway != "" '> <!--默认网关 -->
				F_GATEWAY = #{obj.f_gateway},
			</if>
			<if test='obj.f_mask != null and obj.f_mask != "" '> <!--子网掩码 -->
				F_MASK = #{obj.f_mask},
			</if>
			<if test='obj.f_ip_master != null and obj.f_ip_master != "" '> <!--主机ip -->
				F_IP_MASTER = #{obj.f_ip_master},
			</if>
			<if test='obj.f_port_master != null and obj.f_port_master != "" '> <!--主机端口 -->
				F_PORT_MASTER = #{obj.f_port_master},
			</if>
			<if test='obj.f_channel_id != null and obj.f_channel_id != "" '> <!--通道id -->
				F_CHANNEL_ID = #{obj.f_channel_id},
			</if>
			<!--修改时间  -->
			F_CHDATE = current_timestamp()
		</set>
		WHERE F_GUID=#{obj.f_guid}
	</update>
<!--王红杰
	设备型号列表修改
-->
	<update id="editSbTreeStructInfoBySysNamexh" parameterType="com.alibaba.fastjson.JSONObject">
		UPDATE ${obj.tabName}
		<set>
			<if test="obj.f_sys_name != null and obj.f_sys_name !=''">
				F_SYS_NAME = #{obj.f_sys_name},
			</if>
			<if test="obj.f_energyStatics != null and obj.f_energyStatics !=''">
				F_ENERGYSTATICS = #{obj.f_energyStatics},
			</if>
			<if test="obj.f_staticsTime != null and obj.f_staticsTime !=''">
				F_STATICSTIME = #{obj.f_staticsTime},
			</if>
			<!--<if test="obj.f_sys_name != null and obj.f_sys_name !=''">
				F_SYS_NAME_OLD = #{obj.f_sys_name},
			</if>-->
			<if test="obj.f_enabled != null and obj.f_enabled !=''">
				F_ENABLED = #{obj.f_enabled},
			</if>
			<if test="obj.f_type != null and obj.f_type !='' ">
				F_TYPE = #{obj.f_type},
			</if>
			<if test="obj.f_nick_name != null and obj.f_nick_name !='' ">
				F_NICK_NAME = #{obj.f_nick_name},
			</if>
			<if test="obj.f_ip_addr != null and obj.f_ip_addr !='' ">
				F_IP_ADDR = #{obj.f_ip_addr},
			</if>
			<if test="obj.f_ssqy != null and obj.f_ssqy !='' ">
				F_SSQY = #{obj.f_ssqy},
			</if>
			<if test="obj.f_description != null and obj.f_description !='' ">
				F_DESCRIPTION = #{obj.f_description},
			</if>
			<if test="obj.f_channel_index != null and obj.f_channel_index !='' "><!-- 通道索引 -->
				F_CHANNEL_INDEX = #{obj.f_channel_index},
			</if>
			<if test="obj.f_type != null and obj.f_type !='' "><!-- 型号 -->
				F_TYPE = #{obj.f_type},
			</if>
			<if test="obj.f_azwz != null and obj.f_azwz !='' "><!-- 安装位置 -->
				F_AZWZ = #{obj.f_azwz},
			</if>
			<if test="obj.f_init_val != null "><!-- 初 始 值 -->
				F_INIT_VAL = #{obj.f_init_val},
			</if>
			<if test="obj.f_engineer_unit != null and obj.f_engineer_unit !='' "><!-- 工程单位 -->
				F_ENGINEER_UNIT = #{obj.f_engineer_unit},
			</if>
			<if test="obj.f_accuracy != null and obj.f_accuracy !='' "><!-- 精度 -->
				F_ACCURACY = #{obj.f_accuracy},
			</if>
			<if test="obj.f_point_type != null and obj.f_point_type !='' "><!-- 虚点类型 -->
				F_POINT_TYPE = #{obj.f_point_type},
			</if>
			<if test="obj.f_alarm_enable != null and obj.f_alarm_enable !='' "><!-- 报警使能 -->
				F_ALARM_ENABLE = #{obj.f_alarm_enable},
			</if>
			<if test="obj.f_alarm_type != null and obj.f_alarm_type !='' "><!-- 报警类型 -->
				F_ALARM_TYPE = #{obj.f_alarm_type},
			</if>
			<if test="obj.f_high_limit != null and obj.f_high_limit !='' "><!-- 高限报警 -->
				F_HIGH_LIMIT = #{obj.f_high_limit},
			</if>
			<if test="obj.f_low_limit != null and obj.f_low_limit !='' "><!-- 低限报警 -->
				F_LOW_LIMIT = #{obj.f_low_limit},
			</if>
			<if test="obj.f_alarm_priority != null and obj.f_alarm_priority !='' "><!-- 报警优先级 -->
				F_ALARM_PRIORITY = #{obj.f_alarm_priority},
			</if>
			<if test="obj.f_addr != null and obj.f_addr !='' "><!-- 通信地址 -->
				F_ADDR = #{obj.f_addr},
			</if>
			<if test="obj.f_node_type != null and obj.f_node_type !='' "><!-- 点类型 -->
				F_NODE_TYPE = #{obj.f_node_type},
			</if>
			<if test="obj.f_work_mode != null and obj.f_work_mode !='' "><!-- 工作模式 -->
				F_WORK_MODE = #{obj.f_work_mode},
			</if>
			<if test="obj.f_max_val != null and obj.f_max_val !='' "><!-- 最大值 -->
				F_MAX_VAL = #{obj.f_max_val},
			</if>
			<if test="obj.f_min_val != null and obj.f_min_val !='' "><!-- 最小值 -->
				F_MIN_VAL = #{obj.f_min_val},
			</if>
			<if test="obj.f_reversed != null and obj.f_reversed !='' "><!-- 是否反向 -->
				F_REVERSED = #{obj.f_reversed},
			</if>
			<if test="obj.f_sinnal_type != null and obj.f_sinnal_type !='' "><!-- 信号类型 -->
				F_SINNAL_TYPE = #{obj.f_sinnal_type},
			</if>
			<if test="obj.f_blxbh != null and obj.f_blxbh !='' "><!-- 电表类型编号 -->
				F_BLXBH = #{obj.f_blxbh},
			</if>
			<if test="obj.f_blxmc != null and obj.f_blxmc !='' "><!-- 电表类型名称 -->
				F_BLXMC = #{obj.f_blxmc},
			</if>
			<if test="obj.f_communication_port != null and obj.f_communication_port !='' "><!-- 通信端口 -->
				F_COMMUNICATION_PORT = #{obj.f_communication_port},
			</if>
			<if test="obj.f_comm_rate != null and obj.f_comm_rate !='' "><!-- 通信波特率编号 -->
				F_COMM_RATE = #{obj.f_comm_rate},
			</if>
			<if test="obj.f_comm_rate_mc != null and obj.f_comm_rate_mc !='' "><!-- 通信波特率编号 -->
				F_COMM_RATE_MC = #{obj.f_comm_rate_mc},
			</if>
			<if test="obj.f_protocol_type != null and obj.f_protocol_type !='' "><!-- 通信协议编号 -->
				F_PROTOCOL_TYPE = #{obj.f_protocol_type},
			</if>
			<if test="obj.f_protocol_type_mc != null and obj.f_protocol_type_mc !='' "><!-- 通信协议编号 -->
				F_PROTOCOL_TYPE_MC = #{obj.f_protocol_type_mc},
			</if>
			<if test="obj.f_wldz != null and obj.f_wldz !='' "><!-- 物理地址 -->
				F_WLDZ = #{obj.f_wldz},
			</if>
			<if test="obj.f_cjfabh != null and obj.f_cjfabh !='' "><!-- 采集方案编号 -->
				F_CJFABH = #{obj.f_cjfabh},
			</if>
			<if test="obj.f_cjfamc != null and obj.f_cjfamc !='' "><!-- 采集方案名称 -->
				F_CJFAMC = #{obj.f_cjfamc},
			</if>
			<if test="obj.f_percentage != null and obj.f_percentage !='' "><!-- 变比 -->
				F_PERCENTAGE = #{obj.f_percentage},
			</if>
			<if test="obj.f_close_state != null and obj.f_close_state !='' "><!-- 闭合状态 -->
				F_CLOSE_STATE = #{obj.f_close_state},
			</if>
			<if test="obj.f_sblxbh != null and obj.f_sblxbh !='' "><!-- 设备类型编号 -->
				F_SBLXBH = #{obj.f_sblxbh},
			</if>
			<if test="obj.f_allpath != null and obj.f_allpath !='' and obj.tabName =='BES_SBPZ_STRUCT' "><!-- 设备树结构表中全路径 -->
				F_ALLPATH = #{obj.f_allpath},
			</if>
			<if test="obj.f_status != null and obj.tabName =='BES_SBPZ_STRUCT' "><!-- 设备树结构表中在线状态 -->
				F_STATUS = #{obj.f_status},
			</if>
			<if test="obj.f_port != null and obj.f_port !='' "><!-- 设备类型编号 -->
				F_PORT = #{obj.f_port},
			</if>
			<if test="obj.f_belong_iprouter != null and obj.f_belong_iprouter !='' "><!-- 耦合器的归属系统 -->
				F_BELONG_IPROUTER = #{obj.f_belong_iprouter},
			</if>
			<!--修改时间  -->
			F_CHDATE = current_timestamp()
		</set>
		WHERE F_ID=#{obj.myInput_f_sys_name}
	</update>

	<update id="editSbTreeStructInfoBySysName1" parameterType="com.alibaba.fastjson.JSONObject">
		UPDATE ${obj.tabName}
		<set>
			<if test="obj.f_sys_name != null and obj.f_sys_name !=''">
				F_SYS_NAME_OLD = #{obj.f_sys_name},
			</if>
			<!--<if test="obj.f_sys_name != null and obj.f_sys_name !=''">
				F_SYS_NAME_OLD = #{obj.f_sys_name},
			</if>-->
			<if test="obj.f_enabled != null and obj.f_enabled !=''">
				F_ENABLED = #{obj.f_enabled},
			</if>
			<if test="obj.f_type != null and obj.f_type !='' ">
				F_TYPE = #{obj.f_type},
			</if>
			<if test="obj.f_nick_name != null and obj.f_nick_name !='' ">
				F_NICK_NAME = #{obj.f_nick_name},
			</if>
			<if test="obj.f_ip_addr != null and obj.f_ip_addr !='' ">
				F_IP_ADDR = #{obj.f_ip_addr},
			</if>
			<if test="obj.f_ssqy != null and obj.f_ssqy !='' ">
				F_SSQY = #{obj.f_ssqy},
			</if>
			<if test="obj.f_description != null and obj.f_description !='' ">
				F_DESCRIPTION = #{obj.f_description},
			</if>
			<if test="obj.f_channel_index != null and obj.f_channel_index !='' "><!-- 通道索引 -->
				F_CHANNEL_INDEX = #{obj.f_channel_index},
			</if>
			<if test="obj.f_type != null and obj.f_type !='' "><!-- 型号 -->
				F_TYPE = #{obj.f_type},
			</if>
			<if test="obj.f_azwz != null and obj.f_azwz !='' "><!-- 安装位置 -->
				F_AZWZ = #{obj.f_azwz},
			</if>
			<if test="obj.f_init_val != null "><!-- 初 始 值 -->
				F_INIT_VAL = #{obj.f_init_val},
			</if>
			<if test="obj.f_engineer_unit != null and obj.f_engineer_unit !='' "><!-- 工程单位 -->
				F_ENGINEER_UNIT = #{obj.f_engineer_unit},
			</if>
			<if test="obj.f_accuracy != null and obj.f_accuracy !='' "><!-- 精度 -->
				F_ACCURACY = #{obj.f_accuracy},
			</if>
			<if test="obj.f_point_type != null and obj.f_point_type !='' "><!-- 虚点类型 -->
				F_POINT_TYPE = #{obj.f_point_type},
			</if>
			<if test="obj.f_alarm_enable != null and obj.f_alarm_enable !='' "><!-- 报警使能 -->
				F_ALARM_ENABLE = #{obj.f_alarm_enable},
			</if>
			<if test="obj.f_alarm_type != null and obj.f_alarm_type !='' "><!-- 报警类型 -->
				F_ALARM_TYPE = #{obj.f_alarm_type},
			</if>
			<if test="obj.f_high_limit != null and obj.f_high_limit !='' "><!-- 高限报警 -->
				F_HIGH_LIMIT = #{obj.f_high_limit},
			</if>
			<if test="obj.f_low_limit != null and obj.f_low_limit !='' "><!-- 低限报警 -->
				F_LOW_LIMIT = #{obj.f_low_limit},
			</if>
			<if test="obj.f_alarm_priority != null and obj.f_alarm_priority !='' "><!-- 报警优先级 -->
				F_ALARM_PRIORITY = #{obj.f_alarm_priority},
			</if>
			<if test="obj.f_addr != null and obj.f_addr !='' "><!-- 通信地址 -->
				F_ADDR = #{obj.f_addr},
			</if>
			<if test="obj.f_node_type != null and obj.f_node_type !='' "><!-- 点类型 -->
				F_NODE_TYPE = #{obj.f_node_type},
			</if>
			<if test="obj.f_work_mode != null and obj.f_work_mode !='' "><!-- 工作模式 -->
				F_WORK_MODE = #{obj.f_work_mode},
			</if>
			<if test="obj.f_max_val != null and obj.f_max_val !='' "><!-- 最大值 -->
				F_MAX_VAL = #{obj.f_max_val},
			</if>
			<if test="obj.f_min_val != null and obj.f_min_val !='' "><!-- 最小值 -->
				F_MIN_VAL = #{obj.f_min_val},
			</if>
			<if test="obj.f_reversed != null and obj.f_reversed !='' "><!-- 是否反向 -->
				F_REVERSED = #{obj.f_reversed},
			</if>
			<if test="obj.f_sinnal_type != null and obj.f_sinnal_type !='' "><!-- 信号类型 -->
				F_SINNAL_TYPE = #{obj.f_sinnal_type},
			</if>
			<if test="obj.f_blxbh != null and obj.f_blxbh !='' "><!-- 电表类型编号 -->
				F_BLXBH = #{obj.f_blxbh},
			</if>
			<if test="obj.f_blxmc != null and obj.f_blxmc !='' "><!-- 电表类型名称 -->
				F_BLXMC = #{obj.f_blxmc},
			</if>
			<if test="obj.f_communication_port != null and obj.f_communication_port !='' "><!-- 通信端口 -->
				F_COMMUNICATION_PORT = #{obj.f_communication_port},
			</if>
			<if test="obj.f_comm_rate != null and obj.f_comm_rate !='' "><!-- 通信波特率编号 -->
				F_COMM_RATE = #{obj.f_comm_rate},
			</if>
			<if test="obj.f_comm_rate_mc != null and obj.f_comm_rate_mc !='' "><!-- 通信波特率编号 -->
				F_COMM_RATE_MC = #{obj.f_comm_rate_mc},
			</if>
			<if test="obj.f_protocol_type != null and obj.f_protocol_type !='' "><!-- 通信协议编号 -->
				F_PROTOCOL_TYPE = #{obj.f_protocol_type},
			</if>
			<if test="obj.f_protocol_type_mc != null and obj.f_protocol_type_mc !='' "><!-- 通信协议编号 -->
				F_PROTOCOL_TYPE_MC = #{obj.f_protocol_type_mc},
			</if>
			<if test="obj.f_wldz != null and obj.f_wldz !='' "><!-- 物理地址 -->
				F_WLDZ = #{obj.f_wldz},
			</if>
			<if test="obj.f_cjfabh != null and obj.f_cjfabh !='' "><!-- 采集方案编号 -->
				F_CJFABH = #{obj.f_cjfabh},
			</if>
			<if test="obj.f_cjfamc != null and obj.f_cjfamc !='' "><!-- 采集方案名称 -->
				F_CJFAMC = #{obj.f_cjfamc},
			</if>
			<if test="obj.f_percentage != null and obj.f_percentage !='' "><!-- 变比 -->
				F_PERCENTAGE = #{obj.f_percentage},
			</if>
			<if test="obj.f_close_state != null and obj.f_close_state !='' "><!-- 闭合状态 -->
				F_CLOSE_STATE = #{obj.f_close_state},
			</if>
			<if test="obj.f_sblxbh != null and obj.f_sblxbh !='' "><!-- 设备类型编号 -->
				F_SBLXBH = #{obj.f_sblxbh},
			</if>
			<if test="obj.f_allpath != null and obj.f_allpath !='' and obj.tabName =='BES_SBPZ_STRUCT' "><!-- 设备树结构表中全路径 -->
				F_ALLPATH = #{obj.f_allpath},
			</if>
			<if test="obj.f_status != null and obj.tabName =='BES_SBPZ_STRUCT' "><!-- 设备树结构表中在线状态 -->
				F_STATUS = #{obj.f_status},
			</if>
			<if test="obj.f_port != null and obj.f_port !='' "><!-- 设备类型编号 -->
				F_PORT = #{obj.f_port},
			</if>
			<if test="obj.f_belong_iprouter != null and obj.f_belong_iprouter !='' "><!-- 耦合器的归属系统 -->
				F_BELONG_IPROUTER = #{obj.f_belong_iprouter},
			</if>
			<!--修改时间  -->
			F_CHDATE = current_timestamp()
		</set>
		WHERE F_SYS_NAME=#{obj.myInput_f_sys_name} || F_SYS_NAME_OLD=#{obj.myInput_f_sys_name}
	</update>

	<update id="editSbTreeStructInfoBySysName2" parameterType="com.alibaba.fastjson.JSONObject">
		UPDATE ${obj.tabName}
		<set>
			<if test="obj.myInput_f_sys_name != null and obj.myInput_f_sys_name !=''">
				F_SYS_NAME_OLD = #{obj.f_sys_name},
			</if>
			<if test="obj.f_enabled != null and obj.f_enabled !=''">
				F_ENABLED = #{obj.f_enabled},
			</if>
			<if test="obj.f_type != null and obj.f_type !='' ">
				F_TYPE = #{obj.f_type},
			</if>
			<if test="obj.f_nick_name != null and obj.f_nick_name !='' ">
				F_NICK_NAME = #{obj.f_nick_name},
			</if>
			<if test="obj.f_ip_addr != null and obj.f_ip_addr !='' ">
				F_IP_ADDR = #{obj.f_ip_addr},
			</if>
			<if test="obj.f_ssqy != null and obj.f_ssqy !='' ">
				F_SSQY = #{obj.f_ssqy},
			</if>
			<if test="obj.f_description != null and obj.f_description !='' ">
				F_DESCRIPTION = #{obj.f_description},
			</if>
			<if test="obj.f_channel_index != null and obj.f_channel_index !='' "><!-- 通道索引 -->
				F_CHANNEL_INDEX = #{obj.f_channel_index},
			</if>
			<if test="obj.f_type != null and obj.f_type !='' "><!-- 型号 -->
				F_TYPE = #{obj.f_type},
			</if>
			<if test="obj.f_azwz != null and obj.f_azwz !='' "><!-- 安装位置 -->
				F_AZWZ = #{obj.f_azwz},
			</if>
			<if test="obj.f_init_val != null "><!-- 初 始 值 -->
				F_INIT_VAL = #{obj.f_init_val},
			</if>
			<if test="obj.f_engineer_unit != null and obj.f_engineer_unit !='' "><!-- 工程单位 -->
				F_ENGINEER_UNIT = #{obj.f_engineer_unit},
			</if>
			<if test="obj.f_accuracy != null and obj.f_accuracy !='' "><!-- 精度 -->
				F_ACCURACY = #{obj.f_accuracy},
			</if>
			<if test="obj.f_point_type != null and obj.f_point_type !='' "><!-- 虚点类型 -->
				F_POINT_TYPE = #{obj.f_point_type},
			</if>
			<if test="obj.f_alarm_enable != null and obj.f_alarm_enable !='' "><!-- 报警使能 -->
				F_ALARM_ENABLE = #{obj.f_alarm_enable},
			</if>
			<if test="obj.f_alarm_type != null and obj.f_alarm_type !='' "><!-- 报警类型 -->
				F_ALARM_TYPE = #{obj.f_alarm_type},
			</if>
			<if test="obj.f_high_limit != null and obj.f_high_limit !='' "><!-- 高限报警 -->
				F_HIGH_LIMIT = #{obj.f_high_limit},
			</if>
			<if test="obj.f_low_limit != null and obj.f_low_limit !='' "><!-- 低限报警 -->
				F_LOW_LIMIT = #{obj.f_low_limit},
			</if>
			<if test="obj.f_alarm_priority != null and obj.f_alarm_priority !='' "><!-- 报警优先级 -->
				F_ALARM_PRIORITY = #{obj.f_alarm_priority},
			</if>
			<if test="obj.f_addr != null and obj.f_addr !='' "><!-- 通信地址 -->
				F_ADDR = #{obj.f_addr},
			</if>
			<if test="obj.f_node_type != null and obj.f_node_type !='' "><!-- 点类型 -->
				F_NODE_TYPE = #{obj.f_node_type},
			</if>
			<if test="obj.f_work_mode != null and obj.f_work_mode !='' "><!-- 工作模式 -->
				F_WORK_MODE = #{obj.f_work_mode},
			</if>
			<if test="obj.f_max_val != null and obj.f_max_val !='' "><!-- 最大值 -->
				F_MAX_VAL = #{obj.f_max_val},
			</if>
			<if test="obj.f_min_val != null and obj.f_min_val !='' "><!-- 最小值 -->
				F_MIN_VAL = #{obj.f_min_val},
			</if>
			<if test="obj.f_reversed != null and obj.f_reversed !='' "><!-- 是否反向 -->
				F_REVERSED = #{obj.f_reversed},
			</if>
			<if test="obj.f_sinnal_type != null and obj.f_sinnal_type !='' "><!-- 信号类型 -->
				F_SINNAL_TYPE = #{obj.f_sinnal_type},
			</if>
			<if test="obj.f_blxbh != null and obj.f_blxbh !='' "><!-- 电表类型编号 -->
				F_BLXBH = #{obj.f_blxbh},
			</if>
			<if test="obj.f_blxmc != null and obj.f_blxmc !='' "><!-- 电表类型名称 -->
				F_BLXMC = #{obj.f_blxmc},
			</if>
			<if test="obj.f_communication_port != null and obj.f_communication_port !='' "><!-- 通信端口 -->
				F_COMMUNICATION_PORT = #{obj.f_communication_port},
			</if>
			<if test="obj.f_comm_rate != null and obj.f_comm_rate !='' "><!-- 通信波特率编号 -->
				F_COMM_RATE = #{obj.f_comm_rate},
			</if>
			<if test="obj.f_comm_rate_mc != null and obj.f_comm_rate_mc !='' "><!-- 通信波特率编号 -->
				F_COMM_RATE_MC = #{obj.f_comm_rate_mc},
			</if>
			<if test="obj.f_protocol_type != null and obj.f_protocol_type !='' "><!-- 通信协议编号 -->
				F_PROTOCOL_TYPE = #{obj.f_protocol_type},
			</if>
			<if test="obj.f_protocol_type_mc != null and obj.f_protocol_type_mc !='' "><!-- 通信协议编号 -->
				F_PROTOCOL_TYPE_MC = #{obj.f_protocol_type_mc},
			</if>
			<if test="obj.f_wldz != null and obj.f_wldz !='' "><!-- 物理地址 -->
				F_WLDZ = #{obj.f_wldz},
			</if>
			<if test="obj.f_cjfabh != null and obj.f_cjfabh !='' "><!-- 采集方案编号 -->
				F_CJFABH = #{obj.f_cjfabh},
			</if>
			<if test="obj.f_cjfamc != null and obj.f_cjfamc !='' "><!-- 采集方案名称 -->
				F_CJFAMC = #{obj.f_cjfamc},
			</if>
			<if test="obj.f_percentage != null and obj.f_percentage !='' "><!-- 变比 -->
				F_PERCENTAGE = #{obj.f_percentage},
			</if>
			<if test="obj.f_close_state != null and obj.f_close_state !='' "><!-- 闭合状态 -->
				F_CLOSE_STATE = #{obj.f_close_state},
			</if>
			<if test="obj.f_sblxbh != null and obj.f_sblxbh !='' "><!-- 设备类型编号 -->
				F_SBLXBH = #{obj.f_sblxbh},
			</if>
			<if test="obj.f_allpath != null and obj.f_allpath !='' and obj.tabName =='BES_SBPZ_STRUCT' "><!-- 设备树结构表中全路径 -->
				F_ALLPATH = #{obj.f_allpath},
			</if>
			<if test="obj.f_status != null and obj.tabName =='BES_SBPZ_STRUCT' "><!-- 设备树结构表中在线状态 -->
				F_STATUS = #{obj.f_status},
			</if>
			<if test="obj.f_port != null and obj.f_port !='' "><!-- 设备类型编号 -->
				F_PORT = #{obj.f_port},
			</if>
			<if test="obj.f_belong_iprouter != null and obj.f_belong_iprouter !='' "><!-- 耦合器的归属系统 -->
				F_BELONG_IPROUTER = #{obj.f_belong_iprouter},
			</if>
			<!--修改时间  -->
			F_CHDATE = current_timestamp()
		</set>
		WHERE F_SYS_NAME=#{obj.myInput_f_sys_name}
	</update>

	<!-- Start add by yangjx at 20191212 -->
	<!-- 更新编辑虚点表信息数据 -->
	<update id="updateTableBesVpoint" parameterType="com.alibaba.fastjson.JSONObject">
		UPDATE BES_VPOINT
		SET
			F_NICK_NAME = #{obj.f_nick_name},			<!-- 别名 -->
			F_INIT_VAL = #{obj.f_init_val},				<!-- 初始值 -->
			F_ENGINEER_UNIT = #{obj.f_engineer_unit},	<!-- 单位 -->
			F_ENABLED = #{obj.f_enabled},				<!-- 使能形态 -->
			F_DESCRIPTION = #{obj.f_description},		<!-- 描述 -->
			F_ACCURACY = #{obj.f_accuracy},				<!-- 精度 -->
			F_NODE_TYPE = #{obj.f_node_type},			<!-- 虚点类型 -->
			F_ALARM_ENABLE = #{obj.f_alarm_enable},		<!-- 报警使能 -->
			F_ALARM_TYPE = #{obj.f_alarm_type},			<!-- 报警类型 -->
			F_ENERGYSTATICS = #{obj.f_energyStatics},	<!-- 能耗统计 -->
			<if test="obj.f_hight_limit !=null and obj.f_hight_limit !='' ">
				F_HIGH_LIMIT = #{obj.f_high_limit},			<!-- 高限警报 -->
			</if>
			<if test="obj.f_hight_limit ==null or obj.fight_limit =='' ">
				F_HIGH_LIMIT = null,
			</if>
			<if test="obj.f_low_limit !=null and obj.f_low_limit !='' ">
				F_LOW_LIMIT = #{obj.f_low_limit},			<!-- 底限警报 -->
			</if>
			<if test="obj.f_low_limit ==null or obj.f_low_limit == '' ">
				F_LOW_LIMIT = null,
			</if>
			<if test="obj.f_staticsTime !=null and obj.f_staticsTime != '' ">
				F_STATICSTIME = #{obj.f_staticsTime},			<!-- 统计周期-->
			</if>
			F_ALARM_PRIORITY = #{obj.f_alarm_priority},	<!-- 报警优先级 -->
			F_CLOSE_STATE = #{obj.f_close_state},		<!-- 闭合状态 -->
			F_CHDATE = current_timestamp()				<!-- 更新时间 -->
		WHERE F_SYS_NAME=#{obj.f_sys_name}
	</update>
	<!-- End add by yangjx at 20191212 -->


	<!--根据系统名称删除设备树信息  -->
	<!--王红杰修改-->
	<delete  id="delSbTreeBySysName" parameterType="String">
		DELETE FROM ${nodeTabName} WHERE F_SYS_NAME_OLD=#{f_sys_name} || F_SYS_NAME=#{f_sys_name}
	</delete >
	<!--通过系统名称批量删除节点信息 -->
	<delete id="batchDelete">
		delete from ${nodeTabName} where F_SYS_NAME in
		<foreach collection="f_sys_names" item="f_sys_name" separator="," open="(" close=")">
			#{f_sys_name}
		</foreach>
	</delete>
	<!--批量添加节点信息 -->
	<insert id="batchInsert"  useGeneratedKeys="true" keyProperty="f_sys_name" parameterType="java.util.ArrayList">
		INSERT INTO BES_SBPZ_STRUCT
		(F_ID,F_SYS_NAME,F_SYS_NAME_OLD, F_NICK_NAME, F_ALLPATH, F_TYPE,F_NODE_ATTRIBUTION, F_PSYS_NAME, F_STATUS, F_CRDATE)
		VALUES
		<foreach collection="list" item="item" index="index" separator=",">
			(#{item.f_id},#{item.f_sys_name},#{item.f_sys_name},#{item.f_nick_name},#{item.f_allpath},#{item.f_type},#{item.f_node_attribution},#{item.f_psys_name}, #{item.f_status}, current_timestamp())
		</foreach>
	</insert>

	<!--批量添加节点信息 -->
	<insert id="batchInsertCopy"  useGeneratedKeys="true" keyProperty="f_sys_name" parameterType="java.util.ArrayList">
		INSERT INTO BES_SBPZ_STRUCT_copy
		(F_ID,F_SYS_NAME,F_SYS_NAME_OLD, F_NICK_NAME, F_ALLPATH, F_TYPE,F_NODE_ATTRIBUTION, F_PSYS_NAME, F_STATUS, F_CRDATE)
		VALUES
		<foreach collection="list" item="item" index="index" separator=",">
			(#{item.f_id},#{item.f_sys_name},#{item.f_sys_name},#{item.f_nick_name},#{item.f_allpath},#{item.f_type},#{item.f_node_attribution},#{item.f_psys_name}, #{item.f_status}, current_timestamp())
		</foreach>
	</insert>

	<!-- 获取做大id -->
	<select id="queryMaxId" parameterType="String" resultType="String">
		 SELECT  max(CAST(F_GUID as SIGNED)) as maxId  FROM ${nodeTabName}
	</select>
	<!-- 获取设备树的最大设备id -->
	<select id="queryStructMaxId" parameterType="String" resultType="String">
		 SELECT  max(CAST(F_SBID as SIGNED)) as maxId  FROM bes_sbpz_struct
	</select>
	<!-- 获取采集器的最大设备id -->
	<select id="queryCollectorMaxId" parameterType="String" resultType="String">
		 SELECT  max(CAST(F_SBID as SIGNED)) as maxId  FROM bes_collector
	</select>
	<!-- 获取电表的最大设备id -->
	<select id="queryAmmeterMaxId" parameterType="String" resultType="String">
		 SELECT  max(CAST(F_SBID as SIGNED)) as maxId  FROM bes_ammeter
	</select>
	<!-- 查询该节点的实体表名 -->
	<select id="findNodeTable" parameterType="String" resultType="String">
		 select F_NODE_TABLE from bes_sbtree_nodetype
		 where
		 F_NODE_TYPE = (select F_TYPE from bes_sbpz_struct where F_SYS_NAME_OLD = #{f_sys_name} || F_SYS_NAME=#{f_sys_name})
	</select>

	<select id="findNodeTableChange" parameterType="String" resultType="String">
		 select F_NODE_TABLE from bes_sbtree_nodetype
		 where
		 F_NODE_TYPE = (select F_TYPE from bes_sbpz_struct where F_SYS_NAME=#{f_sys_name} || F_SYS_NAME_OLD=#{f_sys_name})
	</select>

	<select id="findNodeTableByRootIdtabName" parameterType="String" resultType="String">
		 select F_NODE_TABLE from bes_sbtree_nodetype
		 where
		 F_NODE_TYPE = (select F_TYPE from bes_sbpz_struct where F_SYS_NAME=#{f_sys_name})
	</select>

	<!--<select id="findNodeTable" parameterType="String" resultType="String">
		 select F_NODE_TABLE from bes_sbtree_nodetype
		 where
		 F_NODE_TYPE = (select F_TYPE from bes_sbpz_struct where F_GUID = #{f_guid})
	</select>-->
<!--王红杰-->
	<select id="findNodeTableDO" parameterType="String" resultType="String">
		 select F_NODE_TABLE from bes_sbtree_nodetype
		 where
		 F_NODE_TYPE = (select F_NODE_TYPE from bes_digit_ouput where F_GUID = #{DO} and F_NODE_TYPE=#{node_type})
	</select>
	<select id="findNodeTableDI" parameterType="String" resultType="String">
		 select F_NODE_TABLE from bes_sbtree_nodetype
		 where
		 F_NODE_TYPE = (select F_NODE_TYPE from bes_digit_input where F_GUID = #{DI} and F_NODE_TYPE=#{node_type})
	</select>
	<select id="findNodeTableAO" parameterType="String" resultType="String">
		 select F_NODE_TABLE from bes_sbtree_nodetype
		 where
		 F_NODE_TYPE = (select F_NODE_TYPE from bes_analog_ouput where F_GUID = #{AO} and F_NODE_TYPE=#{node_type})
	</select>
	<select id="findNodeTableAI" parameterType="String" resultType="String">
		 select F_NODE_TABLE from bes_sbtree_nodetype
		 where
		 F_NODE_TYPE = (select F_NODE_TYPE from bes_analog_input where F_GUID = #{AI} and F_NODE_TYPE=#{node_type})
	</select>
	<select id="findNodeTableDDC" parameterType="String" resultType="String">
		 select F_NODE_TABLE from bes_sbtree_nodetype
		 where
		 F_NODE_TYPE = (select F_NODE_TYPE from bes_ddc where F_GUID = #{DDC})
	</select>

	<select id="findNodeTablemodule" parameterType="String" resultType="String">
		 select F_NODE_TABLE from bes_sbtree_nodetype
		 where
		 F_NODE_TYPE = (select F_NODE_TYPE from bes_module where F_GUID = #{module})
	</select>
	<select id="findNodeTablecollector" parameterType="String" resultType="String">
		 select F_NODE_TABLE from bes_sbtree_nodetype
		 where
		 F_NODE_TYPE = (select F_NODE_TYPE from bes_collector where F_GUID = #{collector})
	</select>
	<select id="findNodeTabledebugDO" parameterType="String" resultType="String">
		 select F_NODE_TABLE from bes_sbtree_nodetype
		 where
		 F_NODE_TYPE = (select F_NODE_TYPE from bes_digit_ouput where F_GUID = #{debugDO})
	</select>

	<select id="findNodeTabledebugAO" parameterType="String" resultType="String">
		 select F_NODE_TABLE from bes_sbtree_nodetype
		 where
		 F_NODE_TYPE = (select F_NODE_TYPE from bes_analog_ouput where F_GUID = #{debugAO})
	</select>

	<!--<select id="findNodeTableammeter" parameterType="String" resultType="String">
		 select F_NODE_TABLE from bes_sbtree_nodetype
		 where
		 F_NODE_TYPE = (select F_NODE_TYPE from bes_ammeter where F_GUID = #{all})
	</select>-->
	<!-- 查询模块所在线路信息 -->
	<select id="queryLines" resultType="java.util.HashMap">
		select  * from bes_sbpz_struct where F_PSYS_NAME =
			(select F_PSYS_NAME from bes_sbpz_struct where F_SYS_NAME = #{f_psys_name})
		ORDER BY F_SYS_NAME
	</select>
	<!-- 查询设备树上一个点的信息 -->
	<select id="querySbpzStructInfo" parameterType="String" resultType="String">
		select F_TYPE from bes_sbpz_struct where F_SYS_NAME = #{f_psys_name}
	</select>
	<!-- 查询逻辑点所在模块的父节点类型 -->
	<select id="queryPointModPtype" parameterType="String" resultType="String">
		select f_type from bes_sbpz_struct where F_SYS_NAME=(
			select F_PSYS_NAME from bes_sbpz_struct where F_SYS_NAME = #{f_psys_name})
	</select>

	<!-- 查询逻辑点所在模块的父节点类型(通过逻辑点fSysname) -->
	<select id="queryPointModPtypeByfSysname" parameterType="String" resultType="String">
		select f_type from bes_sbpz_struct where F_SYS_NAME=(
			select F_PSYS_NAME from bes_sbpz_struct where F_SYS_NAME = (
				select F_PSYS_NAME from bes_sbpz_struct where F_SYS_NAME = #{fSysname}
			))
	</select>
	<!-- 查询Cross下所有模块信息 -->
	<select id="queryCrossModule" resultType="java.util.HashMap">
			select * from bes_sbpz_struct where F_PSYS_NAME=(
				SELECT F_SYS_NAME FROM bes_sbpz_struct where F_PSYS_NAME=(
					SELECT F_SYS_NAME FROM bes_sbpz_struct where F_PSYS_NAME=#{f_sys_name}
					))
	</select>
	<!-- 查询支路耦合器的父节点 -->
	<select id="querybranchCouplerpNode" resultType="java.util.HashMap">
			select * from bes_sbpz_struct where F_SYS_NAME =(
				select F_PSYS_NAME from bes_sbpz_struct where F_SYS_NAME = #{f_sys_name})
	</select>
	<!-- 通过id查询设备树节点信息 -->
	<select id="queryPointInfo" parameterType="String" resultType="java.util.HashMap">
			select * from ${tabname} where F_SYS_NAME =#{f_sys_name}
	</select>
	<select id="queryNodeInfo" parameterType="String" resultType="java.util.HashMap">
			select * from bes_sbpz_struct where F_SYS_NAME =#{f_psys_name} || F_SYS_NAME_OLD =#{f_psys_name}
	</select>

	<select id="getCollectorStatus" parameterType="String" resultType="String">
		select F_COLLSTATUS from bes_collector_status where F_COLLECT_ID=#{f_guid}
	</select>
	<!-- 获取所有DO点 -->
	<select id="loadAllDO" resultType="java.util.HashMap">
		SELECT
			F_GUID,
			F_SBID,
			F_STRUCT_ID,
			F_SYS_NAME,
			F_NICK_NAME,
			F_NODE_TYPE,
			F_CHANNEL_INDEX,
			F_ENABLED,
			F_REVERSED,
			F_WORK_MODE,
			F_ALARM_ENABLE,
			F_ALARM_TYPE,
			F_ALARM_PRIORITY,
			F_INIT_VAL,
			F_DESCRIPTION,
			F_YQBH
		FROM bes_digit_ouput
		UNION
		SELECT
			F_GUID,
			F_SBID,
			F_STRUCT_ID,
			F_SYS_NAME,
			F_NICK_NAME,
			F_NODE_TYPE,
			F_CHANNEL_INDEX,
			F_ENABLED,
			F_REVERSED,
			F_WORK_MODE,
			F_ALARM_ENABLE,
			F_ALARM_TYPE,
			F_ALARM_PRIORITY,
			F_INIT_VAL,
			F_DESCRIPTION,
			F_YQBH
		FROM bes_analog_ouput
	</select>


	<!-- 查询所有逻辑实点信息 -->
	<select id="getAllPointInfo"  resultType="java.util.HashMap">
		select F_GUID,F_SBID,F_SYS_NAME,F_NICK_NAME,F_NODE_TYPE,F_CHANNEL_INDEX,F_INIT_VAL FROM bes_analog_input
			UNION ALL
		select F_GUID,F_SBID,F_SYS_NAME,F_NICK_NAME,F_NODE_TYPE,F_CHANNEL_INDEX,F_INIT_VAL FROM bes_analog_ouput
		    UNION ALL
		select F_GUID,F_SBID,F_SYS_NAME,F_NICK_NAME,F_NODE_TYPE,F_CHANNEL_INDEX,F_INIT_VAL FROM bes_digit_input
			UNION ALL
		select F_GUID,F_SBID,F_SYS_NAME,F_NICK_NAME,F_NODE_TYPE,F_CHANNEL_INDEX,F_INIT_VAL FROM bes_digit_ouput
	</select>

	<select id="getAllPointInfoBySysName"  resultType="java.util.HashMap" parameterType="String">
		select F_GUID,F_SBID,F_SYS_NAME,F_NICK_NAME,F_NODE_TYPE,F_CHANNEL_INDEX,F_INIT_VAL FROM bes_analog_input WHERE F_SYS_NAME IN(${sysName})
			UNION ALL
		select F_GUID,F_SBID,F_SYS_NAME,F_NICK_NAME,F_NODE_TYPE,F_CHANNEL_INDEX,F_INIT_VAL FROM bes_analog_ouput WHERE F_SYS_NAME IN(${sysName})
		    UNION ALL
		select F_GUID,F_SBID,F_SYS_NAME,F_NICK_NAME,F_NODE_TYPE,F_CHANNEL_INDEX,F_INIT_VAL FROM bes_digit_input WHERE F_SYS_NAME IN(${sysName})
			UNION ALL
		select F_GUID,F_SBID,F_SYS_NAME,F_NICK_NAME,F_NODE_TYPE,F_CHANNEL_INDEX,F_INIT_VAL FROM bes_digit_ouput WHERE F_SYS_NAME IN(${sysName})
	</select>


	<select id="getWkjkPointInfoBySysName"  resultType="java.util.HashMap" parameterType="String">
		select F_GUID,F_SBID,F_SYS_NAME,F_NICK_NAME,F_NODE_TYPE,F_CHANNEL_INDEX,F_INIT_VAL FROM bes_analog_input WHERE F_SYS_NAME LIKE CONCAT(${sysName},'%')
			UNION ALL
		select F_GUID,F_SBID,F_SYS_NAME,F_NICK_NAME,F_NODE_TYPE,F_CHANNEL_INDEX,F_INIT_VAL FROM bes_analog_ouput WHERE F_SYS_NAME LIKE CONCAT(${sysName},'%')
		    UNION ALL
		select F_GUID,F_SBID,F_SYS_NAME,F_NICK_NAME,F_NODE_TYPE,F_CHANNEL_INDEX,F_INIT_VAL FROM bes_digit_input WHERE F_SYS_NAME LIKE CONCAT(${sysName},'%')
			UNION ALL
		select F_GUID,F_SBID,F_SYS_NAME,F_NICK_NAME,F_NODE_TYPE,F_CHANNEL_INDEX,F_INIT_VAL FROM bes_digit_ouput WHERE F_SYS_NAME LIKE CONCAT(${sysName},'%')
	</select>


	<!-- 查询逻辑实点状态信息 -->
	<select id="getPointState" parameterType="String" resultType="java.util.HashMap">
		select F_GUID,F_SBID,F_SYS_NAME,F_NICK_NAME,F_NODE_TYPE,F_CHANNEL_INDEX,F_INIT_VAL,F_WORK_MODE from bes_analog_input a where a.F_SYS_NAME = #{f_sys_name}
			UNION
		select F_GUID,F_SBID,F_SYS_NAME,F_NICK_NAME,F_NODE_TYPE,F_CHANNEL_INDEX,F_INIT_VAL,F_WORK_MODE from bes_analog_ouput b where b.F_SYS_NAME = #{f_sys_name}
			UNION
		select F_GUID,F_SBID,F_SYS_NAME,F_NICK_NAME,F_NODE_TYPE,F_CHANNEL_INDEX,F_INIT_VAL,F_WORK_MODE from bes_digit_input c where c.F_SYS_NAME = #{f_sys_name}
			UNION
		select F_GUID,F_SBID,F_SYS_NAME,F_NICK_NAME,F_NODE_TYPE,F_CHANNEL_INDEX,F_INIT_VAL,F_WORK_MODE from bes_digit_ouput d where d.F_SYS_NAME = #{f_sys_name}
	</select>
	<!-- 获取设备树上所有DDC -->
	<select id="queryAllDdc" resultMap="sbdyMap">
		<!--select * from bes_sbpz_struct where F_TYPE in ('2','3','26')-->
		select * from bes_sbpz_struct where F_TYPE in ('2','3')
	</select>
	<!--通过sbid和父节点查询模块信息-->
	<select id="queryModuleInfo" resultType="java.util.HashMap">
		select * from bes_sbpz_struct where  F_SBID= #{f_id}
		<if test="pSysName!= null and pSysName !='' "><!-- 模块同步状态 -->
			and F_PSYS_NAME = #{pSysName}
		</if>

	</select>


	<!-- 查询模块信息 -->
	<select id="queryLampModule" resultType="java.util.HashMap">
		select
		F_SYS_NAME,F_PSYS_NAME,F_TYPE
		from bes_sbpz_struct
		where
		F_SYS_NAME in (
			select F_SYS_NAME from bes_sbpz_struct  where F_PSYS_NAME = #{pSysName}
		)
	</select>

	<select id="queryBranchAmmeterRlgl" resultType="Integer">
		SELECT count(1) as num FROM bes_branch_ammeter_rlgl WHERE F_DBSYS_NAME = #{f_sys_name}
	</select>

	<select id="findVpointname" parameterType="String" resultType="String">
		select F_VPOINT_TYPE from bes_vpoint_type where id = #{f_id}
	</select>

	<insert id="importControlInfo" parameterType="String">
		insert bes_control_info (F_ID,F_SYS_NAME,F_BUTTON_NAME,F_PAGE,F_BUTTON_TYPE)
		values
		(#{fId},#{f_sys_name},#{f_button_name},#{nodePage},#{f_button_type});
	</insert>

	<delete id="delControlInfo" parameterType="String">
		DELETE FROM bes_control_info WHERE F_PAGE=#{nodePage}
	</delete>

	<select id="getControlInfo" resultType="Integer">
		select count(1) as num from bes_control_info WHERE F_PAGE=#{nodePage}
	</select>
	<!--<select id="getSumSbCount" resultType="java.lang.Integer">
		Select count(*) from bes_sbpz_struct where 1=1 and f_sbid is not null and  f_sys_name like '${fSysName}%'
	</select>-->
	<select id="getAllDdc" resultType="java.util.Map">
		select * from bes_ddc
	</select>
	<select id="getSbpzList" resultType="java.util.Map">
		select F_SBID,F_SYS_NAME,F_NICK_NAME from bes_sbpz_struct where F_SYS_NAME like '${f_sys_name}%' and F_NICK_NAME not in ('新增总线','新增线路') ;
	</select>

	<update id="editPollStatusBySysName" parameterType="string">
		update bes_sbpz_struct set F_POLL_STATUS = #{fPollStatus} where F_SYS_NAME like '${fSysName}%'
	</update>
	<update id="fSbidUpdate">
		update bes_sbpz_struct set f_sbid = #{f_sbid} where f_sys_name = #{fSysName}
	</update>
	<update id="ffSbidUpdate">
		update ${table} m left join bes_sbpz_struct s on m.f_sys_name = s.f_sys_name set m.f_sbid = s.F_SBID where m.F_SYS_NAME like '${f_sys_name}%' ;
	</update>

	<update id="editSBTreeInfo">
		<foreach collection="sbTreeList" item="item" index="index"  separator=";">
			UPDATE bes_sbpz_struct
			<set>
				f_status = #{item.f_status}
			</set>
			WHERE f_sys_name = #{item.f_sys_name}
		</foreach>
	</update>

	<update id="editPointInfo2">
		UPDATE bes_sbpz_struct set F_POLL_STATUS = 0
		<!--<foreach collection="besList" item="item" index="index"  separator=";">
			UPDATE bes_sbpz_struct
			<set>
				f_status = #{item.f_status}
			</set>
			WHERE f_sys_name = #{item.f_sys_name}
		</foreach>-->
	</update>

	<update id="updateBatch"  parameterType="java.util.List">
		<foreach collection="list" item="item" index="index" open="" close="" separator=";">
			UPDATE bes_sbpz_struct
			<set>
				f_status = #{item.f_status}
			</set>
			WHERE f_sys_name = #{item.f_sys_name}
		</foreach>
	</update>

	<update id="updateBes">
		/*UPDATE bes_sbpz_struct set f_status = 0 where f_sys_name = #{f_sys_name}*/
		<foreach collection="list" item="item" index="index" open="" close="" separator=";">
			UPDATE bes_sbpz_struct
			<set>
				f_status = #{item.f_status}
			</set>
			WHERE f_sys_name = #{item.f_sys_name}
		</foreach>
	</update>

	<update id="editPointInfo">
		<foreach collection="pointList" item="obj" index="index"  separator=";">
			UPDATE ${obj.tabName}
			<set>
				<if test="obj.myInput_f_sys_name != null and obj.myInput_f_sys_name !=''">
					F_SYS_NAME = #{obj.myInput_f_sys_name},
				</if>
				<if test="obj.f_enabled != null and obj.f_enabled !=''">
					F_ENABLED = #{obj.f_enabled},
				</if>
				<if test="obj.f_type != null and obj.f_type !='' ">
					F_TYPE = #{obj.f_type},
				</if>
				<if test="obj.f_nick_name != null and obj.f_nick_name !='' ">
					F_NICK_NAME = #{obj.f_nick_name},
				</if>
				<if test="obj.f_ip_addr != null and obj.f_ip_addr !='' ">
					F_IP_ADDR = #{obj.f_ip_addr},
				</if>
				<if test="obj.f_ssqy != null and obj.f_ssqy !='' ">
					F_SSQY = #{obj.f_ssqy},
				</if>
				<if test="obj.f_description != null and obj.f_description !='' ">
					F_DESCRIPTION = #{obj.f_description},
				</if>
				<if test="obj.f_channel_index != null and obj.f_channel_index !='' "><!-- 通道索引 -->
					F_CHANNEL_INDEX = #{obj.f_channel_index},
				</if>
				<if test="obj.f_type != null and obj.f_type !='' "><!-- 型号 -->
					F_TYPE = #{obj.f_type},
				</if>
				<if test="obj.f_azwz != null and obj.f_azwz !='' "><!-- 安装位置 -->
					F_AZWZ = #{obj.f_azwz},
				</if>
				<if test="obj.f_init_val != null "><!-- 初 始 值 -->
					F_INIT_VAL = #{obj.f_init_val},
				</if>
				<if test="obj.f_engineer_unit != null and obj.f_engineer_unit !='' "><!-- 工程单位 -->
					F_ENGINEER_UNIT = #{obj.f_engineer_unit},
				</if>
				<if test="obj.f_accuracy != null and obj.f_accuracy !='' "><!-- 精度 -->
					F_ACCURACY = #{obj.f_accuracy},
				</if>
				<if test="obj.f_point_type != null and obj.f_point_type !='' "><!-- 虚点类型 -->
					F_POINT_TYPE = #{obj.f_point_type},
				</if>
				<if test="obj.f_alarm_enable != null and obj.f_alarm_enable !='' "><!-- 报警使能 -->
					F_ALARM_ENABLE = #{obj.f_alarm_enable},
				</if>
				<if test="obj.f_alarm_type != null and obj.f_alarm_type !='' "><!-- 报警类型 -->
					F_ALARM_TYPE = #{obj.f_alarm_type},
				</if>
				<if test="obj.f_high_limit != null and obj.f_high_limit !='' "><!-- 高限报警 -->
					F_HIGH_LIMIT = #{obj.f_high_limit},
				</if>
				<if test="obj.f_low_limit != null and obj.f_low_limit !='' "><!-- 低限报警 -->
					F_LOW_LIMIT = #{obj.f_low_limit},
				</if>
				<if test="obj.f_alarm_priority != null and obj.f_alarm_priority !='' "><!-- 报警优先级 -->
					F_ALARM_PRIORITY = #{obj.f_alarm_priority},
				</if>
				<if test="obj.f_addr != null and obj.f_addr !='' "><!-- 通信地址 -->
					F_ADDR = #{obj.f_addr},
				</if>
				<if test="obj.f_node_type != null and obj.f_node_type !='' "><!-- 点类型 -->
					F_NODE_TYPE = #{obj.f_node_type},
				</if>
				<if test="obj.f_work_mode != null and obj.f_work_mode !='' "><!-- 工作模式 -->
					F_WORK_MODE = #{obj.f_work_mode},
				</if>
				<if test="obj.f_max_val != null and obj.f_max_val !='' "><!-- 最大值 -->
					F_MAX_VAL = #{obj.f_max_val},
				</if>
				<if test="obj.f_min_val != null and obj.f_min_val !='' "><!-- 最小值 -->
					F_MIN_VAL = #{obj.f_min_val},
				</if>
				<if test="obj.f_reversed != null and obj.f_reversed !='' "><!-- 是否反向 -->
					F_REVERSED = #{obj.f_reversed},
				</if>
				<if test="obj.f_sinnal_type != null and obj.f_sinnal_type !='' "><!-- 信号类型 -->
					F_SINNAL_TYPE = #{obj.f_sinnal_type},
				</if>
				<if test="obj.f_blxbh != null and obj.f_blxbh !='' "><!-- 电表类型编号 -->
					F_BLXBH = #{obj.f_blxbh},
				</if>
				<if test="obj.f_blxmc != null and obj.f_blxmc !='' "><!-- 电表类型名称 -->
					F_BLXMC = #{obj.f_blxmc},
				</if>
				<if test="obj.f_communication_port != null and obj.f_communication_port !='' "><!-- 通信端口 -->
					F_COMMUNICATION_PORT = #{obj.f_communication_port},
				</if>
				<if test="obj.f_comm_rate != null and obj.f_comm_rate !='' "><!-- 通信波特率编号 -->
					F_COMM_RATE = #{obj.f_comm_rate},
				</if>
				<if test="obj.f_comm_rate_mc != null and obj.f_comm_rate_mc !='' "><!-- 通信波特率编号 -->
					F_COMM_RATE_MC = #{obj.f_comm_rate_mc},
				</if>
				<if test="obj.f_protocol_type != null and obj.f_protocol_type !='' "><!-- 通信协议编号 -->
					F_PROTOCOL_TYPE = #{obj.f_protocol_type},
				</if>
				<if test="obj.f_protocol_type_mc != null and obj.f_protocol_type_mc !='' "><!-- 通信协议编号 -->
					F_PROTOCOL_TYPE_MC = #{obj.f_protocol_type_mc},
				</if>
				<if test="obj.f_wldz != null and obj.f_wldz !='' "><!-- 物理地址 -->
					F_WLDZ = #{obj.f_wldz},
				</if>
				<if test="obj.f_cjfabh != null and obj.f_cjfabh !='' "><!-- 采集方案编号 -->
					F_CJFABH = #{obj.f_cjfabh},
				</if>
				<if test="obj.f_cjfamc != null and obj.f_cjfamc !='' "><!-- 采集方案名称 -->
					F_CJFAMC = #{obj.f_cjfamc},
				</if>
				<if test="obj.f_percentage != null and obj.f_percentage !='' "><!-- 变比 -->
					F_PERCENTAGE = #{obj.f_percentage},
				</if>
				<if test="obj.f_close_state != null and obj.f_close_state !='' "><!-- 闭合状态 -->
					F_CLOSE_STATE = #{obj.f_close_state},
				</if>
				<if test="obj.f_sblxbh != null and obj.f_sblxbh !='' "><!-- 设备类型编号 -->
					F_SBLXBH = #{obj.f_sblxbh},
				</if>
				<if test="obj.f_allpath != null and obj.f_allpath !='' and obj.tabName =='BES_SBPZ_STRUCT' "><!-- 设备树结构表中全路径 -->
					F_ALLPATH = #{obj.f_allpath},
				</if>
				<if test="obj.f_status != null and obj.tabName =='BES_SBPZ_STRUCT' "><!-- 设备树结构表中在线状态 -->
					F_STATUS = #{obj.f_status},
				</if>
				<if test="obj.f_port != null and obj.f_port !='' "><!-- 设备类型编号 -->
					F_PORT = #{obj.f_port},
				</if>
				<if test="obj.f_belong_iprouter != null and obj.f_belong_iprouter !='' "><!-- 耦合器的归属系统 -->
					F_BELONG_IPROUTER = #{obj.f_belong_iprouter},
				</if>
				<!--修改时间  -->
				F_CHDATE = current_timestamp()
			</set>
			WHERE F_SYS_NAME=#{obj.f_sys_name}
		</foreach>
	</update>

	<update id="editPointInfoChange">
		<foreach collection="pointList" item="obj" index="index"  separator=";">
			UPDATE ${obj.tabName}
			<set>
				<!--<if test="obj.myInput_f_sys_name != null and obj.myInput_f_sys_name !=''">
					F_SYS_NAME = #{obj.f_sys_name},
				</if>-->
				<if test="obj.f_enabled != null and obj.f_enabled !=''">
					F_ENABLED = #{obj.f_enabled},
				</if>
				<if test="obj.f_type != null and obj.f_type !='' ">
					F_TYPE = #{obj.f_type},
				</if>
				<if test="obj.f_nick_name != null and obj.f_nick_name !='' ">
					F_NICK_NAME = #{obj.f_nick_name},
				</if>
				<if test="obj.f_ip_addr != null and obj.f_ip_addr !='' ">
					F_IP_ADDR = #{obj.f_ip_addr},
				</if>
				<if test="obj.f_ssqy != null and obj.f_ssqy !='' ">
					F_SSQY = #{obj.f_ssqy},
				</if>
				<if test="obj.f_description != null and obj.f_description !='' ">
					F_DESCRIPTION = #{obj.f_description},
				</if>
				<if test="obj.f_channel_index != null and obj.f_channel_index !='' "><!-- 通道索引 -->
					F_CHANNEL_INDEX = #{obj.f_channel_index},
				</if>
				<if test="obj.f_type != null and obj.f_type !='' "><!-- 型号 -->
					F_TYPE = #{obj.f_type},
				</if>
				<if test="obj.f_azwz != null and obj.f_azwz !='' "><!-- 安装位置 -->
					F_AZWZ = #{obj.f_azwz},
				</if>
				<if test="obj.f_init_val != null "><!-- 初 始 值 -->
					F_INIT_VAL = #{obj.f_init_val},
				</if>
				<if test="obj.f_engineer_unit != null and obj.f_engineer_unit !='' "><!-- 工程单位 -->
					F_ENGINEER_UNIT = #{obj.f_engineer_unit},
				</if>
				<if test="obj.f_accuracy != null and obj.f_accuracy !='' "><!-- 精度 -->
					F_ACCURACY = #{obj.f_accuracy},
				</if>
				<if test="obj.f_point_type != null and obj.f_point_type !='' "><!-- 虚点类型 -->
					F_POINT_TYPE = #{obj.f_point_type},
				</if>
				<if test="obj.f_alarm_enable != null and obj.f_alarm_enable !='' "><!-- 报警使能 -->
					F_ALARM_ENABLE = #{obj.f_alarm_enable},
				</if>
				<if test="obj.f_alarm_type != null and obj.f_alarm_type !='' "><!-- 报警类型 -->
					F_ALARM_TYPE = #{obj.f_alarm_type},
				</if>
				<if test="obj.f_high_limit != null and obj.f_high_limit !='' "><!-- 高限报警 -->
					F_HIGH_LIMIT = #{obj.f_high_limit},
				</if>
				<if test="obj.f_low_limit != null and obj.f_low_limit !='' "><!-- 低限报警 -->
					F_LOW_LIMIT = #{obj.f_low_limit},
				</if>
				<if test="obj.f_alarm_priority != null and obj.f_alarm_priority !='' "><!-- 报警优先级 -->
					F_ALARM_PRIORITY = #{obj.f_alarm_priority},
				</if>
				<if test="obj.f_addr != null and obj.f_addr !='' "><!-- 通信地址 -->
					F_ADDR = #{obj.f_addr},
				</if>
				<if test="obj.f_node_type != null and obj.f_node_type !='' "><!-- 点类型 -->
					F_NODE_TYPE = #{obj.f_node_type},
				</if>
				<if test="obj.f_work_mode != null and obj.f_work_mode !='' "><!-- 工作模式 -->
					F_WORK_MODE = #{obj.f_work_mode},
				</if>
				<if test="obj.f_max_val != null and obj.f_max_val !='' "><!-- 最大值 -->
					F_MAX_VAL = #{obj.f_max_val},
				</if>
				<if test="obj.f_min_val != null and obj.f_min_val !='' "><!-- 最小值 -->
					F_MIN_VAL = #{obj.f_min_val},
				</if>
				<if test="obj.f_reversed != null and obj.f_reversed !='' "><!-- 是否反向 -->
					F_REVERSED = #{obj.f_reversed},
				</if>
				<if test="obj.f_sinnal_type != null and obj.f_sinnal_type !='' "><!-- 信号类型 -->
					F_SINNAL_TYPE = #{obj.f_sinnal_type},
				</if>
				<if test="obj.f_blxbh != null and obj.f_blxbh !='' "><!-- 电表类型编号 -->
					F_BLXBH = #{obj.f_blxbh},
				</if>
				<if test="obj.f_blxmc != null and obj.f_blxmc !='' "><!-- 电表类型名称 -->
					F_BLXMC = #{obj.f_blxmc},
				</if>
				<if test="obj.f_communication_port != null and obj.f_communication_port !='' "><!-- 通信端口 -->
					F_COMMUNICATION_PORT = #{obj.f_communication_port},
				</if>
				<if test="obj.f_comm_rate != null and obj.f_comm_rate !='' "><!-- 通信波特率编号 -->
					F_COMM_RATE = #{obj.f_comm_rate},
				</if>
				<if test="obj.f_comm_rate_mc != null and obj.f_comm_rate_mc !='' "><!-- 通信波特率编号 -->
					F_COMM_RATE_MC = #{obj.f_comm_rate_mc},
				</if>
				<if test="obj.f_protocol_type != null and obj.f_protocol_type !='' "><!-- 通信协议编号 -->
					F_PROTOCOL_TYPE = #{obj.f_protocol_type},
				</if>
				<if test="obj.f_protocol_type_mc != null and obj.f_protocol_type_mc !='' "><!-- 通信协议编号 -->
					F_PROTOCOL_TYPE_MC = #{obj.f_protocol_type_mc},
				</if>
				<if test="obj.f_wldz != null and obj.f_wldz !='' "><!-- 物理地址 -->
					F_WLDZ = #{obj.f_wldz},
				</if>
				<if test="obj.f_cjfabh != null and obj.f_cjfabh !='' "><!-- 采集方案编号 -->
					F_CJFABH = #{obj.f_cjfabh},
				</if>
				<if test="obj.f_cjfamc != null and obj.f_cjfamc !='' "><!-- 采集方案名称 -->
					F_CJFAMC = #{obj.f_cjfamc},
				</if>
				<if test="obj.f_percentage != null and obj.f_percentage !='' "><!-- 变比 -->
					F_PERCENTAGE = #{obj.f_percentage},
				</if>
				<if test="obj.f_close_state != null and obj.f_close_state !='' "><!-- 闭合状态 -->
					F_CLOSE_STATE = #{obj.f_close_state},
				</if>
				<if test="obj.f_sblxbh != null and obj.f_sblxbh !='' "><!-- 设备类型编号 -->
					F_SBLXBH = #{obj.f_sblxbh},
				</if>
				<if test="obj.f_allpath != null and obj.f_allpath !='' and obj.tabName =='BES_SBPZ_STRUCT' "><!-- 设备树结构表中全路径 -->
					F_ALLPATH = #{obj.f_allpath},
				</if>
				<if test="obj.f_status != null and obj.tabName =='BES_SBPZ_STRUCT' "><!-- 设备树结构表中在线状态 -->
					F_STATUS = #{obj.f_status},
				</if>
				<if test="obj.f_port != null and obj.f_port !='' "><!-- 设备类型编号 -->
					F_PORT = #{obj.f_port},
				</if>
				<if test="obj.f_belong_iprouter != null and obj.f_belong_iprouter !='' "><!-- 耦合器的归属系统 -->
					F_BELONG_IPROUTER = #{obj.f_belong_iprouter},
				</if>
				<!--修改时间  -->
				F_CHDATE = current_timestamp()
			</set>
			WHERE F_SYS_NAME=#{obj.f_sys_name}
		</foreach>
	</update>

	<!-- Stard add by yangjx at 20191026 for 根据系统名称查询、删除和插入节点配置设置表数据 -->
	<select id="selectNodesConfigSetting" parameterType="String" resultType="Map">
		SELECT F_DESC,F_VALUE FROM BES_NODE_CONFIG_SETTING WHERE F_SYS_NAME=#{f_sys_name}
		<!--王红杰修改  -->
      <!--(SELECT F_SYS_NAME_OLD from bes_sbpz_struct where F_SYS_NAME=#{f_sys_name})-->
	</select>

	<delete id="deleteNodesConfigSettingBySysName" parameterType="String">
		DELETE FROM BES_NODE_CONFIG_SETTING WHERE F_SYS_NAME=#{f_sys_name}
	</delete>

	<insert id="insertNodesConfigSetting"  parameterType="java.util.ArrayList">
		INSERT INTO BES_NODE_CONFIG_SETTING
		(F_SYS_NAME, F_DESC,F_VALUE,F_CREATEUSER,F_CREATEDATE)
		VALUES
		<foreach collection="list" item="item" index="index" separator=",">
			(#{item.f_sys_name},#{item.f_desc},#{item.f_value},#{item.f_createuser},#{item.f_createdate})
		</foreach>
	</insert>
	<!-- End add by yangjx at 20191026 for 根据系统名称删除和插入节点配置设置表数据 -->

	<!--王红杰  根据old_f_sys_name查询bes_sbpz_struct表的数据-->
	<select id="listpoint" parameterType="String" resultType="java.util.HashMap">
		Select * from bes_sbpz_struct where F_SYS_NAME_OLD = #{old_f_sys_name}
	</select>

	<!--Start update  by xiepufeng at 2020年3月14日 remark 替换模糊查询以支持修改系统名称-->
	<select id="getSumSbCount" resultType="java.lang.Integer">
		select count(*) from
		((SELECT  DATA.* FROM(
		SELECT
		@ids as _ids,
		( SELECT @ids := GROUP_CONCAT(F_SYS_NAME)
		FROM BES_SBPZ_STRUCT
		WHERE FIND_IN_SET(F_PSYS_NAME, @ids)
		) as cids,
		@l := @l+1 as level
		FROM BES_SBPZ_STRUCT,
		(SELECT @ids := #{fSysName}, @l := 0 ) b
		WHERE @ids IS NOT NULL
		) F_SYS_NAME, BES_SBPZ_STRUCT DATA
		WHERE FIND_IN_SET(DATA.F_PSYS_NAME, F_SYS_NAME._ids)
		ORDER BY level, F_SYS_NAME)
		UNION
		(select * from bes_sbpz_struct where f_sys_name = #{fSysName})) f
		where f.f_sbid is not null
	</select>
	<!--End update by xiepufeng at 2020年3月14日 remark 替换模糊查询以支持修改系统名称-->

	<select id="searchByPSysNameChildren" resultMap="sbdyMap">


		(SELECT  DATA.* FROM(
			SELECT
			@ids as _ids,
			( SELECT @ids := GROUP_CONCAT(F_SYS_NAME)
			FROM BES_SBPZ_STRUCT
			WHERE FIND_IN_SET(F_PSYS_NAME, @ids)
			) as cids,
			@l := @l+1 as level
			FROM BES_SBPZ_STRUCT,
			(SELECT @ids :=#{f_psys_name}, @l := 0 ) b
			WHERE @ids IS NOT NULL
			) F_SYS_NAME, BES_SBPZ_STRUCT DATA
			WHERE FIND_IN_SET(DATA.F_PSYS_NAME, F_SYS_NAME._ids)
			ORDER BY level, F_SYS_NAME)

	</select>
	<!--Start replace by xiepufeng at 2020年3月13日 remark 替换通过模糊查询更新 F_POLL_STATUS 字段，
	 根据F_SYS_NAME更新 F_POLL_STATUS-->
	<update id="updatePollStatusBySysName">
		update bes_sbpz_struct set F_POLL_STATUS = #{fPollStatus} where F_SYS_NAME = #{fSysName}
	</update>
	<!--End  replace by xiepufeng at 2020年3月13日-->

	<!-- 根据系统名称编辑设备树信息 wanghongjie-->
	<update id="editSbTreeStructInfoBySysNameXT" parameterType="com.alibaba.fastjson.JSONObject">
		UPDATE ${obj.tabName}
		<set>
			<if test="obj.f_sys_name != null and obj.f_sys_name !=''">
				F_SYS_NAME_OLD = #{obj.f_sys_name},
			</if>
			<if test="obj.myInput_f_sys_name != null and obj.myInput_f_sys_name !=''">
				F_GUID = #{obj.myInput_f_sys_name},
			</if>
			<if test="obj.f_energyStatics != null and obj.f_energyStatics != ''">
				F_ENERGYSTATICS = #{obj.f_energyStatics},
			</if>
			<if test="obj.f_staticsTime != null and obj.f_staticsTime != ''">
				F_STATICSTIME = #{obj.f_staticsTime},
			</if>
			<if test="obj.f_enabled != null and obj.f_enabled !=''">
				F_ENABLED = #{obj.f_enabled},
			</if>
			<if test="obj.f_type != null and obj.f_type !='' ">
				F_TYPE = #{obj.f_type},
			</if>
			<if test="obj.f_nick_name != null and obj.f_nick_name !='' ">
				F_NICK_NAME = #{obj.f_nick_name},
			</if>
			<if test="obj.f_ip_addr != null and obj.f_ip_addr !='' ">
				F_IP_ADDR = #{obj.f_ip_addr},
			</if>
			<if test="obj.f_ssqy != null and obj.f_ssqy !='' ">
				F_SSQY = #{obj.f_ssqy},
			</if>
			<if test="obj.f_description != null and obj.f_description !='' ">
				F_DESCRIPTION = #{obj.f_description},
			</if>
			<if test="obj.f_channel_index != null and obj.f_channel_index !='' "><!-- 通道索引 -->
				F_CHANNEL_INDEX = #{obj.f_channel_index},
			</if>
			<if test="obj.f_type != null and obj.f_type !='' "><!-- 型号 -->
				F_TYPE = #{obj.f_type},
			</if>
			<if test="obj.f_azwz != null and obj.f_azwz !='' "><!-- 安装位置 -->
				F_AZWZ = #{obj.f_azwz},
			</if>
			<if test="obj.f_init_val != null "><!-- 初 始 值 -->
				F_INIT_VAL = #{obj.f_init_val},
			</if>
			<if test="obj.f_engineer_unit != null and obj.f_engineer_unit !='' "><!-- 工程单位 -->
				F_ENGINEER_UNIT = #{obj.f_engineer_unit},
			</if>
			<if test="obj.f_accuracy != null and obj.f_accuracy !='' "><!-- 精度 -->
				F_ACCURACY = #{obj.f_accuracy},
			</if>
			<if test="obj.f_point_type != null and obj.f_point_type !='' "><!-- 虚点类型 -->
				F_POINT_TYPE = #{obj.f_point_type},
			</if>
			<if test="obj.f_alarm_enable != null and obj.f_alarm_enable !='' "><!-- 报警使能 -->
				F_ALARM_ENABLE = #{obj.f_alarm_enable},
			</if>
			<if test="obj.f_alarm_type != null and obj.f_alarm_type !='' "><!-- 报警类型 -->
				F_ALARM_TYPE = #{obj.f_alarm_type},
			</if>
			<if test="obj.f_high_limit != null and obj.f_high_limit !='' "><!-- 高限报警 -->
				F_HIGH_LIMIT = #{obj.f_high_limit},
			</if>
			<if test="obj.f_low_limit != null and obj.f_low_limit !='' "><!-- 低限报警 -->
				F_LOW_LIMIT = #{obj.f_low_limit},
			</if>
			<if test="obj.f_alarm_priority != null and obj.f_alarm_priority !='' "><!-- 报警优先级 -->
				F_ALARM_PRIORITY = #{obj.f_alarm_priority},
			</if>
			<if test="obj.f_addr != null and obj.f_addr !='' "><!-- 通信地址 -->
				F_ADDR = #{obj.f_addr},
			</if>
			<if test="obj.f_node_type != null and obj.f_node_type !='' "><!-- 点类型 -->
				F_NODE_TYPE = #{obj.f_node_type},
			</if>
			<if test="obj.f_work_mode != null and obj.f_work_mode !='' "><!-- 工作模式 -->
				F_WORK_MODE = #{obj.f_work_mode},
			</if>
			<if test="obj.f_max_val != null and obj.f_max_val !='' "><!-- 最大值 -->
				F_MAX_VAL = #{obj.f_max_val},
			</if>
			<if test="obj.f_min_val != null and obj.f_min_val !='' "><!-- 最小值 -->
				F_MIN_VAL = #{obj.f_min_val},
			</if>
			<if test="obj.f_reversed != null and obj.f_reversed !='' "><!-- 是否反向 -->
				F_REVERSED = #{obj.f_reversed},
			</if>
			<if test="obj.f_sinnal_type != null and obj.f_sinnal_type !='' "><!-- 信号类型 -->
				F_SINNAL_TYPE = #{obj.f_sinnal_type},
			</if>
			<if test="obj.f_blxbh != null and obj.f_blxbh !='' "><!-- 电表类型编号 -->
				F_BLXBH = #{obj.f_blxbh},
			</if>
			<if test="obj.f_blxmc != null and obj.f_blxmc !='' "><!-- 电表类型名称 -->
				F_BLXMC = #{obj.f_blxmc},
			</if>
			<if test="obj.f_communication_port != null and obj.f_communication_port !='' "><!-- 通信端口 -->
				F_COMMUNICATION_PORT = #{obj.f_communication_port},
			</if>
			<if test="obj.f_comm_rate != null and obj.f_comm_rate !='' "><!-- 通信波特率编号 -->
				F_COMM_RATE = #{obj.f_comm_rate},
			</if>
			<if test="obj.f_comm_rate_mc != null and obj.f_comm_rate_mc !='' "><!-- 通信波特率编号 -->
				F_COMM_RATE_MC = #{obj.f_comm_rate_mc},
			</if>
			<if test="obj.f_protocol_type != null and obj.f_protocol_type !='' "><!-- 通信协议编号 -->
				F_PROTOCOL_TYPE = #{obj.f_protocol_type},
			</if>
			<if test="obj.f_protocol_type_mc != null and obj.f_protocol_type_mc !='' "><!-- 通信协议编号 -->
				F_PROTOCOL_TYPE_MC = #{obj.f_protocol_type_mc},
			</if>
			<if test="obj.f_wldz != null and obj.f_wldz !='' "><!-- 物理地址 -->
				F_WLDZ = #{obj.f_wldz},
			</if>
			<if test="obj.f_cjfabh != null and obj.f_cjfabh !='' "><!-- 采集方案编号 -->
				F_CJFABH = #{obj.f_cjfabh},
			</if>
			<if test="obj.f_cjfamc != null and obj.f_cjfamc !='' "><!-- 采集方案名称 -->
				F_CJFAMC = #{obj.f_cjfamc},
			</if>
			<if test="obj.f_percentage != null and obj.f_percentage !='' "><!-- 变比 -->
				F_PERCENTAGE = #{obj.f_percentage},
			</if>
			<if test="obj.f_close_state != null and obj.f_close_state !='' "><!-- 闭合状态 -->
				F_CLOSE_STATE = #{obj.f_close_state},
			</if>
			<if test="obj.f_sblxbh != null and obj.f_sblxbh !='' "><!-- 设备类型编号 -->
				F_SBLXBH = #{obj.f_sblxbh},
			</if>
			<if test="obj.f_allpath != null and obj.f_allpath !='' and obj.tabName =='BES_SBPZ_STRUCT' "><!-- 设备树结构表中全路径 -->
				F_ALLPATH = #{obj.f_allpath},
			</if>
			<if test="obj.f_status != null and obj.tabName =='BES_SBPZ_STRUCT' "><!-- 设备树结构表中在线状态 -->
				F_STATUS = #{obj.f_status},
			</if>
			<if test="obj.f_port != null and obj.f_port !='' "><!-- 设备类型编号 -->
				F_PORT = #{obj.f_port},
			</if>
			<if test="obj.f_belong_iprouter != null and obj.f_belong_iprouter !='' "><!-- 耦合器的归属系统 -->
				F_BELONG_IPROUTER = #{obj.f_belong_iprouter},
			</if>
			<!-- 王红杰 20200116  增加是否有源的修改 -->
			<if test="obj.f_sourced != null and obj.f_sourced !='' "><!-- 是否有源 -->
				F_SOURCED = #{obj.f_sourced},
			</if>
			<if test="obj.f_com_data_bit != null and obj.f_com_data_bit !='' "><!-- 数据位 -->
				F_COM_DATA_BIT = #{obj.f_com_data_bit},
			</if>
			<if test="obj.f_com_parity_bit != null and obj.f_com_parity_bit !='' "><!-- 校验位 -->
				F_COM_PARITY_BIT = #{obj.f_com_parity_bit},
			</if>
			<if test="obj.f_com_stop_bit != null and obj.f_com_stop_bit !='' "><!-- 停止位 -->
				F_COM_STOP_BIT = #{obj.f_com_stop_bit},
			</if>
			<if test="obj.f_function_code != null and obj.f_function_code !='' "><!-- 停止位 -->
				F_FUNCTION_CODE = #{obj.f_function_code},
			</if>
			<if test="obj.f_ammeter_state != null and obj.f_ammeter_state !='' "><!-- 同步状态 -->
				F_AMMETER_STATE = #{obj.f_ammeter_state},
			</if>
			<if test="obj.assets_code != null and obj.assets_code !='' "><!-- 资产编码 -->
				ASSETS_CODE = #{obj.assets_code},
			</if>
			<!--修改时间  -->
			F_CHDATE = current_timestamp()
		</set>
		WHERE F_SYS_NAME=#{obj.f_sys_name} || F_SYS_NAME_OLD = #{obj.f_sys_name}
	</update>
	<!--wanghongjie 插入txt文本到bes_txt_begin表里面-->
	<insert id="importProgrammInfo" parameterType="com.alibaba.fastjson.JSONObject">
		insert into bes_txt_begin (f_guid,f_txt) values (#{f_id},#{ddcbcInfoTextNext})
	</insert>

	<!-- wanghongjie 获取DDC的信息以及关联的程序的txt文件-->
	<select id="getSbTreeAndTxtInfoBySysNameAndId" parameterType="String" resultMap="sbdyMap">
		select c.*,d.f_txt,d.f_id txt_id
		from bes_sbpz_struct c LEFT JOIN bes_txt_begin d on c.F_ID=d.f_guid  where  c.f_id = #{f_id}
	</select>

	<!--wanghongjie 查询bes_txt_begin表里面是否有DDC设备树的id-->
	<select id="selectProgrammInfo" parameterType="integer" resultMap="besTxt">
		SELECT * from bes_txt_begin where f_guid = #{f_id}
	</select>

	<!--wanghongjie 修改bes_txt_begin表的txt文本信息-->
	<update id="updateProgrammInfo" parameterType="object">
		update bes_txt_begin
		<set>
			f_txt = #{ddcbcInfoTextNext}
		</set>
		where f_guid=#{f_id}
	</update>

	<!--修改bes_txt_begin表的上传的文本信息-->
	<update id="updateProgrammInfoFile" parameterType="object">
		update bes_txt_begin
		<set>
			f_txt = #{txtend}
		</set>
		where f_guid=#{f_id}
	</update>

	<!--wanghongjie 插入上传的文本到bes_txt_begin表里面-->
	<insert id="importProgrammInfoFile" parameterType="com.alibaba.fastjson.JSONObject">
		insert into bes_txt_begin (f_guid,f_txt) values (#{f_id},#{txtend})
	</insert>

	<!--wanghongjie 查询bes_txt_end表里面是否有DDC设备树的id-->
	<select id="selectProgrammInfoByEnd" parameterType="integer" resultMap="besTxt">
		SELECT * from bes_txt_end where f_guid = #{id}
	</select>

	<!--wanghongjie 修改bes_txt_end表的编译好的文本信息-->
	<update id="updateProgrammInfoByEnd" parameterType="object">
		update bes_txt_end
		<set>
			f_txt = #{txtend}
		</set>
		where f_guid=#{id}
	</update>

	<!--wanghongjie 插入编译好的文本到bes_txt_begin表里面-->
	<insert id="importProgrammInfoByEnd" parameterType="com.alibaba.fastjson.JSONObject">
		insert into bes_txt_end (f_guid,f_txt) values (#{id},#{txtend})
	</insert>

    <!--wanghongjie 修改能耗采集器的信息 BES_COLLECTOR-->
	<update id="editSbTreeStructInfoCollector" parameterType="com.alibaba.fastjson.JSONObject">
		UPDATE BES_COLLECTOR
		<set>
			<if test="obj.attr_f_sys_name != null and obj.attr_f_sys_name !=''"><!--修改的系统名称-->
				F_SYS_NAME_OLD = #{obj.attr_f_sys_name},
			</if>
			<if test="obj.f_enabled != null and obj.f_enabled !=''"><!--使能状态-->
				F_ENABLED = #{obj.f_enabled},
			</if>
			<if test="obj.f_nick_name != null and obj.f_nick_name !='' "><!--别名-->
				F_NICK_NAME = #{obj.f_nick_name},
			</if>
			<if test="obj.f_ip_addr != null and obj.f_ip_addr !='' "><!--ip-->
				F_IP_ADDR = #{obj.f_ip_addr},
			</if>
			<if test="obj.f_ssqy != null and obj.f_ssqy !='' "><!--归属区域-->
				F_SSQY = #{obj.f_ssqy},
			</if>
			<if test="obj.f_description != null and obj.f_description !='' "><!--描述-->
				F_DESCRIPTION = #{obj.f_description},
			</if>
			<if test="obj.f_type != null and obj.f_type !='' "><!-- 型号 -->
				F_TYPE = #{obj.f_type},
			</if>
			<if test="obj.f_azwz != null and obj.f_azwz !='' "><!-- 安装位置 -->
				F_AZWZ = #{obj.f_azwz},
			</if>
			<if test="obj.f_port != null and obj.f_port !='' "><!-- 采集器端口 -->
				F_PORT = #{obj.f_port},
			</if>
			<if test="obj.f_coll_cycle != null and obj.f_coll_cycle !='' "><!-- 采集周期 -->
				F_COLL_CYCLE = #{obj.f_coll_cycle},
			</if>
			<if test="obj.f_his_data_save_cycle != null and obj.f_his_data_save_cycle !='' "><!-- 历史保存周期 -->
				F_HIS_DATA_SAVE_CYCLE = #{obj.f_his_data_save_cycle},
			</if>
			<!--修改时间  -->
			F_CHDATE = current_timestamp()
		</set>
		WHERE F_SYS_NAME=#{obj.f_sys_name}
	</update>
	<!--wanghongjie 修改修改能耗采集器的信息 BES_SBPZ_STRUCT-->
	<update id="editSbTreeStructInfoSbpzStruct" parameterType="com.alibaba.fastjson.JSONObject">
		UPDATE BES_SBPZ_STRUCT
		<set>
			<if test="obj.attr_f_sys_name != null and obj.attr_f_sys_name !=''"><!--修改的系统名称-->
				F_SYS_NAME_OLD = #{obj.attr_f_sys_name},
			</if>
			<if test="obj.f_type != null and obj.f_type !='' ">
				F_TYPE = #{obj.f_type},
			</if>
			<if test="obj.f_nick_name != null and obj.f_nick_name !='' ">
				F_NICK_NAME = #{obj.f_nick_name},
			</if>
			<if test="obj.f_description != null and obj.f_description !='' ">
				F_DESCRIPTION = #{obj.f_description},
			</if>
			<!--修改时间  -->
			F_CHDATE = current_timestamp()
		</set>
		WHERE F_SYS_NAME=#{obj.f_sys_name}
	</update>

	<!--wanghongjie start 20200615 查询当前名称所属的表-->
	<select id="selectTableName" parameterType="java.lang.String" resultType="java.lang.String">
		SELECT f_node_table from bes_sbtree_nodetype where F_NODE_TYPE =
		(SELECT f_type from bes_sbpz_struct where F_SYS_NAME_OLD = #{id})
	</select>

	<!--wanghongjie start 20200615 查询当前点位的全部信息-->
	<select id="selectPointList" resultMap="besPointStruct" parameterType="java.lang.String">
		select * from ${tableName} where F_SYS_NAME_OLD = #{id}
	</select>

	<!--wanghongjie start 20200615 查询当前点位所属的DDC全部信息-->
	<select id="selectDDCName" parameterType="string" resultMap="BesDdcResultMap">
		select * from bes_ddc where F_SYS_NAME_OLD = (
		select F_PSYS_NAME from bes_sbpz_struct where F_SYS_NAME_OLD =(
		select F_PSYS_NAME from bes_sbpz_struct where F_SYS_NAME_OLD =(
		select F_PSYS_NAME from bes_sbpz_struct where F_SYS_NAME_OLD =(
		select F_PSYS_NAME from bes_sbpz_struct where F_SYS_NAME_OLD = #{id}
		))))
	</select>
	<!--wanghongjie start 20200615 查询当前点位所属的模块名称-->
	<select id="selectModuleName" parameterType="string"  resultType="string">
		select F_PSYS_NAME from bes_sbpz_struct where F_SYS_NAME_OLD = #{id}
	</select>

	<!--wanghongjie start 20200616 查询当前虚点所属的DDC全部信息-->
	<select id="selectDDCNameByVpoint" parameterType="string" resultMap="BesDdcResultMap">
		select * from bes_ddc where F_SYS_NAME_OLD = (
		select F_PSYS_NAME from bes_sbpz_struct where F_SYS_NAME_OLD =(
		select F_PSYS_NAME from bes_sbpz_struct where F_SYS_NAME_OLD = #{id}
		))
	</select>

	<update id="update_AO_AI_Alarm">
		update ${tableName} set F_WHETHER_TO_ALARM_HIGH = #{alarm_high},F_WHETHER_TO_ALARM_LOW = #{alarm_low} where f_sys_name_old = #{id}
	</update>

	<!--wanghongjie start 20200622 查询bes_ddc表的最大的f_sbid-->
	<select id="select_f_sbid_By_Bes_Ddc" resultType="java.lang.String" parameterType="java.lang.String">
		SELECT  max(CAST(F_SBID as SIGNED)) as F_SBID  FROM bes_ddc
	</select>
<!---->
	<!--wanghongjie start 20200622  ddc控制器添加到bes_sbpz_struct表-->
	<insert id="sbdy_ddcInfo_insert_bes_sbpz_struct" parameterType="com.alibaba.fastjson.JSONObject">
		insert bes_sbpz_struct
		(
		<if test='obj.f_sbid != null and obj.f_sbid != "" '><!--设备id-->
			F_SBID,
		</if>
		<if test='obj.f_sys_name != null and obj.f_sys_name != "" '><!--系统名称-->
			F_SYS_NAME,
		</if>
		<if test='obj.f_sys_name != null and obj.f_sys_name != "" '><!--系统名称-->
			F_SYS_NAME_OLD,
		</if>
		<if test='obj.f_nick_name != null and obj.f_nick_name != "" '><!--系统名称-->
			F_NICK_NAME,
		</if>
		<if test='obj.f_allpath != null and obj.f_allpath != "" '><!--全路径-->
			F_ALLPATH,
		</if>
		<if test='obj.f_description != null and obj.f_description != "" '><!--描述-->
			F_DESCRIPTION,
		</if>
		<if test='obj.f_type != null and obj.f_type != "" '><!--节点类型 楼层0、区域1、DDC2、IP路由器3、采集器4、网络控制器5、干线耦合器6、支线耦合器7、总线8、模块9、AI10、AO11、DI12、DO13、UI14、UX15、虚点16、  VAI 17、 VAO 18、 VDI 19、 VDO20-->
			F_TYPE,
		</if>
		<if test='obj.f_node_attribution != null and obj.f_node_attribution != "" '><!--所属系统 1代表cross : 楼控-->
			F_NODE_ATTRIBUTION,
		</if>
		<if test='obj.f_psys_name != null and obj.f_psys_name != "" '><!--父节点名称-->
			F_PSYS_NAME,
		</if>
		<if test='obj.f_status != null and obj.f_status != "" '><!--状态 0 离线 、 1 正常 默认正常-->
			F_STATUS,
		</if>
			F_CRDATE)
		values (
		<if test='obj.f_sbid != null and obj.f_sbid != "" '><!--设备id-->
			#{obj.f_sbid},
		</if>
		<if test='obj.f_sys_name != null and obj.f_sys_name != "" '><!--系统名称-->
			#{obj.f_sys_name},
		</if>
		<if test='obj.f_sys_name != null and obj.f_sys_name != "" '><!--下发到下位机的系统名称-->
			#{obj.f_sys_name},
		</if>
		<if test='obj.f_nick_name != null and obj.f_nick_name != "" '><!--系统别名-->
			#{obj.f_nick_name},
		</if>
		<if test='obj.f_allpath != null and obj.f_allpath != "" '><!--全路径-->
			#{obj.f_allpath},
		</if>
		<if test='obj.f_description != null and obj.f_description != "" '><!--描述-->
			#{obj.f_description},
		</if>
		<if test='obj.f_type != null and obj.f_type != "" '><!--节点类型 楼层0、区域1、DDC2、IP路由器3、采集器4、网络控制器5、干线耦合器6、支线耦合器7、总线8、模块9、AI10、AO11、DI12、DO13、UI14、UX15、虚点16、  VAI 17、 VAO 18、 VDI 19、 VDO20-->
			#{obj.f_type},
		</if>
		<if test='obj.f_node_attribution != null and obj.f_node_attribution != "" '><!--所属系统 1代表cross : 楼控-->
			#{obj.f_node_attribution},
		</if>
		<if test='obj.f_psys_name != null and obj.f_psys_name != "" '><!--父节点名称-->
			#{obj.f_psys_name},
		</if>
		<if test='obj.f_status != null and obj.f_status != "" '><!--状态 0 离线 、 1 正常 默认正常-->
			#{obj.f_status},
		</if>
		current_timestamp()
		)
	</insert>
	<insert id="sbdy_ddcInfo_insert_bes_DCC" parameterType="com.alibaba.fastjson.JSONObject">
		insert bes_ddc (
		<if test='obj.f_sbid != null and obj.f_sbid != "" '><!--设备id-->
			F_SBID,
		</if>
		<if test='obj.f_sys_name != null and obj.f_sys_name != "" '><!--发送下位机的系统名称 -->
			F_SYS_NAME_OLD,
		</if>
		<if test='obj.f_sys_name != null and obj.f_sys_name != "" '><!-- 系统名称-->
			F_SYS_NAME,
		</if>
		<if test='obj.f_nick_name != null and obj.f_nick_name != "" '><!--别名 -->
			F_NICK_NAME,
		</if>
		<if test='obj.f_enabled != null and obj.f_enabled != "" '><!-- 使能状态-->
			F_ENABLED,
		</if>
		<if test='obj.f_ssqy != null and obj.f_ssqy != "" '><!-- 所属区域 -->
			F_SSQY,
		</if>
		<if test='obj.f_type != null and obj.f_type != "" '><!-- 节点类型-->
			F_NODE_TYPE,
		</if>
		<if test='obj.attr_f_sblxbh != null and obj.attr_f_sblxbh != "" '><!-- 设备类型编号-->
			F_SBLXBH,
		</if>
		<if test='obj.f_azwz != null and obj.f_azwz != "" '><!--安装位置 -->
			F_AZWZ,
		</if>
		<if test='obj.f_description != null and obj.f_description != "" '><!--描述 -->
			F_DESCRIPTION,
		</if>
		<if test='obj.attr_f_type != null and obj.attr_f_type != "" '><!-- 型号-->
			F_TYPE,
		</if>
		<if test='obj.f_ip_addr != null and obj.f_ip_addr != "" '><!-- IP地址-->
			F_IP_ADDR,
		</if>
		<if test='obj.f_port != null and obj.f_port != "" '><!-- 端口号-->
			F_PORT,
		</if>
		<if test='obj.f_yqbh != null and obj.f_yqbh != "" '><!--园区编号 -->
			F_YQBH,
		</if>
		<if test='obj.f_ip_addr != null and obj.f_ip_addr != "" '><!--通道id -->
			F_CHANNEL_ID,
		</if>
		<if test='obj.f_ddc_state != null and obj.f_ddc_state != "" '><!--同步状态(初始化添加默认未同步) -->
			F_DDC_STATE,
		</if>
		<if test='obj.f_online_state != null and obj.f_online_state != "" '><!--在线状态(初始化添加默认未同步) -->
			F_ONLINE_STATE,
		</if>
		<if test='obj.f_save_period != null and obj.f_save_period != "" '><!--保存周期 -->
			F_SAVE_PERIOD,
		</if>
		F_CRDATE
		) values (
		<if test='obj.f_sbid != null and obj.f_sbid != "" '><!--设备id-->
			#{obj.f_sbid},
		</if>
		<if test='obj.f_sys_name != null and obj.f_sys_name != "" '><!--发送下位机的系统名称 -->
			#{obj.f_sys_name},
		</if>
		<if test='obj.f_sys_name != null and obj.f_sys_name != "" '><!-- 系统名称-->
			#{obj.f_sys_name},
		</if>
		<if test='obj.f_nick_name != null and obj.f_nick_name != "" '><!--别名 -->
			#{obj.f_nick_name},
		</if>
		<if test='obj.f_enabled != null and obj.f_enabled != "" '><!-- 使能状态-->
			#{obj.f_enabled},
		</if>
		<if test='obj.f_ssqy != null and obj.f_ssqy != "" '><!-- 所属区域 -->
			#{obj.f_ssqy},
		</if>
		<if test='obj.f_type != null and obj.f_type != "" '><!-- 节点类型-->
			#{obj.f_type},
		</if>
		<if test='obj.attr_f_sblxbh != null and obj.attr_f_sblxbh != "" '><!-- 设备类型编号-->
			#{obj.attr_f_sblxbh},
		</if>
		<if test='obj.f_azwz != null and obj.f_azwz != "" '><!--安装位置 -->
			#{obj.f_azwz},
		</if>
		<if test='obj.f_description != null and obj.f_description != "" '><!--描述 -->
			#{obj.f_description},
		</if>
		<if test='obj.attr_f_type != null and obj.attr_f_type != "" '><!-- 型号-->
			#{obj.attr_f_type},
		</if>
		<if test='obj.f_ip_addr != null and obj.f_ip_addr != "" '><!-- IP地址-->
			#{obj.f_ip_addr},
		</if>
		<if test='obj.f_port != null and obj.f_port != "" '><!-- 端口号-->
			#{obj.f_port},
		</if>
		<if test='obj.f_yqbh != null and obj.f_yqbh != "" '><!--园区编号 -->
			#{obj.f_yqbh},
		</if>
		<if test='obj.f_ip_addr != null and obj.f_ip_addr != "" '><!--通道id -->
			#{obj.f_ip_addr},
		</if>
		<if test='obj.f_ddc_state != null and obj.f_ddc_state != "" '><!--同步状态(初始化添加默认未同步) -->
			#{obj.f_ddc_state},
		</if>
		<if test='obj.f_online_state != null and obj.f_online_state != "" '><!--在线状态(初始化添加默认未同步) -->
			#{obj.f_online_state},
		</if>
		<if test='obj.f_save_period != null and obj.f_save_period != "" '><!--保存周期 -->
			#{obj.f_save_period},
		</if>
		current_timestamp()
		)
	</insert>

	<!--wanghongjie start 20200623 ip是否重复-->
	<select id="getSizeByIpAddrBesDdc" parameterType="string" resultType="java.lang.Integer">
		SELECT COUNT(*) from bes_ddc where F_IP_ADDR = #{f_ip_addr} || F_CHANNEL_ID = #{f_ip_addr}
	</select>

	<select id="getSizeByIpAddrBesCollector" parameterType="string" resultType="java.lang.Integer">
		select COUNT(*) from bes_collector where F_IP_ADDR = #{f_ip_addr} || F_CHANNEL_ID = #{f_ip_addr}
	</select>

	<!--wanghongjie start 20200623 修改DDC控制器在bes_sbpz_struct表的信息-->
	<update id="sbdy_ddcInfo_update_bes_sbpz_struct" parameterType="com.alibaba.fastjson.JSONObject">
		update bes_sbpz_struct
		<set>
			<if test=" obj.f_nick_name != null and obj.f_nick_name != '' "><!--别名-->
				F_NICK_NAME = #{obj.f_nick_name},
			</if>
			<if test="obj.f_description != null and obj.f_description != '' "><!--描述-->
				F_DESCRIPTION = #{obj.f_description},
			</if>
			<if test="obj.allpath != null and obj.allpath != '' "><!--全路径-->
				F_ALLPATH = #{obj.allpath},
			</if>
				F_CHDATE = current_timestamp()<!--修改时间-->
		</set>
		where F_ID = #{obj.f_id}
	</update>

	<!--wanghongjie start 20200623 修改DDC控制器在bes_DDC表的信息-->
	<update id="sbdy_ddcInfo_update_bes_DDC" parameterType="com.alibaba.fastjson.JSONObject">
		update bes_ddc
		<set>
			<if test=" obj.f_nick_name != null and obj.f_nick_name != '' "><!--别名-->
				F_NICK_NAME = #{obj.f_nick_name},
			</if>
			<if test="obj.f_enabled != null and obj.f_enabled != '' "><!--使能状态-->
				F_ENABLED = #{obj.f_enabled},
			</if>
			<if test="obj.f_ip_addr != null and obj.f_ip_addr != '' "><!--ip-->
				F_IP_ADDR = #{obj.f_ip_addr},
			</if>
			<if test="obj.f_description != null and obj.f_description != '' "><!--描述-->
				F_DESCRIPTION = #{obj.f_description},
			</if>
			<if test="obj.f_azwz != null and obj.f_azwz != '' "><!--安装位置-->
				F_AZWZ = #{obj.f_azwz},
			</if>
			<if test="obj.f_ssqy != null and obj.f_ssqy != '' "><!--所属区域  -->
				F_SSQY = #{obj.f_ssqy},
			</if>
			<if test="obj.attr_f_sblxbh != null and obj.attr_f_sblxbh != '' "><!--设备类型编号-->
				F_SBLXBH = #{obj.attr_f_sblxbh},
			</if>
			<if test="obj.attr_f_type != null and obj.attr_f_type != '' "><!--型号-->
				F_TYPE = #{obj.attr_f_type},
			</if>
			<if test="obj.f_port != null and obj.f_port != '' "><!--端口号-->
				F_PORT = #{obj.f_port},
			</if>
			<if test="obj.f_channel_id != null and obj.f_channel_id != '' "><!--通道id-->
				F_CHANNEL_ID = #{obj.f_channel_id},
			</if>
			<if test="obj.f_gateway != null and obj.f_gateway != '' "><!--默认网关-->
				F_GATEWAY = #{obj.f_gateway},
			</if>
			<if test="obj.f_mask != null and obj.f_mask != '' "><!--子网掩码-->
				F_MASK = #{obj.f_mask},
			</if>
			<if test="obj.f_ip_master != null and obj.f_ip_master != '' "><!--主机ip-->
				F_IP_MASTER = #{obj.f_ip_master},
			</if>
			<if test="obj.f_port_master != null and obj.f_port_master != '' "><!--主机端口-->
				F_PORT_MASTER = #{obj.f_port_master},
			</if>
			<if test='obj.f_ddc_state != null and obj.f_ddc_state != "" '><!--同步状态(初始化修改默认未同步) -->
				F_DDC_STATE = #{obj.f_ddc_state},
			</if>
			<if test='obj.f_save_period != null and obj.f_save_period != "" '><!--保存周期 -->
				F_SAVE_PERIOD = #{obj.f_save_period},
			</if>
			F_CHDATE = current_timestamp()<!--修改时间-->
		</set>
		where F_GUID = #{obj.f_guid}
	</update>

	<!--wanghongjie start 20200628 根据名称查询当前DDC点位的全部信息-->
	<select id="DDCInfoMap" resultType="java.util.Map">
		select * from bes_ddc where F_SYS_NAME_OLD = #{fSysName}
	</select>
	<!--wanghongjie start 20200630 查询模块表的最大的sbid-->
	<select id="select_f_sbid_By_Bes_Module" resultType="java.lang.String">
		SELECT max(CAST(F_SBID AS signed)) F_SBID  from bes_module
	</select>
	<!--wanghongjie start 20200630 根据父节点系统名称查询总线名称-->
	<select id="selectFlnName" resultType="java.lang.String">
		select F_NICK_NAME from bes_sbpz_struct where f_sys_name_old = #{f_psys_name}
	</select>

	<!--wanghongjie start 20200630 插入模块的信息到设备配置表-->
	<insert id="addSbTreeModuleInfo" parameterType="com.alibaba.fastjson.JSONObject">
		insert bes_sbpz_struct
		(
		<if test='obj.f_sbid != null and obj.f_sbid != "" '><!--设备id-->
			F_SBID,
		</if>
		<if test='obj.f_sys_name != null and obj.f_sys_name != "" '><!--下发到下位机的系统名称-->
			F_SYS_NAME_OLD,
		</if>
		<if test='obj.f_sys_name != null and obj.f_sys_name != "" '><!--组成树的系统名称-->
			F_SYS_NAME,
		</if>
		<if test='obj.f_nick_name != null and obj.f_nick_name != "" '><!--别名-->
			F_NICK_NAME,
		</if>
		<if test='obj.f_allpath != null and obj.f_allpath != "" '><!--路径-->
			F_ALLPATH,
		</if>
		<if test='obj.f_description != null and obj.f_description != "" '><!--模块的描述信息-->
			F_DESCRIPTION,
		</if>
		<if test='obj.f_type != null and obj.f_type != "" '><!--节点类型 -->
			F_TYPE,
		</if>
		<if test='obj.f_node_attribution != null and obj.f_node_attribution != "" '><!--所属系统，cross1、lamp2、energy3-->
			F_NODE_ATTRIBUTION,
		</if>
		<if test='obj.f_psys_name != null and obj.f_psys_name != "" '><!--父节点系统名称-->
			F_PSYS_NAME,
		</if>
		<if test='obj.f_status != null and obj.f_status != "" '><!--状态  0 离线 、 1 正常 、 2 报警-->
			F_STATUS,
		</if>
		F_CRDATE
		)
		values (
		<if test='obj.f_sbid != null and obj.f_sbid != "" '><!--设备id-->
			#{obj.f_sbid},
		</if>
		<if test='obj.f_sys_name != null and obj.f_sys_name != "" '><!--下发到下位机的系统名称-->
			#{obj.f_sys_name},
		</if>
		<if test='obj.f_sys_name != null and obj.f_sys_name != "" '><!--组成树的系统名称-->
			#{obj.f_sys_name},
		</if>
		<if test='obj.f_nick_name != null and obj.f_nick_name != "" '><!--别名-->
			#{obj.f_nick_name},
		</if>
		<if test='obj.f_allpath != null and obj.f_allpath != "" '><!--路径-->
			#{obj.f_allpath},
		</if>
		<if test='obj.f_description != null and obj.f_description != "" '><!--模块的描述信息-->
			#{obj.f_description},
		</if>
		<if test='obj.f_type != null and obj.f_type != "" '><!--节点类型-->
			#{obj.f_type},
		</if>
		<if test='obj.f_node_attribution != null and obj.f_node_attribution != "" '><!--所属系统，cross1、lamp2、energy3-->
			#{obj.f_node_attribution},
		</if>
		<if test='obj.f_psys_name != null and obj.f_psys_name != "" '><!--父节点系统名称-->
			#{obj.f_psys_name},
		</if>
		<if test='obj.f_status != null and obj.f_status != "" '><!--状态  0 离线 、 1 正常 、 2 报警-->
			#{obj.f_status},
		</if>
		current_timestamp()
		)
	</insert>
	<!--wanghongjie start 20200630 将模块信息添加到模块表中-->
	<insert id="addbesModule" parameterType="com.alibaba.fastjson.JSONObject">
		insert bes_module
		(
		<if test='obj.module_guid != null and obj.module_guid != "" '><!--设备id-->
			F_SBID,
		</if> 
		<if test='obj.f_struct_id != null and obj.f_struct_id != "" '><!--设备树id-->
			F_STRUCT_ID,
		</if>
		<if test='obj.f_sys_name != null and obj.f_sys_name != "" '><!--下发到下位机的系统名称-->
			F_SYS_NAME_OLD,
		</if>
		<if test='obj.f_sys_name != null and obj.f_sys_name != "" '><!--组成树的系统名称-->
			F_SYS_NAME,
		</if>
		<if test='obj.f_nick_name != null and obj.f_nick_name != "" '><!--别名-->
			F_NICK_NAME,
		</if>
		<if test='obj.f_type != null and obj.f_type != "" '><!--节点类型 -->
			F_NODE_TYPE,
		</if>
		<if test='obj.f_enabled != null and obj.f_enabled != "" '><!--是否使用:不使用0使用1，只有使用才能与其通信-->
			F_ENABLED,
		</if>
		<if test='obj.f_module_type != null and obj.f_module_type != "" '><!--模块型号-->
			F_TYPE,
		</if>
		<if test='obj.f_azwz != null and obj.f_azwz != "" '><!--安装位置-->
			F_AZWZ,
		</if>
		<if test='obj.f_description != null and obj.f_description != "" '><!--描述-->
			F_DESCRIPTION,
		</if>
		<if test='obj.f_addr_module != null and obj.f_addr_module != "" '><!--地址 通信地址1.00~255.00-->
			F_ADDR,
		</if>
		<if test='obj.f_yqbh != null and obj.f_yqbh != "" '><!--园区编号-->
			F_YQBH,
		</if>
		<if test='obj.f_module_state != null and obj.f_module_state != "" '><!--初始添加默认未同步-->
			F_MODULE_STATE,
		</if>
		F_CRDATE
		) values (
		<if test='obj.module_guid != null and obj.module_guid != "" '><!--设备id-->
			#{obj.module_guid},
		</if>
		<if test='obj.f_struct_id != null and obj.f_struct_id != "" '><!--设备树id-->
			#{obj.f_struct_id},
		</if>
		<if test='obj.f_sys_name != null and obj.f_sys_name != "" '><!--下发到下位机的系统名称-->
			#{obj.f_sys_name},
		</if>
		<if test='obj.f_sys_name != null and obj.f_sys_name != "" '><!--组成树的系统名称-->
			#{obj.f_sys_name},
		</if>
		<if test='obj.f_nick_name != null and obj.f_nick_name != "" '><!--别名-->
			#{obj.f_nick_name},
		</if>
		<if test='obj.f_type != null and obj.f_type != "" '><!--节点类型 -->
			#{obj.f_type},
		</if>
		<if test='obj.f_enabled != null and obj.f_enabled != "" '><!--是否使用:不使用0使用1，只有使用才能与其通信-->
			#{obj.f_enabled},
		</if>
		<if test='obj.f_module_type != null and obj.f_module_type != "" '><!--模块型号 -->
			#{obj.f_module_type},
		</if>
		<if test='obj.f_azwz != null and obj.f_azwz != "" '><!--安装位置-->
			#{obj.f_azwz},
		</if>
		<if test='obj.f_description != null and obj.f_description != "" '><!--描述-->
			#{obj.f_description},
		</if>
		<if test='obj.f_addr_module != null and obj.f_addr_module != "" '><!--地址 通信地址1.00~255.00-->
			#{obj.f_addr_module},
		</if>
		<if test='obj.f_yqbh != null and obj.f_yqbh != "" '><!--园区编号-->
			#{obj.f_yqbh},
		</if>
		<if test='obj.f_module_state != null and obj.f_module_state != "" '><!--初始添加默认未同步-->
			#{obj.f_module_state},
		</if>
		current_timestamp()
		)
	</insert>

	<!--wanghongjie start 20200630 查询当前ddc下的所有的模块的通信地址-->
	<select id="f_addrList" resultType="java.util.Map">
		SELECT * from bes_module where F_SYS_NAME_OLD in
		(select F_SYS_NAME_OLD from bes_sbpz_struct where F_PSYS_NAME in
		(select F_SYS_NAME_OLD from bes_sbpz_struct where F_PSYS_NAME = (
		 select F_SYS_NAME_OLD from bes_sbpz_struct where F_PSYS_NAME = #{f_sys_name_old_ddc} &amp;&amp; f_nick_name = "总线"
		)))
	</select>

	<!--修改[设备树结构表]的信息 -->
	<update id="updateSbdyModule" parameterType="com.alibaba.fastjson.JSONObject">
		update bes_sbpz_struct
		<set>
			<if test=" obj.f_nick_name != null and obj.f_nick_name != '' "><!--别名-->
				F_NICK_NAME = #{obj.f_nick_name},
			</if>
			<if test=" obj.f_description != null and obj.f_description != '' "><!--描述-->
				F_DESCRIPTION = #{obj.f_description},
			</if>
				F_CHDATE = current_timestamp()<!--修改时间-->
		</set>
		where F_ID = #{obj.f_id}
	</update>

	<!--修改模块表的信息-->
	<update id="updatebesModule" parameterType="com.alibaba.fastjson.JSONObject">
		update bes_module
		<set>
			<if test=" obj.f_nick_name != null and obj.f_nick_name != '' "><!--别名-->
				F_NICK_NAME = #{obj.f_nick_name},
			</if>
			<if test=" obj.f_enabled != null and obj.f_enabled != '' "><!--使能状态-->
				F_ENABLED = #{obj.f_enabled},
			</if>
			<if test=" obj.f_azwz != null and obj.f_azwz != '' "><!--安装位置-->
				F_AZWZ = #{obj.f_azwz},
			</if>
			<if test=" obj.f_description != null and obj.f_description != '' "><!--描述-->
				F_DESCRIPTION = #{obj.f_description},
			</if>
			<if test=" obj.f_addr_module != null and obj.f_addr_module != '' "><!--通信地址-->
				F_ADDR = #{obj.f_addr_module},
			</if>
			<if test='obj.f_module_state != null and obj.f_module_state != "" '><!--初始修改默认未同步-->
				F_MODULE_STATE = #{obj.f_module_state},
			</if>
			F_CHDATE = current_timestamp()<!--修改时间-->
		</set>
		where F_GUID = #{obj.f_guid}
	</update>

    <!--根据系统名称更新设备树节点状态-->
    <update id="updateNodeStateBySysName">
		update bes_sbpz_struct set F_STATUS = #{state} where F_SYS_NAME = #{sysName}
	</update>

	<!--根据系统名称批量更新设备树节点状态-->
	<update id="batchUpdateNodeStateBySysName">
		update bes_sbpz_struct
		<set>
			F_STATUS = #{state}
		</set>
		WHERE F_SYS_NAME in
		<foreach collection="list" item="item" separator="," open="("  close=")">
			#{item.f_sys_name}
		</foreach>
	</update>

	<!--wanghongjie start 20200702 修改点位在设备配置表中的信息-->
	<update id="updatesbdyByPoint" parameterType="com.alibaba.fastjson.JSONObject">
		update bes_sbpz_struct
		<set>
			<if test="obj.old_f_sys_name != null and obj.old_f_sys_name != ''"><!--下发下位机的名称-->
				F_SYS_NAME_OLD = #{obj.old_f_sys_name},
			</if>
			<if test="obj.f_nick_name != null and obj.f_nick_name != ''"><!--别名-->
				F_NICK_NAME = #{obj.f_nick_name},
			</if>
			<if test="obj.f_allpath != null and obj.f_allpath != ''"><!--全部路径-->
				F_ALLPATH = #{obj.f_allpath},
			</if>
			<if test="obj.f_description != null and obj.f_description != ''"><!--描述-->
				F_DESCRIPTION = #{obj.f_description},
			</if>
			<if test="obj.f_node_type != null and obj.f_node_type != ''"><!--节点类型-->
				F_TYPE = #{obj.f_node_type},
			</if>
			<if test="obj.f_status != null and obj.f_status != ''"><!--在线状态-->
				F_STATUS = #{obj.f_status},
			</if>
			F_CHDATE = current_timestamp()<!--修改时间-->
		</set>
		<where>
			<if test="obj.f_id != null">
				F_ID = #{obj.f_id}
			</if>
		</where>
	</update>

	<!--wanghongjie start 20200702 将信息添加到DO表中-->
	<insert id="insertDOPointTable" parameterType="com.alibaba.fastjson.JSONObject">
		insert bes_digit_ouput
		(
		<if test="obj.f_sbid != null and obj.f_sbid != ''"><!--设备id，用于下位机通讯-->
			F_SBID,
		</if>
		<if test="obj.f_id != null and obj.f_id != ''"><!--设备树id-->
			F_STRUCT_ID,
		</if>
		<if test="obj.old_f_sys_name != null and obj.old_f_sys_name != ''"><!--下发下位机的名称-->
			F_SYS_NAME_OLD,
		</if>
		<if test="obj.f_sys_name != null and obj.f_sys_name != ''"><!--系统名称-->
			F_SYS_NAME,
		</if>
		<if test="obj.f_nick_name != null and obj.f_nick_name != ''"><!--别名-->
			F_NICK_NAME,
		</if>
		<if test="obj.f_node_type != null and obj.f_node_type != ''"><!--点类型-->
			F_NODE_TYPE,
		</if>
		<if test="obj.f_channel_index != null and obj.f_channel_index != ''"><!--通道索引-->
			F_CHANNEL_INDEX,
		</if>
		<if test="obj.f_enabled != null and obj.f_enabled != ''"><!--是否可用-->
			F_ENABLED,
		</if>
		<if test="obj.f_reversed != null and obj.f_reversed != ''"><!--是否反向-->
			F_REVERSED,
		</if>
		<if test="obj.f_work_mode != null and obj.f_work_mode != ''"><!--工作模式 -->
			F_WORK_MODE,
		</if>
		<if test="obj.f_alarm_enable != null and obj.f_alarm_enable != ''"><!--报警使能-->
			F_ALARM_ENABLE,
		</if>
		<if test="obj.f_alarm_type != null and obj.f_alarm_type != ''"><!--报警类型 -->
			F_ALARM_TYPE,
		</if>
		<if test="obj.f_close_state != null and obj.f_close_state != ''"><!--闭合状态-->
			F_CLOSE_STATE,
		</if>
		<if test="obj.f_alarm_priority != null and obj.f_alarm_priority != ''"><!--报警优先级-->
			F_ALARM_PRIORITY,
		</if>
		<if test="obj.f_init_val != null and obj.f_init_val != ''"><!--初始值-->
			F_INIT_VAL,
		</if>
		<if test="obj.f_description != null and obj.f_description != ''"><!--描述-->
			F_DESCRIPTION,
		</if>
		<if test="obj.f_yqbh != null and obj.f_yqbh != ''"><!--园区编号-->
			F_YQBH,
		</if>
		<if test="obj.f_fault_state != null and obj.f_fault_state != ''"><!--故障状态-->
			F_FAULT_STATE,
		</if>
		<if test="obj.f_do_state != null and obj.f_do_state != ''"><!--初始添加默认不同步-->
			F_DO_STATE,
		</if>
		F_CRDATE<!--创建时间-->
		)
		values (
		<if test="obj.f_sbid != null and obj.f_sbid != ''"><!--设备id，用于下位机通讯-->
			#{obj.f_sbid},
		</if>
		<if test="obj.f_id != null and obj.f_id != ''"><!--设备树id-->
			#{obj.f_id},
		</if>
		<if test="obj.old_f_sys_name != null and obj.old_f_sys_name != ''"><!--下发下位机的名称-->
			#{obj.old_f_sys_name},
		</if>
		<if test="obj.f_sys_name != null and obj.f_sys_name != ''"><!--系统名称-->
			#{obj.f_sys_name},
		</if>
		<if test="obj.f_nick_name != null and obj.f_nick_name != ''"><!--别名-->
			#{obj.f_nick_name},
		</if>
		<if test="obj.f_node_type != null and obj.f_node_type != ''"><!--点类型-->
			#{obj.f_node_type},
		</if>
		<if test="obj.f_channel_index != null and obj.f_channel_index != ''"><!--通道索引-->
			#{obj.f_channel_index},
		</if>
		<if test="obj.f_enabled != null and obj.f_enabled != ''"><!--是否可用-->
			#{obj.f_enabled},
		</if>
		<if test="obj.f_reversed != null and obj.f_reversed != ''"><!--是否反向-->
			#{obj.f_reversed},
		</if>
		<if test="obj.f_work_mode != null and obj.f_work_mode != ''"><!--工作模式 -->
			#{obj.f_work_mode},
		</if>
		<if test="obj.f_alarm_enable != null and obj.f_alarm_enable != ''"><!--报警使能-->
			#{obj.f_alarm_enable},
		</if>
		<if test="obj.f_alarm_type != null and obj.f_alarm_type != ''"><!--报警类型 -->
			#{obj.f_alarm_type},
		</if>
		<if test="obj.f_close_state != null and obj.f_close_state != ''"><!--闭合状态-->
			#{obj.f_close_state},
		</if>
		<if test="obj.f_alarm_priority != null and obj.f_alarm_priority != ''"><!--报警优先级-->
			#{obj.f_alarm_priority},
		</if>
		<if test="obj.f_init_val != null and obj.f_init_val != ''"><!--初始值-->
			#{obj.f_init_val},
		</if>
		<if test="obj.f_description != null and obj.f_description != ''"><!--描述-->
			#{obj.f_description},
		</if>
		<if test="obj.f_yqbh != null and obj.f_yqbh != ''"><!--园区编号-->
			#{obj.f_yqbh},
		</if>
		<if test="obj.f_fault_state != null and obj.f_fault_state != ''"><!--故障状态-->
			#{obj.f_fault_state},
		</if>
		<if test="obj.f_do_state != null and obj.f_do_state != ''"><!--初始添加默认不同步-->
			#{obj.f_do_state},
		</if>
		current_timestamp()<!--创建时间-->
		)
	</insert>

	<!--wanghongjie start 20200702 查询当前点位所属的ddc-->
	<select id="queryDDCMapByPoint" resultType="java.util.Map">
		select * from bes_ddc where F_SYS_NAME_OLD = (
		select f_psys_name FROM bes_sbpz_struct where F_SYS_NAME_OLD = (
		select f_psys_name FROM bes_sbpz_struct where F_SYS_NAME_OLD = (
		select f_psys_name FROM bes_sbpz_struct where F_SYS_NAME_OLD = (
		select f_psys_name FROM bes_sbpz_struct where F_ID = #{f_id}
		))))
	</select>

	<!--wanghongjie start 20200702 修改DO表的相应的点位信息-->
	<update id="updateDOPointTable" parameterType="com.alibaba.fastjson.JSONObject">
		update bes_digit_ouput
		<set>
			<if test="obj.old_f_sys_name != null and obj.old_f_sys_name != ''"><!--发送下位机的系统名称-->
				F_SYS_NAME_OLD = #{obj.old_f_sys_name},
			</if>
			<if test="obj.f_enabled != null and obj.f_enabled != ''"><!--使能状态-->
				F_ENABLED = #{obj.f_enabled},
			</if>
			<if test="obj.f_nick_name != null and obj.f_nick_name != ''"><!--别名-->
				F_NICK_NAME = #{obj.f_nick_name},
			</if>
			<if test="obj.f_reversed != null and obj.f_reversed != ''"><!--正反向-->
				F_REVERSED = #{obj.f_reversed},
			</if>
			<if test="obj.f_work_mode != null and obj.f_work_mode != ''"><!--工作模式-->
				F_WORK_MODE = #{obj.f_work_mode},
			</if>
			<if test="obj.f_alarm_enable != null and obj.f_alarm_enable != ''"><!--报警使能-->
				F_ALARM_ENABLE = #{obj.f_alarm_enable},
			</if>
			<if test="obj.f_alarm_type != null and obj.f_alarm_type != ''"><!--报警类型-->
				F_ALARM_TYPE = #{obj.f_alarm_type},
			</if>
			<if test="obj.f_close_state != null and obj.f_close_state != ''"><!--闭合状态-->
				F_CLOSE_STATE = #{obj.f_close_state},
			</if>
			<if test="obj.f_alarm_priority != null and obj.f_alarm_priority != ''"><!--报警优先级-->
				F_ALARM_PRIORITY = #{obj.f_alarm_priority},
			</if>
			<if test="obj.f_init_val != null and obj.f_init_val != ''"><!--初始值-->
				F_INIT_VAL = #{obj.f_init_val},
			</if>
			<if test="obj.f_description != null and obj.f_description != ''"><!--描述-->
				F_DESCRIPTION = #{obj.f_description},
			</if>
			<if test="obj.f_fault_state != null and obj.f_fault_state != ''"><!--故障状态-->
				F_FAULT_STATE = #{obj.f_fault_state},
			</if>
			<if test="obj.f_do_state != null and obj.f_do_state != ''"><!--同步状态-->
				F_DO_STATE = #{obj.f_do_state},
			</if>
			F_CHDATE = current_timestamp()<!--修改时间-->
		</set>
		where F_STRUCT_ID = #{obj.f_id}<!--根据DO表的设备配置id修改-->
	</update>

	<!--wanghongjie start 20200703 根据修改的系统名称查询设备配置的信息-->
	<select id="getSbTreeDataBySysNamePoint" parameterType="String" resultMap="sbdyMap">
		<include refid="find_xxx" />
		<include refid="from_xxx" />
		<where>
			F_SYS_NAME_OLD=#{name}
		</where>
	</select>

	<!--wanghongjie start 20200703 将信息添加到AO表中-->
	<insert id="insertAOPointTable" parameterType="com.alibaba.fastjson.JSONObject" >
		insert bes_analog_ouput
		(
		<if test="obj.f_sbid != null and obj.f_sbid != ''"><!--设备id，用于下位机通讯-->
			F_SBID,
		</if>
		<if test="obj.f_id != null and obj.f_id != ''"><!--设备树id-->
			F_STRUCT_ID,
		</if>
		<if test="obj.old_f_sys_name != null and obj.old_f_sys_name != ''"><!--下发下位机的名称-->
			F_SYS_NAME_OLD,
		</if>
		<if test="obj.f_sys_name != null and obj.f_sys_name != ''"><!--系统名称-->
			F_SYS_NAME,
		</if>
		<if test="obj.f_nick_name != null and obj.f_nick_name != ''"><!--别名-->
			F_NICK_NAME,
		</if>
		<if test="obj.f_node_type != null and obj.f_node_type != ''"><!--点类型-->
			F_NODE_TYPE,
		</if>
		<if test="obj.f_channel_index != null and obj.f_channel_index != ''"><!--通道索引-->
			F_CHANNEL_INDEX,
		</if>
		<if test="obj.f_enabled != null and obj.f_enabled != ''"><!--是否可用-->
			F_ENABLED,
		</if>
		<if test="obj.f_reversed != null and obj.f_reversed != ''"><!--是否反向-->
			F_REVERSED,
		</if>
		<if test="obj.f_work_mode != null and obj.f_work_mode != ''"><!--工作模式 -->
			F_WORK_MODE,
		</if>
		<if test="obj.f_alarm_enable != null and obj.f_alarm_enable != ''"><!--报警使能-->
			F_ALARM_ENABLE,
		</if>
		<if test="obj.f_alarm_type != null and obj.f_alarm_type != ''"><!--报警类型 -->
			F_ALARM_TYPE,
		</if>
		<if test="obj.f_close_state != null and obj.f_close_state != ''"><!--闭合状态-->
			F_CLOSE_STATE,
		</if>
		<if test="obj.f_alarm_priority != null and obj.f_alarm_priority != ''"><!--报警优先级-->
			F_ALARM_PRIORITY,
		</if>
		<if test="obj.f_init_val != null and obj.f_init_val != ''"><!--初始值-->
			F_INIT_VAL,
		</if>
		<if test="obj.f_description != null and obj.f_description != ''"><!--描述-->
			F_DESCRIPTION,
		</if>
		<if test="obj.f_yqbh != null and obj.f_yqbh != ''"><!--园区编号-->
			F_YQBH,
		</if>
		<if test="obj.f_engineer_unit != null and obj.f_engineer_unit != ''"><!--工程单位，如℉、℃、KWh-->
			F_ENGINEER_UNIT,
		</if>
		<if test="obj.f_sinnal_type != null and obj.f_sinnal_type != ''"><!--信号类型  0-10v 0  ;0-20mA 1;4-20mA 2-->
			F_SINNAL_TYPE,
		</if>
		<if test="obj.f_min_val != null and obj.f_min_val != ''"><!--最大值-->
			F_MIN_VAL,
		</if>
		<if test="obj.f_max_val != null and obj.f_max_val != ''"><!--最小值-->
			F_MAX_VAL,
		</if>
		<if test="obj.f_accuracy != null and obj.f_accuracy != ''"><!--精度-->
			F_ACCURACY,
		</if>
		<if test="obj.f_high_limit != null and obj.f_high_limit != ''"><!--高限报警  对于标准报警点，该点数值所允许达到的最高限值-->
			F_HIGH_LIMIT,
		</if>
		<if test="obj.f_low_limit != null and obj.f_low_limit != ''"><!--低限报警   对于标准报警点，该点数值所允许达到的最低限值-->
			F_LOW_LIMIT,
		</if>
		<if test="obj.f_ao_state != null and obj.f_ao_state != ''"><!--初始添加默认不同步-->
			F_AO_STATE,
		</if>
		<if test="obj.f_energyStatics != null and obj.f_energyStatics != ''"><!--能耗统计（0:是；1:否）-->
			F_ENERGYSTATICS,
		</if>
		<if test="obj.f_energy_type != null and obj.f_energy_type != ''"><!--能源类型-->
			F_ENERGY_TYPE,
		</if>
		F_CRDATE<!--创建时间-->
		)
		values (
		<if test="obj.f_sbid != null and obj.f_sbid != ''"><!--设备id，用于下位机通讯-->
			#{obj.f_sbid},
		</if>
		<if test="obj.f_id != null and obj.f_id != ''"><!--设备树id-->
			#{obj.f_id},
		</if>
		<if test="obj.old_f_sys_name != null and obj.old_f_sys_name != ''"><!--下发下位机的名称-->
			#{obj.old_f_sys_name},
		</if>
		<if test="obj.f_sys_name != null and obj.f_sys_name != ''"><!--系统名称-->
			#{obj.f_sys_name},
		</if>
		<if test="obj.f_nick_name != null and obj.f_nick_name != ''"><!--别名-->
			#{obj.f_nick_name},
		</if>
		<if test="obj.f_node_type != null and obj.f_node_type != ''"><!--点类型-->
			#{obj.f_node_type},
		</if>
		<if test="obj.f_channel_index != null and obj.f_channel_index != ''"><!--通道索引-->
			#{obj.f_channel_index},
		</if>
		<if test="obj.f_enabled != null and obj.f_enabled != ''"><!--是否可用-->
			#{obj.f_enabled},
		</if>
		<if test="obj.f_reversed != null and obj.f_reversed != ''"><!--是否反向-->
			#{obj.f_reversed},
		</if>
		<if test="obj.f_work_mode != null and obj.f_work_mode != ''"><!--工作模式 -->
			#{obj.f_work_mode},
		</if>
		<if test="obj.f_alarm_enable != null and obj.f_alarm_enable != ''"><!--报警使能-->
			#{obj.f_alarm_enable},
		</if>
		<if test="obj.f_alarm_type != null and obj.f_alarm_type != ''"><!--报警类型 -->
			#{obj.f_alarm_type},
		</if>
		<if test="obj.f_close_state != null and obj.f_close_state != ''"><!--闭合状态-->
			#{obj.f_close_state},
		</if>
		<if test="obj.f_alarm_priority != null and obj.f_alarm_priority != ''"><!--报警优先级-->
			#{obj.f_alarm_priority},
		</if>
		<if test="obj.f_init_val != null and obj.f_init_val != ''"><!--初始值-->
			#{obj.f_init_val},
		</if>
		<if test="obj.f_description != null and obj.f_description != ''"><!--描述-->
			#{obj.f_description},
		</if>
		<if test="obj.f_yqbh != null and obj.f_yqbh != ''"><!--园区编号-->
			#{obj.f_yqbh},
		</if>
		<if test="obj.f_engineer_unit != null and obj.f_engineer_unit != ''"><!--工程单位，如℉、℃、KWh-->
			#{obj.f_engineer_unit},
		</if>
		<if test="obj.f_sinnal_type != null and obj.f_sinnal_type != ''"><!--信号类型  0-10v 0  ;0-20mA 1;4-20mA 2-->
			#{obj.f_sinnal_type},
		</if>
		<if test="obj.f_min_val != null and obj.f_min_val != ''"><!--最大值-->
			#{obj.f_min_val},
		</if>
		<if test="obj.f_max_val != null and obj.f_max_val != ''"><!--最小值-->
			#{obj.f_max_val},
		</if>
		<if test="obj.f_accuracy != null and obj.f_accuracy != ''"><!--精度-->
			#{obj.f_accuracy},
		</if>
		<if test="obj.f_high_limit != null and obj.f_high_limit != ''"><!--高限报警  对于标准报警点，该点数值所允许达到的最高限值-->
			#{obj.f_high_limit},
		</if>
		<if test="obj.f_low_limit != null and obj.f_low_limit != ''"><!--低限报警   对于标准报警点，该点数值所允许达到的最低限值-->
			#{obj.f_low_limit},
		</if>
		<if test="obj.f_ao_state != null and obj.f_ao_state != ''"><!--初始添加默认不同步-->
			#{obj.f_ao_state},
		</if>
		<if test="obj.f_energyStatics != null and obj.f_energyStatics != ''"><!--能耗统计（0:是；1:否）-->
			#{obj.f_energyStatics},
		</if>
		<if test="obj.f_energy_type != null and obj.f_energy_type != ''"><!--能源类型-->
			#{obj.f_energy_type},
		</if>
		current_timestamp()<!--创建时间-->
		)
	</insert>

	<!--wanghongjie start 20200703 修改AO表的相应的点位信息-->
	<update id="updateAOPointTable" parameterType="com.alibaba.fastjson.JSONObject">
		update bes_analog_ouput
		<set>
			<if test="obj.old_f_sys_name != null and obj.old_f_sys_name != ''"><!--发送下位机的系统名称-->
				F_SYS_NAME_OLD = #{obj.old_f_sys_name},
			</if>
			<if test="obj.f_enabled != null and obj.f_enabled != ''"><!--使能状态-->
				F_ENABLED = #{obj.f_enabled},
			</if>
			<if test="obj.f_nick_name != null and obj.f_nick_name != ''"><!--别名-->
				F_NICK_NAME = #{obj.f_nick_name},
			</if>
			<if test="obj.f_reversed != null and obj.f_reversed != ''"><!--正反向-->
				F_REVERSED = #{obj.f_reversed},
			</if>
			<if test="obj.f_work_mode != null and obj.f_work_mode != ''"><!--工作模式-->
				F_WORK_MODE = #{obj.f_work_mode},
			</if>
			<if test="obj.f_alarm_enable != null and obj.f_alarm_enable != ''"><!--报警使能-->
				F_ALARM_ENABLE = #{obj.f_alarm_enable},
			</if>
			<if test="obj.f_alarm_type != null and obj.f_alarm_type != ''"><!--报警类型-->
				F_ALARM_TYPE = #{obj.f_alarm_type},
			</if>
			<if test="obj.f_close_state != null and obj.f_close_state != ''"><!--闭合状态-->
				F_CLOSE_STATE = #{obj.f_close_state},
			</if>
			<if test="obj.f_alarm_priority != null and obj.f_alarm_priority != ''"><!--报警优先级-->
				F_ALARM_PRIORITY = #{obj.f_alarm_priority},
			</if>
			<if test="obj.f_init_val != null and obj.f_init_val != ''"><!--初始值-->
				F_INIT_VAL = #{obj.f_init_val},
			</if>
			<if test="obj.f_description != null and obj.f_description != ''"><!--描述-->
				F_DESCRIPTION = #{obj.f_description},
			</if>
			<if test="obj.f_engineer_unit != null and obj.f_engineer_unit != ''"><!--工程单位-->
				F_ENGINEER_UNIT = #{obj.f_engineer_unit},
			</if>
			<if test="obj.f_sinnal_type != null and obj.f_sinnal_type != ''"><!--信号类型  0-10v 0  ;0-20mA 1;4-20mA 2-->
				F_SINNAL_TYPE = #{obj.f_sinnal_type},
			</if>
			<if test="obj.f_min_val != null and obj.f_min_val != ''"><!--最小值-->
				F_MIN_VAL = #{obj.f_min_val},
			</if>
			<if test="obj.f_max_val != null and obj.f_max_val != ''"><!--最大值-->
				F_MAX_VAL = #{obj.f_max_val},
			</if>
			<if test="obj.f_accuracy != null and obj.f_accuracy != ''"><!--精度-->
				F_ACCURACY = #{obj.f_accuracy},
			</if>
			<if test="obj.f_high_limit != null and obj.f_high_limit != ''"><!--高限报警-->
				F_HIGH_LIMIT = #{obj.f_high_limit},
			</if>
			<if test="obj.f_low_limit != null and obj.f_low_limit != ''"><!--底限报警-->
				F_LOW_LIMIT = #{obj.f_low_limit},
			</if>
			<if test="obj.f_ao_state != null and obj.f_ao_state != ''"><!--同步状态-->
				F_AO_STATE = #{obj.f_ao_state},
			</if>
			<if test="obj.f_energyStatics != null and obj.f_energyStatics != ''"><!--能耗统计（0:是；1:否）-->
				F_ENERGYSTATICS = #{obj.f_energyStatics},
			</if>
			<if test="obj.f_energy_type != null and obj.f_energy_type != ''"><!--能源类型-->
				F_ENERGY_TYPE = #{obj.f_energy_type},
			</if>
			F_CHDATE = current_timestamp()<!--修改时间-->
		</set>
		where F_STRUCT_ID = #{obj.f_id}<!--根据DO表的设备配置id修改-->
	</update>

	<!--wanghongjie start 20200703 AI点的新增-->
	<insert id="insertAIPointTable" parameterType="com.alibaba.fastjson.JSONObject">
		insert bes_analog_input
		(
		<if test="obj.f_sbid != null and obj.f_sbid != ''"><!--设备id，用于下位机通讯-->
			F_SBID,
		</if>
		<if test="obj.f_id != null and obj.f_id != ''"><!--设备树id-->
			F_STRUCT_ID,
		</if>
		<if test="obj.old_f_sys_name != null and obj.old_f_sys_name != ''"><!--下发下位机的名称-->
			F_SYS_NAME_OLD,
		</if>
		<if test="obj.f_sys_name != null and obj.f_sys_name != ''"><!--系统名称-->
			F_SYS_NAME,
		</if>
		<if test="obj.f_nick_name != null and obj.f_nick_name != ''"><!--别名-->
			F_NICK_NAME,
		</if>
		<if test="obj.f_node_type != null and obj.f_node_type != ''"><!--点类型-->
			F_NODE_TYPE,
		</if>
		<if test="obj.f_channel_index != null and obj.f_channel_index != ''"><!--通道索引-->
			F_CHANNEL_INDEX,
		</if>
		<if test="obj.f_enabled != null and obj.f_enabled != ''"><!--是否可用-->
			F_ENABLED,
		</if>
		<if test="obj.f_reversed != null and obj.f_reversed != ''"><!--是否反向-->
			F_REVERSED,
		</if>
		<if test="obj.f_work_mode != null and obj.f_work_mode != ''"><!--工作模式 -->
			F_WORK_MODE,
		</if>
		<if test="obj.f_alarm_enable != null and obj.f_alarm_enable != ''"><!--报警使能-->
			F_ALARM_ENABLE,
		</if>
		<if test="obj.f_alarm_type != null and obj.f_alarm_type != ''"><!--报警类型 -->
			F_ALARM_TYPE,
		</if>
		<if test="obj.f_close_state != null and obj.f_close_state != ''"><!--闭合状态-->
			F_CLOSE_STATE,
		</if>
		<if test="obj.f_alarm_priority != null and obj.f_alarm_priority != ''"><!--报警优先级-->
			F_ALARM_PRIORITY,
		</if>
		<if test="obj.f_init_val != null and obj.f_init_val != ''"><!--初始值-->
			F_INIT_VAL,
		</if>
		<if test="obj.f_description != null and obj.f_description != ''"><!--描述-->
			F_DESCRIPTION,
		</if>
		<if test="obj.f_yqbh != null and obj.f_yqbh != ''"><!--园区编号-->
			F_YQBH,
		</if>
		<if test="obj.f_engineer_unit != null and obj.f_engineer_unit != ''"><!--工程单位，如℉、℃、KWh-->
			F_ENGINEER_UNIT,
		</if>
		<if test="obj.f_sinnal_type != null and obj.f_sinnal_type != ''"><!--信号类型  0-10v 0  ;0-20mA 1;4-20mA 2-->
			F_SINNAL_TYPE,
		</if>
		<if test="obj.f_min_val != null and obj.f_min_val != ''"><!--最大值-->
			F_MIN_VAL,
		</if>
		<if test="obj.f_max_val != null and obj.f_max_val != ''"><!--最小值-->
			F_MAX_VAL,
		</if>
		<if test="obj.f_accuracy != null and obj.f_accuracy != ''"><!--精度-->
			F_ACCURACY,
		</if>
		<if test="obj.f_high_limit != null and obj.f_high_limit != ''"><!--高限报警  对于标准报警点，该点数值所允许达到的最高限值-->
			F_HIGH_LIMIT,
		</if>
		<if test="obj.f_low_limit != null and obj.f_low_limit != ''"><!--低限报警   对于标准报警点，该点数值所允许达到的最低限值-->
			F_LOW_LIMIT,
		</if>
		<if test="obj.f_energy_type != null and obj.F_ENERGY_TYPE != ''"><!--能源类型-->
			F_ENERGY_TYPE,
		</if>
		<if test="obj.f_energyStatics != null and obj.f_energyStatics != ''"><!--能耗统计（0:是；1:否）-->
			F_ENERGYSTATICS,
		</if>
		<if test="obj.f_ai_state != null and obj.f_ai_state != ''"><!--初始添加默认不同步-->
			F_AI_STATE,
		</if>
		F_CRDATE<!--创建时间-->
		)
		values (
		<if test="obj.f_sbid != null and obj.f_sbid != ''"><!--设备id，用于下位机通讯-->
			#{obj.f_sbid},
		</if>
		<if test="obj.f_id != null and obj.f_id != ''"><!--设备树id-->
			#{obj.f_id},
		</if>
		<if test="obj.old_f_sys_name != null and obj.old_f_sys_name != ''"><!--下发下位机的名称-->
			#{obj.old_f_sys_name},
		</if>
		<if test="obj.f_sys_name != null and obj.f_sys_name != ''"><!--系统名称-->
			#{obj.f_sys_name},
		</if>
		<if test="obj.f_nick_name != null and obj.f_nick_name != ''"><!--别名-->
			#{obj.f_nick_name},
		</if>
		<if test="obj.f_node_type != null and obj.f_node_type != ''"><!--点类型-->
			#{obj.f_node_type},
		</if>
		<if test="obj.f_channel_index != null and obj.f_channel_index != ''"><!--通道索引-->
			#{obj.f_channel_index},
		</if>
		<if test="obj.f_enabled != null and obj.f_enabled != ''"><!--是否可用-->
			#{obj.f_enabled},
		</if>
		<if test="obj.f_reversed != null and obj.f_reversed != ''"><!--是否反向-->
			#{obj.f_reversed},
		</if>
		<if test="obj.f_work_mode != null and obj.f_work_mode != ''"><!--工作模式 -->
			#{obj.f_work_mode},
		</if>
		<if test="obj.f_alarm_enable != null and obj.f_alarm_enable != ''"><!--报警使能-->
			#{obj.f_alarm_enable},
		</if>
		<if test="obj.f_alarm_type != null and obj.f_alarm_type != ''"><!--报警类型 -->
			#{obj.f_alarm_type},
		</if>
		<if test="obj.f_close_state != null and obj.f_close_state != ''"><!--闭合状态-->
			#{obj.f_close_state},
		</if>
		<if test="obj.f_alarm_priority != null and obj.f_alarm_priority != ''"><!--报警优先级-->
			#{obj.f_alarm_priority},
		</if>
		<if test="obj.f_init_val != null and obj.f_init_val != ''"><!--初始值-->
			#{obj.f_init_val},
		</if>
		<if test="obj.f_description != null and obj.f_description != ''"><!--描述-->
			#{obj.f_description},
		</if>
		<if test="obj.f_yqbh != null and obj.f_yqbh != ''"><!--园区编号-->
			#{obj.f_yqbh},
		</if>
		<if test="obj.f_engineer_unit != null and obj.f_engineer_unit != ''"><!--工程单位，如℉、℃、KWh-->
			#{obj.f_engineer_unit},
		</if>
		<if test="obj.f_sinnal_type != null and obj.f_sinnal_type != ''"><!--信号类型  0-10v 0  ;0-20mA 1;4-20mA 2-->
			#{obj.f_sinnal_type},
		</if>
		<if test="obj.f_min_val != null and obj.f_min_val != ''"><!--最大值-->
			#{obj.f_min_val},
		</if>
		<if test="obj.f_max_val != null and obj.f_max_val != ''"><!--最小值-->
			#{obj.f_max_val},
		</if>
		<if test="obj.f_accuracy != null and obj.f_accuracy != ''"><!--精度-->
			#{obj.f_accuracy},
		</if>
		<if test="obj.f_high_limit != null and obj.f_high_limit != ''"><!--高限报警  对于标准报警点，该点数值所允许达到的最高限值-->
			#{obj.f_high_limit},
		</if>
		<if test="obj.f_low_limit != null and obj.f_low_limit != ''"><!--低限报警   对于标准报警点，该点数值所允许达到的最低限值-->
			#{obj.f_low_limit},
		</if>
		<if test="obj.f_energy_type != null and obj.F_ENERGY_TYPE != ''"><!--能源类型-->
			#{obj.f_energy_type},
		</if>
		<if test="obj.f_energyStatics != null and obj.f_energyStatics != ''"><!--能耗统计（0:是；1:否）-->
			#{obj.f_energyStatics},
		</if>
		<if test="obj.f_ai_state != null and obj.f_ai_state != ''"><!--初始添加默认不同步-->
			#{obj.f_ai_state},
		</if>
		current_timestamp()<!--创建时间-->
		)
	</insert>

	<!--wanghongjie start 20200704 修改AI表所关联的信息-->
	<update id="updateAIPointTable" parameterType="com.alibaba.fastjson.JSONObject">
		update bes_analog_input
		<set>
			<if test="obj.old_f_sys_name != null and obj.old_f_sys_name != ''"><!--发送下位机的系统名称-->
				F_SYS_NAME_OLD = #{obj.old_f_sys_name},
			</if>
			<if test="obj.f_enabled != null and obj.f_enabled != ''"><!--使能状态-->
				F_ENABLED = #{obj.f_enabled},
			</if>
			<if test="obj.f_nick_name != null and obj.f_nick_name != ''"><!--别名-->
				F_NICK_NAME = #{obj.f_nick_name},
			</if>
			<if test="obj.f_reversed != null and obj.f_reversed != ''"><!--正反向-->
				F_REVERSED = #{obj.f_reversed},
			</if>
			<if test="obj.f_work_mode != null and obj.f_work_mode != ''"><!--工作模式-->
				F_WORK_MODE = #{obj.f_work_mode},
			</if>
			<if test="obj.f_alarm_enable != null and obj.f_alarm_enable != ''"><!--报警使能-->
				F_ALARM_ENABLE = #{obj.f_alarm_enable},
			</if>
			<if test="obj.f_alarm_type != null and obj.f_alarm_type != ''"><!--报警类型-->
				F_ALARM_TYPE = #{obj.f_alarm_type},
			</if>
			<if test="obj.f_alarm_priority != null and obj.f_alarm_priority != ''"><!--报警优先级-->
				F_ALARM_PRIORITY = #{obj.f_alarm_priority},
			</if>
			<if test="obj.f_init_val != null and obj.f_init_val != ''"><!--初始值-->
				F_INIT_VAL = #{obj.f_init_val},
			</if>
			<if test="obj.f_description != null and obj.f_description != ''"><!--描述-->
				F_DESCRIPTION = #{obj.f_description},
			</if>
			<if test="obj.f_engineer_unit != null and obj.f_engineer_unit != ''"><!--工程单位-->
				F_ENGINEER_UNIT = #{obj.f_engineer_unit},
			</if>
			<if test="obj.f_sinnal_type != null and obj.f_sinnal_type != ''"><!--信号类型  0-10v 0  ;0-20mA 1;4-20mA 2-->
				F_SINNAL_TYPE = #{obj.f_sinnal_type},
			</if>
			<if test="obj.f_min_val != null and obj.f_min_val != ''"><!--最小值-->
				F_MIN_VAL = #{obj.f_min_val},
			</if>
			<if test="obj.f_max_val != null and obj.f_max_val != ''"><!--最大值-->
				F_MAX_VAL = #{obj.f_max_val},
			</if>
			<if test="obj.f_accuracy != null and obj.f_accuracy != ''"><!--精度-->
				F_ACCURACY = #{obj.f_accuracy},
			</if>
			<if test="obj.f_high_limit != null and obj.f_high_limit != ''"><!--高限报警-->
				F_HIGH_LIMIT = #{obj.f_high_limit},
			</if>
			<if test="obj.f_low_limit != null and obj.f_low_limit != ''"><!--底限报警-->
				F_LOW_LIMIT = #{obj.f_low_limit},
			</if>
			<if test="obj.f_energyStatics != null and obj.f_energyStatics != ''"><!--能耗统计（0:是；1:否）-->
				F_ENERGYSTATICS = #{obj.f_energyStatics},
			</if>
			<if test="obj.f_energy_type != null and obj.f_energy_type != ''"><!--能源类型-->
				F_ENERGY_TYPE = #{obj.f_energy_type},
			</if>
			<if test="obj.f_ai_state != null and obj.f_ai_state != ''"><!--同步状态-->
				F_AI_STATE = #{obj.f_ai_state},
			</if>
			F_CHDATE = current_timestamp()<!--修改时间-->
		</set>
		where F_STRUCT_ID = #{obj.f_id}<!--根据AI表的设备配置id修改-->
	</update>

	<!--wanghongjie start 20200704 新增DI点在DI表中-->
	<insert id="insertDIPointTable" parameterType="com.alibaba.fastjson.JSONObject">
		insert bes_digit_input
		(
		<if test="obj.f_sbid != null and obj.f_sbid != ''"><!--设备id，用于下位机通讯-->
			F_SBID,
		</if>
		<if test="obj.f_id != null and obj.f_id != ''"><!--设备树id-->
			F_STRUCT_ID,
		</if>
		<if test="obj.old_f_sys_name != null and obj.old_f_sys_name != ''"><!--下发下位机的名称-->
			F_SYS_NAME_OLD,
		</if>
		<if test="obj.f_sys_name != null and obj.f_sys_name != ''"><!--系统名称-->
			F_SYS_NAME,
		</if>
		<if test="obj.f_nick_name != null and obj.f_nick_name != ''"><!--别名-->
			F_NICK_NAME,
		</if>
		<if test="obj.f_node_type != null and obj.f_node_type != ''"><!--点类型-->
			F_NODE_TYPE,
		</if>
		<if test="obj.f_channel_index != null and obj.f_channel_index != ''"><!--通道索引-->
			F_CHANNEL_INDEX,
		</if>
		<if test="obj.f_enabled != null and obj.f_enabled != ''"><!--是否可用-->
			F_ENABLED,
		</if>
		<if test="obj.f_reversed != null and obj.f_reversed != ''"><!--是否反向-->
			F_REVERSED,
		</if>
		<if test="obj.f_sourced != null and obj.f_sourced != ''"><!--是否有源   否0，是1-->
			F_SOURCED,
		</if>
		<if test="obj.f_work_mode != null and obj.f_work_mode != ''"><!--工作模式 -->
			F_WORK_MODE,
		</if>
		<if test="obj.f_alarm_enable != null and obj.f_alarm_enable != ''"><!--报警使能-->
			F_ALARM_ENABLE,
		</if>
		<if test="obj.f_alarm_type != null and obj.f_alarm_type != ''"><!--报警类型 -->
			F_ALARM_TYPE,
		</if>
		<if test="obj.f_close_state != null and obj.f_close_state != ''"><!--闭合状态-->
			F_CLOSE_STATE,
		</if>
		<if test="obj.f_alarm_priority != null and obj.f_alarm_priority != ''"><!--报警优先级-->
			F_ALARM_PRIORITY,
		</if>
		<if test="obj.f_init_val != null and obj.f_init_val != ''"><!--初始值-->
			F_INIT_VAL,
		</if>
		<if test="obj.f_description != null and obj.f_description != ''"><!--描述-->
			F_DESCRIPTION,
		</if>
		<if test="obj.f_yqbh != null and obj.f_yqbh != ''"><!--园区编号-->
			F_YQBH,
		</if>
		<if test="obj.f_fault_state != null and obj.f_fault_state != ''"><!--故障状态-->
			F_FAULT_STATE,
		</if>
		<if test="obj.f_di_state != null and obj.f_di_state != ''"><!--初始添加默认不同步-->
			F_DI_STATE,
		</if>
		F_CRDATE<!--创建时间-->
		)
		values (
		<if test="obj.f_sbid != null and obj.f_sbid != ''"><!--设备id，用于下位机通讯-->
			#{obj.f_sbid},
		</if>
		<if test="obj.f_id != null and obj.f_id != ''"><!--设备树id-->
			#{obj.f_id},
		</if>
		<if test="obj.old_f_sys_name != null and obj.old_f_sys_name != ''"><!--下发下位机的名称-->
			#{obj.old_f_sys_name},
		</if>
		<if test="obj.f_sys_name != null and obj.f_sys_name != ''"><!--系统名称-->
			#{obj.f_sys_name},
		</if>
		<if test="obj.f_nick_name != null and obj.f_nick_name != ''"><!--别名-->
			#{obj.f_nick_name},
		</if>
		<if test="obj.f_node_type != null and obj.f_node_type != ''"><!--点类型-->
			#{obj.f_node_type},
		</if>
		<if test="obj.f_channel_index != null and obj.f_channel_index != ''"><!--通道索引-->
			#{obj.f_channel_index},
		</if>
		<if test="obj.f_enabled != null and obj.f_enabled != ''"><!--是否可用-->
			#{obj.f_enabled},
		</if>
		<if test="obj.f_reversed != null and obj.f_reversed != ''"><!--是否反向-->
			#{obj.f_reversed},
		</if>
		<if test="obj.f_sourced != null and obj.f_sourced != ''"><!--是否有源   否0，是1-->
			#{obj.f_sourced},
		</if>
		<if test="obj.f_work_mode != null and obj.f_work_mode != ''"><!--工作模式 -->
			#{obj.f_work_mode},
		</if>
		<if test="obj.f_alarm_enable != null and obj.f_alarm_enable != ''"><!--报警使能-->
			#{obj.f_alarm_enable},
		</if>
		<if test="obj.f_alarm_type != null and obj.f_alarm_type != ''"><!--报警类型 -->
			#{obj.f_alarm_type},
		</if>
		<if test="obj.f_close_state != null and obj.f_close_state != ''"><!--闭合状态-->
			#{obj.f_close_state},
		</if>
		<if test="obj.f_alarm_priority != null and obj.f_alarm_priority != ''"><!--报警优先级-->
			#{obj.f_alarm_priority},
		</if>
		<if test="obj.f_init_val != null and obj.f_init_val != ''"><!--初始值-->
			#{obj.f_init_val},
		</if>
		<if test="obj.f_description != null and obj.f_description != ''"><!--描述-->
			#{obj.f_description},
		</if>
		<if test="obj.f_yqbh != null and obj.f_yqbh != ''"><!--园区编号-->
			#{obj.f_yqbh},
		</if>
		<if test="obj.f_fault_state != null and obj.f_fault_state != ''"><!--故障状态-->
			#{obj.f_fault_state},
		</if>
		<if test="obj.f_di_state != null and obj.f_di_state != ''"><!--初始添加默认不同步-->
			#{obj.f_di_state},
		</if>
		current_timestamp()<!--创建时间-->
		)
	</insert>

	<!--wanghongjie start 20200704 DI点修改-->
	<update id="updateDIPointTable" parameterType="com.alibaba.fastjson.JSONObject">
		update bes_digit_input
		<set>
			<if test="obj.old_f_sys_name != null and obj.old_f_sys_name != ''"><!--发送下位机的系统名称-->
				F_SYS_NAME_OLD = #{obj.old_f_sys_name},
			</if>
			<if test="obj.f_enabled != null and obj.f_enabled != ''"><!--使能状态-->
				F_ENABLED = #{obj.f_enabled},
			</if>
			<if test="obj.f_nick_name != null and obj.f_nick_name != ''"><!--别名-->
				F_NICK_NAME = #{obj.f_nick_name},
			</if>
			<if test="obj.f_reversed != null and obj.f_reversed != ''"><!--正反向-->
				F_REVERSED = #{obj.f_reversed},
			</if>
			<if test="obj.f_work_mode != null and obj.f_work_mode != ''"><!--工作模式-->
				F_WORK_MODE = #{obj.f_work_mode},
			</if>
			<if test="obj.f_alarm_enable != null and obj.f_alarm_enable != ''"><!--报警使能-->
				F_ALARM_ENABLE = #{obj.f_alarm_enable},
			</if>
			<if test="obj.f_alarm_type != null and obj.f_alarm_type != ''"><!--报警类型-->
				F_ALARM_TYPE = #{obj.f_alarm_type},
			</if>
			<if test="obj.f_close_state != null and obj.f_close_state != ''"><!--闭合状态-->
				F_CLOSE_STATE = #{obj.f_close_state},
			</if>
			<if test="obj.f_alarm_priority != null and obj.f_alarm_priority != ''"><!--报警优先级-->
				F_ALARM_PRIORITY = #{obj.f_alarm_priority},
			</if>
			<if test="obj.f_init_val != null and obj.f_init_val != ''"><!--初始值-->
				F_INIT_VAL = #{obj.f_init_val},
			</if>
			<if test="obj.f_description != null and obj.f_description != ''"><!--描述-->
				F_DESCRIPTION = #{obj.f_description},
			</if>
			<if test="obj.f_sourced != null and obj.f_sourced != ''"><!--是否有源-->
				F_SOURCED = #{obj.f_sourced},
			</if>
			<if test="obj.f_fault_state != null and obj.f_fault_state != ''"><!--故障状态-->
				F_FAULT_STATE = #{obj.f_fault_state},
			</if>
			<if test="obj.f_di_state != null and obj.f_di_state != ''"><!--同步状态-->
				F_DI_STATE = #{obj.f_di_state},
			</if>
			F_CHDATE = current_timestamp()<!--修改时间-->
		</set>
		where F_STRUCT_ID = #{obj.f_id}<!--根据DO表的设备配置id修改-->
	</update>

	<!--wanghongjie start 20200707 查询当前模块的F_ID-->
	<select id="selectIdByModule" parameterType="String" resultType="java.lang.String">
		select F_ID from bes_sbpz_struct where F_SYS_NAME_OLD = #{name}
	</select>

	<!-- 查询父节点信息 -->
	<select id="getParentNodeInfo" resultType="java.util.HashMap" parameterType="java.lang.String">
			select * from bes_sbpz_struct
		where
			F_SYS_NAME = (SELECT F_PSYS_NAME FROM bes_sbpz_struct where F_SYS_NAME = #{f_sys_name}  )
	</select>

	<!--添加设备树信息  -->
	<insert id="addSbTreeInfo" parameterType="com.alibaba.fastjson.JSONObject">
		insert bes_sbpz_struct
		(
			F_SBID            ,
			F_SYS_NAME_OLD    ,
			F_SYS_NAME        ,
			F_NICK_NAME       ,
			F_ALLPATH         ,
			F_TYPE            ,
			F_NODE_ATTRIBUTION,
			F_PSYS_NAME       ,
			F_CRDATE          ,
			F_CHDATE
		 )
		values
		(
            #{obj.deviceId}        ,
            #{obj.name}            ,
            #{obj.name}            ,
            #{obj.alias}           ,
            #{obj.allPath}         ,
            #{obj.type}            ,
            #{obj.f_node_attribution},
            #{obj.pSysName}     ,
			current_timestamp(),
			current_timestamp()

		)
	</insert>

	<!--更新设备树信息  -->
	<update id="updateSbTreeInfo" parameterType="com.alibaba.fastjson.JSONObject">
		update bes_sbpz_struct

		set

		F_NICK_NAME = #{obj.alias},
		F_CHDATE = current_timestamp()

		where F_SYS_NAME = #{obj.name}

	</update>

	<!--添加虚点信息  -->
	<insert id="addVirtualPointInfo" parameterType="com.alibaba.fastjson.JSONObject">
		insert bes_vpoint
		(
		<if test=" obj.name != null and obj.name != '' ">
			F_SYS_NAME_OLD,
		</if>
		<if test=" obj.deviceId != null and obj.deviceId != '' ">
			F_SBID,
		</if>
		<if test=" obj.name != null and obj.name != '' ">
			F_SYS_NAME,
		</if>
		<if test=" obj.alias != null and obj.alias != '' ">
			F_NICK_NAME,
		</if>
		<if test=" obj.pointType != null and obj.pointType != '' ">
			F_NODE_TYPE,
		</if>
		<if test=" obj.active != null and obj.active != '' ">
			F_ENABLED,
		</if>
		<if test=" obj.initValue != null">
			F_INIT_VAL,
		</if>
		<if test=" obj.precision != null and obj.precision != '' ">
			F_ACCURACY,
		</if>
		<if test=" obj.unit != null and obj.unit != '' ">
			F_ENGINEER_UNIT,
		</if>
		<if test=" obj.alarmActive != null and obj.alarmActive != '' ">
			F_ALARM_ENABLE,
		</if>
		<if test=" obj.alarmType != null and obj.alarmType != '' ">
			F_ALARM_TYPE,
		</if>
		<if test=" obj.alarmHighValue != null and obj.alarmHighValue != '' ">
			F_HIGH_LIMIT,
		</if>
		<if test=" obj.alarmLowValue != null and obj.alarmLowValue != '' ">
			F_LOW_LIMIT,
		</if>
		<if test=" obj.alarmTrigger != null and obj.alarmTrigger != '' ">
			F_CLOSE_STATE,
		</if>
		<if test=" obj.alarmPriority != null and obj.alarmPriority != '' ">
			F_ALARM_PRIORITY,
		</if>
		<if test=" obj.description != null and obj.description != '' ">
			F_DESCRIPTION,
		</if>
		<if test=" obj.parkNumber != null and obj.parkNumber != '' ">
			F_YQBH,
		</if>
		<if test=" obj.energyStatics != null">
			F_ENERGYSTATICS,
		</if>
		<if test=" obj.energyType != null and obj.energyType != '' ">
			F_ENERGY_TYPE,
		</if>
		<if test=" obj.syncState != null and obj.syncState != '' ">
			F_SYNC_STATE,
		</if>
		<if test=" obj.faultState != null and obj.faultState != '' ">
			F_FAULT_STATE,
		</if>
		F_CRDATE,
		F_CHDATE
		)
		values
		(
		<if test=" obj.name != null and obj.name != '' ">
			#{obj.name},
		</if>
		<if test=" obj.deviceId != null and obj.deviceId != '' ">
			#{obj.deviceId},
		</if>
		<if test=" obj.name != null and obj.name != '' ">
			#{obj.name},
		</if>
		<if test=" obj.alias != null and obj.alias != '' ">
			#{obj.alias},
		</if>
		<if test=" obj.pointType != null and obj.pointType != '' ">
			#{obj.pointType},
		</if>
		<if test=" obj.active != null and obj.active != '' ">
			#{obj.active},
		</if>
		<if test=" obj.initValue != null">
			#{obj.initValue},
		</if>
		<if test=" obj.precision != null and obj.precision != '' ">
			#{obj.precision},
		</if>
		<if test=" obj.unit != null and obj.unit != '' ">
			#{obj.unit},
		</if>
		<if test=" obj.alarmActive != null and obj.alarmActive != '' ">
			#{obj.alarmActive},
		</if>
		<if test=" obj.alarmType != null and obj.alarmType != '' ">
			#{obj.alarmType},
		</if>
		<if test=" obj.alarmHighValue != null and obj.alarmHighValue != '' ">
			#{obj.alarmHighValue},
		</if>
		<if test=" obj.alarmLowValue != null and obj.alarmLowValue != '' ">
			#{obj.alarmLowValue},
		</if>
		<if test=" obj.alarmTrigger != null and obj.alarmTrigger != '' ">
			#{obj.alarmTrigger},
		</if>
		<if test=" obj.alarmPriority != null and obj.alarmPriority != '' ">
			#{obj.alarmPriority},
		</if>
		<if test=" obj.description != null and obj.description != '' ">
			#{obj.description},
		</if>
		<if test=" obj.parkNumber != null and obj.parkNumber != '' ">
			#{obj.parkNumber},
		</if>
		<if test=" obj.energyStatics != null">
			#{obj.energyStatics},
		</if>
		<if test=" obj.energyType != null and obj.energyType != '' ">
			#{obj.energyType},
		</if>
		<if test=" obj.syncState != null and obj.syncState != '' ">
			#{obj.syncState},
		</if>
		<if test=" obj.faultState != null and obj.faultState != '' ">
			#{obj.faultState},
		</if>
		current_timestamp(),
		current_timestamp()

		)
	</insert>

	<update id="updateVirtualPointInfo" parameterType="com.alibaba.fastjson.JSONObject">
		update bes_vpoint

		<set>

			<if test=" obj.alias != null and obj.alias != '' ">
				F_NICK_NAME = #{obj.alias},
			</if>
			<if test=" obj.pointType != null and obj.pointType != '' ">
				F_NODE_TYPE = #{obj.pointType},
			</if>
			<if test=" obj.active != null and obj.active != '' ">
				F_ENABLED = #{obj.active},
			</if>
			<if test=" obj.initValue != null and obj.initValue != '' ">
				F_INIT_VAL = #{obj.initValue},
			</if>
			<if test=" obj.precision != null and obj.precision != '' ">
				F_ACCURACY = #{obj.precision},
			</if>
			<if test=" obj.unit != null and obj.unit != '' ">
				F_ENGINEER_UNIT = #{obj.unit},
			</if>
			<if test=" obj.alarmActive != null and obj.alarmActive != '' ">
				F_ALARM_ENABLE = #{obj.alarmActive},
			</if>
			<if test=" obj.alarmType != null and obj.alarmType != '' ">
				F_ALARM_TYPE = #{obj.alarmType},
			</if>
			<if test=" obj.alarmHighValue != null and obj.alarmHighValue != '' ">
				F_HIGH_LIMIT = #{obj.alarmHighValue},
			</if>
			<if test=" obj.alarmLowValue != null and obj.alarmLowValue != '' ">
				F_LOW_LIMIT = #{obj.alarmLowValue},
			</if>
			<if test=" obj.alarmTrigger != null and obj.alarmTrigger != '' ">
				F_CLOSE_STATE = #{obj.alarmTrigger},
			</if>
			<if test=" obj.alarmPriority != null and obj.alarmPriority != '' ">
				F_ALARM_PRIORITY = #{obj.alarmPriority},
			</if>
			<if test=" obj.description != null and obj.description != '' ">
				F_DESCRIPTION = #{obj.description},
			</if>
			<if test=" obj.energyStatics != null">
				F_ENERGYSTATICS = #{obj.energyStatics},
			</if>
			<if test=" obj.energyType != null and obj.energyType != '' ">
				F_ENERGY_TYPE = #{obj.energyType},
			</if>
			<if test=" obj.syncState != null and obj.syncState != '' ">
				F_SYNC_STATE = #{obj.syncState},
			</if>
			<if test=" obj.faultState != null and obj.faultState != '' ">
				F_FAULT_STATE = #{obj.faultState},
			</if>
			F_CHDATE = current_timestamp()
		</set>

		where F_SYS_NAME = #{obj.name}

	</update>

	<!--wanghongjie start 20200708 根据id查询模块表的当前点位的全部信息-->
	<select id="selectModuleMap" resultType="java.util.Map">
		select * from bes_module where F_STRUCT_ID = #{moduleID}
	</select>

	<!--wanghongjie start 20200709 根据节点名称查询节点下所有的子节点-->
	<select id="selectNodeMap" resultType="java.util.Map">
		select * from bes_sbpz_struct where F_PSYS_NAME = #{f_sys_name}
	</select>

	<!--wanghongjie start 20200709 删除当前选中的节点 -->
	<delete id="deleteNodeByFSysNameOld" parameterType="string">
		delete from bes_sbpz_struct where F_SYS_NAME_OLD = #{f_sys_name}
	</delete>

	<!--wanghongjie start 20200709 删除相应表中的节点信息-->
	<delete id="deleteTableNodeByFSysNameOld">
		delete from ${tabName} where F_SYS_NAME_OLD = #{f_sys_name}
	</delete>

	<!--wanghongjie start 20200709 查询当前点位在所在表中是否存在-->
	<select id="selectPointMap" resultType="java.util.Map">
		select * from ${tabName} where F_SYS_NAME_OLD = #{f_sys_name}
	</select>

	<!-- wanghongjie start 20200710 查询该节点的实体表名  由于新增的时候再删除,获取的名称为设备树节点名称,刷新树后获取的名称是自定义的名称 -->
	<select id="findNodeTableByFSysName" parameterType="String" resultType="java.lang.String">
		 select F_NODE_TABLE from bes_sbtree_nodetype
		 where
		 F_NODE_TYPE = (select F_TYPE from bes_sbpz_struct where F_SYS_NAME_OLD = #{f_sys_name} || F_SYS_NAME = #{f_sys_name})
	</select>
	<!--wanghongjie start 20200710 根据名称和表名删除节点的数据-->
	<delete  id="delSbTreeByFSysName" parameterType="String">
		DELETE FROM ${tabName} WHERE F_SYS_NAME_OLD=#{f_sys_name}
	</delete >

	<!--wanghongjie start 20200710 删除逻辑点的时候,将设备配置表的点位信息修改成为添加前的状态-->
	<update id="updateSbTreeByFSysName" parameterType="string">
		update BES_SBPZ_STRUCT
		set
		F_SYS_NAME_OLD = #{f_sys_name_sbdy},
		F_NICK_NAME = #{f_nick_name},
		F_ALLPATH = #{path},
		<if test="f_type != null and f_type != ''">
			F_TYPE = #{f_type},
		</if>
		F_DESCRIPTION = #{f_descruption}

		where F_SYS_NAME = #{f_sys_name_sbdy}
	</update>

	<!--wanghongjie start 20200710  查询该逻辑点所在的控制器的ip-->
	<select id="selectcontrollerPoint" parameterType="string" resultType="java.util.Map">
		SELECT * from bes_ddc where F_SYS_NAME_OLD = (
		SELECT F_PSYS_NAME FROM bes_sbpz_struct where F_SYS_NAME = (
		SELECT F_PSYS_NAME FROM bes_sbpz_struct where F_SYS_NAME = (
		SELECT F_PSYS_NAME FROM bes_sbpz_struct where F_SYS_NAME = (
		SELECT F_PSYS_NAME FROM bes_sbpz_struct where F_SYS_NAME = #{f_sys_name_sbdy} || F_SYS_NAME_OLD = #{f_sys_name_sbdy}
		))))
	</select>

	<!--wanghongjie start 20200710 查询当前模块所属的ip-->
	<select id="selectDDCByModuleFSysName" resultType="java.util.Map">
		SELECT * from bes_ddc where F_SYS_NAME_OLD = (
		SELECT F_PSYS_NAME FROM bes_sbpz_struct where F_SYS_NAME = (
		SELECT F_PSYS_NAME FROM bes_sbpz_struct where F_SYS_NAME = (
		SELECT F_PSYS_NAME FROM bes_sbpz_struct where F_SYS_NAME = #{f_sys_name}
		)))
	</select>

	<!--wanghongjie start 20200710 查询当前ddc在ddc表中的信息-->
	<select id="ddcPointMapByDDCTable" resultType="java.util.Map">
		select * from bes_ddc where F_SYS_NAME_OLD = #{f_sys_name}
	</select>

	<!--wanghongjie start 20200710 获取当前虚点在虚点表的详细信息 -->
	<select id="VPointTableMap" resultType="java.util.Map">
		select * from bes_vpoint where F_SYS_NAME = #{f_sys_name}
	</select>
	<!--wanghongjie start 20200710 获取当前虚点所在的ip详细信息-->
	<select id="VPointMap" resultType="java.util.Map">
		SELECT * from bes_ddc where F_SYS_NAME_OLD = (
		SELECT F_PSYS_NAME FROM bes_sbpz_struct where F_SYS_NAME = (
		SELECT F_PSYS_NAME FROM bes_sbpz_struct where F_SYS_NAME = #{f_sys_name} ||  F_SYS_NAME_OLD = #{f_sys_name}
		))
	</select>

	<!--wanghongjie start 20200713 根据名称和表名删除设置配置表中相关的数据 -->
	<delete id="delNodeCconfigSettingByFSysName" parameterType="string">
		delete from bes_node_config_setting  where F_SYS_NAME = #{f_sys_name}
	</delete>

	<!--wanghongjie start 20200714 更改数据库的当前模式为手动 -->
	<update id="updatePointByWorkMode" parameterType="string">
		update ${tabName}
		set
		F_WORK_MODE = #{updateWorkMode}
		where F_STRUCT_ID = #{id}
	</update>

	<!--wanghongjie start 20200728 查询父节点的系统名称标识 -->
	<select id="selectFNodeAttributionByPsysName" resultType="java.lang.String">
		select F_NODE_ATTRIBUTION from bes_sbpz_struct where F_SYS_NAME_OLD = #{f_psys_name}
	</select>

	<!--wanghongjie start 20200728 新增干线或者新增支线耦合器-->
	<insert id="sbdy_couplerInfo_insert_bes_coupler" parameterType="com.alibaba.fastjson.JSONObject">
		insert bes_coupler (
		<if test='obj.f_sys_name != null and obj.f_sys_name != "" '><!--发送下位机的系统名称 -->
			F_SYS_NAME_OLD,
		</if>
		<if test='obj.f_sys_name != null and obj.f_sys_name != "" '><!-- 系统名称-->
			F_SYS_NAME,
		</if>
		<if test='obj.f_nick_name != null and obj.f_nick_name != "" '><!--别名 -->
			F_NICK_NAME,
		</if>
		<if test='obj.f_type != null and obj.f_type != "" '><!-- 节点类型-->
			F_NODE_TYPE,
		</if>
		<if test='obj.f_azwz != null and obj.f_azwz != "" '><!--安装位置 -->
			F_AZWZ,
		</if>
		<if test='obj.f_description != null and obj.f_description != "" '><!--描述 -->
			F_DESCRIPTION,
		</if>
		<if test='obj.f_node_attribution != null and obj.f_node_attribution != "" '><!-- 类型-->
			F_TYPE,
		</if>
		<if test='obj.f_addr != null and obj.f_addr != "" '><!-- 地址-->
			F_ADDR,
		</if>
		<if test='obj.f_belong_iprouter != null and obj.f_belong_iprouter != "" '><!--归属系统 -->
			F_BELONG_IPROUTER,
		</if>
		F_CRDATE
		) values (
		<if test='obj.f_sys_name != null and obj.f_sys_name != "" '><!--发送下位机的系统名称 -->
			#{obj.f_sys_name},
		</if>
		<if test='obj.f_sys_name != null and obj.f_sys_name != "" '><!-- 系统名称-->
			#{obj.f_sys_name},
		</if>
		<if test='obj.f_nick_name != null and obj.f_nick_name != "" '><!--别名 -->
			#{obj.f_nick_name},
		</if>
		<if test='obj.f_type != null and obj.f_type != "" '><!-- 节点类型-->
			#{obj.f_type},
		</if>
		<if test='obj.f_azwz != null and obj.f_azwz != "" '><!--安装位置 -->
			#{obj.f_azwz},
		</if>
		<if test='obj.f_description != null and obj.f_description != "" '><!--描述 -->
			#{obj.f_description},
		</if>
		<if test='obj.f_node_attribution != null and obj.f_node_attribution != "" '><!-- 类型-->
			#{obj.f_node_attribution},
		</if>
		<if test='obj.f_addr != null and obj.f_addr != "" '><!-- 地址-->
			#{obj.f_addr},
		</if>
		<if test='obj.f_belong_iprouter != null and obj.f_belong_iprouter != "" '><!--归属系统 -->
			#{obj.f_belong_iprouter},
		</if>
		current_timestamp()
		)
	</insert>

	<!--wanghongjie start 20200729 判断通信地址是否重复-->

	<select id="selectCouplerList" resultType="java.util.Map" parameterType="string">
		select * from bes_coupler where F_SYS_NAME_OLD in (
		select F_SYS_NAME_OLD from bes_sbpz_struct where f_psys_name = #{f_psys_name}
		)
	</select>

	<!--wanghongjie start 20200729 查询当前支路或者干线下是否有子节点,如果有的话,则提示不能修改-->
	<select id="selectCouplerChildList" resultType="java.util.Map" parameterType="string">
		select * from bes_sbpz_struct where F_PSYS_NAME = #{f_sys_name}
	</select>

	<!--wanghongjie start 20200729  查询当前通信地址是否修改-->
	<select id="selectCouplerMap" resultType="java.util.Map" parameterType="string">
		select * from bes_coupler where F_SYS_NAME_OLD = #{f_sys_name}
	</select>

	<!--wanghongjie start 20200729  修改支路或者干线的节点信息-->
	<update id="updateCouplerSbdyStruct" parameterType="com.alibaba.fastjson.JSONObject">
		update bes_sbpz_struct
		<set>
			<if test='obj.f_nick_name != null and obj.f_nick_name != "" '>
				F_NICK_NAME = #{obj.f_nick_name},
			</if>
			<if test='obj.f_description != null and obj.f_description != "" '>
				F_DESCRIPTION = #{obj.f_description},
			</if>
			<if test='obj.allpath != null and obj.allpath != "" '>
				F_ALLPATH = #{obj.allpath},
			</if>
			F_CHDATE = current_timestamp()
		</set>
		where F_SYS_NAME_OLD = #{obj.f_sys_name}
	</update>

	<!--wanghongjie start 20200729  修改支路或者干线的节点信息-->
	<update id="updateCoupler" parameterType="com.alibaba.fastjson.JSONObject">
		update bes_coupler
		<set>
			<if test='obj.f_nick_name != null and obj.f_nick_name != "" '>
				F_NICK_NAME = #{obj.f_nick_name},
			</if>
			<if test='obj.f_azwz != null and obj.f_azwz != "" '>
				F_AZWZ = #{obj.f_azwz},
			</if>
			<if test='obj.f_description != null and obj.f_description != "" '>
				F_DESCRIPTION = #{obj.f_description},
			</if>
			<if test='obj.f_addr != null and obj.f_addr != "" '>
				F_ADDR = #{obj.f_addr},
			</if>
			<if test='obj.f_belong_iprouter != null and obj.f_belong_iprouter != "" '>
				F_BELONG_IPROUTER = #{obj.f_belong_iprouter},
			</if>
			F_CHDATE = current_timestamp()
		</set>
		where F_SYS_NAME_OLD = #{obj.f_sys_name}
	</update>

	<!--wanghongjie start 20200730 查询当前LDC下所有的模块的通信地址-->
	<select id="selectLDCModuleList" resultType="java.util.Map">
		SELECT * from bes_module where F_SYS_NAME_OLD in
		(select F_SYS_NAME_OLD from bes_sbpz_struct where F_PSYS_NAME in
		(select F_SYS_NAME_OLD from bes_sbpz_struct where F_PSYS_NAME in (
		 select F_SYS_NAME_OLD from bes_sbpz_struct where F_PSYS_NAME = #{f_sys_name_old_ddc}
		)) || F_PSYS_NAME in (
		 select F_SYS_NAME_OLD from bes_sbpz_struct where F_PSYS_NAME = #{f_sys_name_old_ddc}
		)) || F_SYS_NAME_OLD in (
		 select F_SYS_NAME_OLD from bes_sbpz_struct where F_PSYS_NAME = #{f_sys_name_old_ddc}
		)
	</select>

	<!--wanghongjie start 20200731 查询当前模块所属的ip(照明)-->
	<select id="selectLDCByModuleFSysName" resultType="java.util.Map">
		select * from bes_ddc where
		F_SYS_NAME_OLD in (
		select f_psys_name from bes_sbpz_struct where F_SYS_NAME_OLD = #{f_sys_name} ||
		F_SYS_NAME_OLD in
		(select f_psys_name from bes_sbpz_struct where F_SYS_NAME_OLD = #{f_sys_name} ||
		F_SYS_NAME_OLD =
		(select f_psys_name from bes_sbpz_struct where F_SYS_NAME_OLD = #{f_sys_name}
		)))
	</select>

	<!--wanghongjie start 20200731 查询当前点位所属的ddc-->
	<select id="queryLDCMapByPoint" resultType="java.util.Map">
		select * from bes_ddc where
		F_SYS_NAME_OLD in (
		select f_psys_name from bes_sbpz_struct where F_SYS_NAME_OLD in (
		select f_psys_name from bes_sbpz_struct where F_ID = #{f_id} ||
		F_SYS_NAME_OLD in
		(select f_psys_name from bes_sbpz_struct where F_ID = #{f_id} ||
		F_SYS_NAME_OLD =
		(select f_psys_name from bes_sbpz_struct where F_ID = #{f_id}
		))))
	</select>

	<!--wanghongjie start 20200731 查询该逻辑点所在的控制器的ip-->
	<select id="selectcontrollerPointByDelete" resultType="java.util.Map">
		select * from bes_ddc where
		F_SYS_NAME_OLD in (
		select f_psys_name from bes_sbpz_struct where F_SYS_NAME_OLD in (
		select f_psys_name from bes_sbpz_struct where F_SYS_NAME_OLD = #{f_sys_name_old} || F_SYS_NAME = #{f_sys_name_old}  ||
		F_SYS_NAME_OLD in
		(select f_psys_name from bes_sbpz_struct where F_SYS_NAME_OLD = #{f_sys_name_old} || F_SYS_NAME = #{f_sys_name_old} ||
		F_SYS_NAME_OLD =
		(select f_psys_name from bes_sbpz_struct where F_SYS_NAME_OLD = #{f_sys_name_old} || F_SYS_NAME = #{f_sys_name_old}
		))))
	</select>

	<!--wanghongjie start 20200801 	查询该逻辑点所在的控制器的ip(照明的虚点点位)-->
	<select id="selectcontrollerByLDCVpoint" resultType="java.util.Map">
		SELECT * from bes_ddc where F_SYS_NAME_OLD = (
		SELECT F_PSYS_NAME FROM bes_sbpz_struct where F_SYS_NAME = (
		SELECT F_PSYS_NAME FROM bes_sbpz_struct where  F_SYS_NAME_OLD = #{name} || F_SYS_NAME = #{name}
		))
	</select>

	<!--更改实点点位的实时值-->
	<update id="updatePointByid">
		update ${tabName}
		set F_INIT_VAL = #{value}
		where F_STRUCT_ID = #{id}
	</update>

	<!--更改虚点点位的实时值-->
	<update id="updateVPointByid">
		update ${tabName}
		set F_INIT_VAL = #{value}
		where F_SBID = #{id}
	</update>

	<!--根据名称查询点位信息以及表名-->
	<select id="sbpzStructPointMapByName" resultType="java.util.Map">
		select a.*,b.F_NODE_TABLE from bes_sbpz_struct a ,bes_sbtree_nodetype b
		where (a.F_SYS_NAME_OLD = #{f_sys_name_old} || a.F_SYS_NAME = #{f_sys_name_old}) and a.F_TYPE = b.F_NODE_TYPE
	</select>

	<!--如果模块的通信地址在当前ddc下有相同的地址,则在页面提示通信地址重复,添加失败-->
	<select id="f_addrListByPName" resultType="java.util.Map">
		SELECT * from bes_module where F_SYS_NAME_OLD in
		(select F_SYS_NAME_OLD from bes_sbpz_struct where F_PSYS_NAME = #{f_psys_name})
	</select>

	<!--获取设备树及关联点的数据-->
	<select id="getTreeInfoAndPointData" resultType="java.util.Map">

		SELECT
		t.F_SYS_NAME f_sys_name,
		t.F_SYS_NAME_OLD f_sys_name_old,
		t.F_NICK_NAME f_nick_name,
		t.F_TYPE f_type,
		t.F_STATUS f_status,
		COALESCE(`ao`.F_ENGINEER_UNIT, `ai`.F_ENGINEER_UNIT, `po`.F_ENGINEER_UNIT) unit,
		COALESCE(`ao`.F_INIT_VAL, `ai`.F_INIT_VAL, `do`.F_INIT_VAL, `di`.F_INIT_VAL, `po`.F_INIT_VAL) f_init_val,
		COALESCE(`ao`.F_ACCURACY, `ai`.F_ACCURACY, `po`.F_ACCURACY) f_accuracy
		FROM
			bes_sbpz_struct t
			LEFT JOIN bes_analog_ouput `ao` ON t.F_SYS_NAME = `ao`.F_SYS_NAME
			LEFT JOIN bes_digit_ouput `do` ON t.F_SYS_NAME = `do`.F_SYS_NAME
			LEFT JOIN bes_digit_input `di` ON t.F_SYS_NAME = `di`.F_SYS_NAME
			LEFT JOIN bes_analog_input `ai` ON t.F_SYS_NAME = `ai`.F_SYS_NAME
			LEFT JOIN bes_vpoint po ON t.F_SYS_NAME = po.F_SYS_NAME

			<where>
				<if test='f_sys_names != null'>
					t.F_SYS_NAME in
					<foreach collection="f_sys_names" item="f_sys_name" separator="," open="(" close=")">
						#{f_sys_name}
					</foreach>
				</if>
			</where>

	</select>


	   <select id="getRelativeModuleTypeInfo" resultType="String">
		SELECT F_TYPE from bes_module where f_sys_name = #{sysname}
		</select>

	<select id="getPointTypeInfo" resultType="java.util.Map">
		select a.f_type,b.f_type as modeType from bes_sbpz_struct a
		left join bes_module b on a.f_sys_name =b.f_sys_name where a.f_sys_name  = #{sysname}
		</select>



	<select id="getChildPointInfo" resultMap="sbdyMap" parameterType="String">
		select * from bes_sbpz_struct where f_psys_name  = #{sysname}
		</select>


	    <select id="findChildNodeInfo" resultMap="sbdyMap" parameterType="String">
		select * from bes_sbpz_struct where f_psys_name =#{sysname}
		</select>

	<!-- 查询流程节节点的实体表名 -->
	<select id="findFlowNodeTable" parameterType="String" resultType="String">
		 select F_NODE_TABLE from bes_sbtree_nodetype
		 where
		 F_NODE_TYPE = (select F_TYPE from bes_sbpz_struct where F_SYS_NAME_OLD = #{f_sys_name} || F_SYS_NAME=#{f_sys_name})
	</select>


	<!--查询点位的信息-->
	<select id="sbpzStructPointMapsByName" resultType="java.util.Map">
		select * from ${f_node_table} where F_SYS_NAME_OLD = #{f_sys_name_old} || F_SYS_NAME = #{f_sys_name_old}
	</select>

	<!--查询园区的信息-->
	<select id="select_park" resultMap="BESParkMap">
		<include refid="find_xxx_park" />
		<include refid="from_xxx_park" />
		where 1=1
		order by f_yqbh
	</select>

	<!--添加根节点信息-->
	<insert id="insert_sbdy_node_first" parameterType="java.lang.String">
		insert  into bes_sbpz_struct
		(F_POLL_STATUS,F_SYS_NAME_OLD,F_SYS_NAME,F_NICK_NAME,F_ALLPATH,F_DESCRIPTION,F_TYPE,F_ISSYN,F_PSYS_NAME,F_STATUS,F_CRDATE,F_CHDATE)
		values (
		#{f_poll_status},#{f_yqbh},#{f_yqbh},#{f_nick_name},#{f_allpath},#{f_descrption},#{f_type},#{f_issyn},#{f_psys_name},#{f_status},current_timestamp(),current_timestamp()
		)
	</insert>

	<!--根据类型为0查询设备配置表的信息-->
	<select id="selectPointListByF_type" resultType="java.util.Map">
		select f_sys_name from bes_sbpz_struct where f_type = #{f_type}
	</select>

	<select id="selectPointType" resultMap="sbdyMap" parameterType="String">
		select * from bes_sbpz_struct where f_psys_name =#{f_sys_name}
		</select>

	<!--查询父节点的父节点名称-->
	<select id="selectYqbhByFsysName" resultType="java.lang.String">
		select F_PSYS_NAME FROM bes_sbpz_struct WHERE F_SYS_NAME_OLD = #{f_psys_name}
	</select>
</mapper>
